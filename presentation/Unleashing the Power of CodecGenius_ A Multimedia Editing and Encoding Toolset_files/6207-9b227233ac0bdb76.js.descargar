"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6207],{79271:function(e,t,o){var n,r=o(67294);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i.apply(this,arguments)}t.Z=function(e){return r.createElement("svg",i({fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=r.createElement("path",{d:"M8 3.5L5.46 6.547a.6.6 0 01-.921 0L1.999 3.5",stroke:"inherit",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})))}},41822:function(e,t,o){o.d(t,{W:function(){return n}});const n=o(59016).ZP.div.withConfig({displayName:"BottomRightButtons",componentId:"sc-1xy1znj-0"})(["position:absolute;bottom:","px;right:","px;flex-direction:column;display:grid;gap:8px;"],(e=>e.theme.panelSpacing),(e=>e.theme.panelSpacing))},8423:function(e,t,o){o.d(t,{N:function(){return m}});o(67294);var n=o(59016),r=o(41664),i=o.n(r),a=o(29212),l=o(24418),s=o(85893);const c=n.ZP.div.withConfig({displayName:"FullScreenMessage__PageContainer",componentId:"jdrf4g-0"})(["align-items:center;display:flex;height:100%;justify-content:center;width:100%;background-color:",";user-select:text;"],(e=>{let{theme:t}=e;return t.colors.background})),d=n.ZP.div.withConfig({displayName:"FullScreenMessage__Content",componentId:"jdrf4g-1"})(["flex-direction:row;text-align:center;max-width:340px;width:100%;padding:0 20px;"]),p=n.ZP.div.withConfig({displayName:"FullScreenMessage__LogoContainer",componentId:"jdrf4g-2"})(["margin-bottom:28px;&:hover{cursor:pointer;}"]),u=n.ZP.div.withConfig({displayName:"FullScreenMessage__MainMessage",componentId:"jdrf4g-3"})(["font-weight:500;font-size:15px;line-height:20px;"]),m=n.ZP.div.withConfig({displayName:"FullScreenMessage__SubMessage",componentId:"jdrf4g-4"})(["margin:24px 0;font-size:13px;line-height:16px;color:",";a{color:",";&:hover,:focus,:active{text-decoration:underline;}}"],(e=>{let{theme:t}=e;return t.colors.subMessageText}),(e=>{let{theme:t}=e;return t.colors.subMessageLink}));t.Z=e=>{let{mainMessage:t,children:o}=e;const{workspaceUrl:n}=(0,l.bp)();return(0,s.jsx)(c,{children:(0,s.jsxs)(d,{children:[(0,s.jsx)(i(),{href:n,children:(0,s.jsx)(p,{children:(0,s.jsx)(a.Z,{style:{width:"40px",height:"40px"}})})}),(0,s.jsx)(u,{children:t}),o]})})}},76682:function(e,t,o){o(67294);var n=o(37887),r=o(33504),i=o(85893);t.Z=e=>{let{id:t,children:o}=e;const{loading:a,error:l,data:s}=(0,n.a)(r.Z,{variables:{id:t},skip:null==t});if(a)return(0,i.jsx)("div",{});if(l)return(0,i.jsxs)(i.Fragment,{children:["`Error! $",l.message,"`"]});const c=s?s.tile:null;return(0,i.jsx)(i.Fragment,{children:o(c)})}},6207:function(e,t,o){o.d(t,{E:function(){return Jf},Z:function(){return Xf}});var n,r=o(59499),i=o(4730),a=o(67294),l=o(4480),s=o(64310),c=o(13433),d=o(13285),p=o(95421),u=o(5152),m=o.n(u),g=o(11163),h=o.n(g),f=o(7863),b=o(59016),y=o(1922),C=o(33820),v=o(29334),x=o(31343),O=o(94717);function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},P.apply(this,arguments)}var w=function(e){return a.createElement("svg",P({width:14,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.833 0A1.167 1.167 0 0114 1.167v11.666A1.167 1.167 0 0112.833 14H1.167A1.167 1.167 0 010 12.833V1.167A1.167 1.167 0 011.167 0h11.666z",fill:"#FF3434"})))},j=o(40461),T=o(53098),E=o(80375),I=o(4034),S=o(90170),_=o(85893);const k=(0,b.ZP)(d.E.div).withConfig({displayName:"RecordingInProgressPanel__ContainerStyles",componentId:"sc-1ipbnub-0"})(["margin-right:","px;width:","px;height:","px;overflow:hidden;z-index:",";position:absolute;top:","px;right:0;flex-direction:column;display:flex;justify-content:center;"],(e=>e.theme.panelSpacing),(e=>{let{width:t}=e;return t}),(e=>{let{height:t}=e;return t}),T.Mf,(e=>-e.theme.headerHeight)),Z=(0,b.ZP)(O.Z).withConfig({displayName:"RecordingInProgressPanel__StopButton",componentId:"sc-1ipbnub-1"})(["height:40px;width:40px;border-radius:53px;display:flex;align-items:center;justify-content:center;color:",";"],(e=>e.theme.colors.sheetBg));var D=e=>{let{width:t,height:o,resetToFullCanvas:n}=e;const[r,i]=(0,l.FV)(j.wo);(0,a.useEffect)((()=>()=>i(!1)),[i]);const s=(0,a.useRef)(r);s.current=r;const c=(0,I.t2)(),d=(0,a.useCallback)((()=>{s.current&&(n(),i(!1),c.setPropertyPanel(S.Z.RECORD))}),[n,i,c]),p=(0,a.useCallback)((e=>{"Space"!==e.code&&"Escape"!==e.code||d()}),[d]);return(0,a.useEffect)((()=>r?(document.addEventListener("keyup",p),()=>{document.removeEventListener("keyup",p)}):()=>{}),[r,p]),r?(0,_.jsx)(k,{width:t,height:o,initial:{x:t},animate:{x:0},exit:{x:t},transition:E.Z2,children:(0,_.jsx)(Z,{"data-testid":"stop_recording_button",onClick:d,children:(0,_.jsx)(w,{})})}):null},M=o(92627),R=o(78374),A=o(60153),L=o(46513),N=o(86388),H=o(24418),V=o(60864),B=o(66482),$=o(88902),F=o(64096),G=o(89202),z=o(36409),U=o(51718);var W=o(61505),q=o(14593),K=o(84081),Y=o(24955),J=o(95821),X=o(76682),Q=o(40556),ee=o(33340),te=o(96012);const oe=b.ZP.div.withConfig({displayName:"Common__PanelContainer",componentId:"olc3hh-0"})(["margin:0 12px 12px 12px;font-size:",";width:216px;"],(e=>e.theme.fontSizes.sm)),ne=b.ZP.div.withConfig({displayName:"Common__PropertyRow",componentId:"olc3hh-1"})(["width:100%;height:28px;margin-bottom:",";",""],(e=>{let{$lastItem:t=!1}=e;return t?"0px":"12px"}),(e=>{let{disabled:t=!1}=e;return t&&(0,b.iv)(["opacity:0.4;"])})),re=(0,b.ZP)(ne).withConfig({displayName:"Common__PropertyRowText",componentId:"olc3hh-2"})(["font-size:",";line-height:13px;height:24px;padding-top:1px;padding-bottom:8px;color:",";margin-bottom:0;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),ie=(0,b.ZP)(ne).withConfig({displayName:"Common__TwoButtonRow",componentId:"olc3hh-3"})(["display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:10px;"]),ae=(0,b.ZP)(ne).withConfig({displayName:"Common__ToggleRow",componentId:"olc3hh-4"})(["font-size:",";color:",";height:20px;margin-bottom:12px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;",""],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40),(e=>e.disabled&&"\n    opacity: 0.4;\n  ")),le=(0,b.ZP)(te.Z).withConfig({displayName:"Common__PropertyPanelInput",componentId:"olc3hh-5"})(["height:28px;min-height:28px;margin-top:0;padding:6px 12px;background-color:",";color:",";::placeholder{color:",";}:disabled{background-color:",";border-color:",";color:",";}:disabled::placeholder{color:",";}:focus{background-color:",";border-color:",";}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.colors.inputText}),(e=>{let{theme:t}=e;return t.colors.inputPlaceholder}),(e=>{let{theme:t}=e;return t.colors.inputBgDisabled}),(e=>{let{theme:t}=e;return t.colors.inputBorderDisabled}),(e=>{let{theme:t}=e;return t.colors.inputTextDisabled}),(e=>{let{theme:t}=e;return t.colors.inputPlaceholderDisabled}),(e=>{let{theme:t}=e;return t.colors.inputBgFocus}),(e=>{let{theme:t}=e;return t.colors.inputBorderFocus})),se=b.ZP.textarea.withConfig({displayName:"Common__TextareaInput",componentId:"olc3hh-6"})(["width:100%;height:80px;font-size:13px;line-height:16px;padding:8px;margin:0;background-color:",";appearance:none;display:block;border:none;border-top:none;box-sizing:border-box;border-radius:",";font-size:",";caret-color:",";color:",";outline:none;resize:none;&::selection{background-color:",";}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>e.theme.borderRadius.sm),(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.uiAccent),(e=>e.theme.colors.inputText),(e=>e.theme.colors.textSelection)),ce=b.ZP.div.withConfig({displayName:"Common__InputRow",componentId:"olc3hh-7"})(["width:100%;margin-bottom:12px;"]);var de=o(53569),pe=o(5370),ue=o(79271),me=o(39090);const ge=["isDisabled"],he=["children"],fe=["children","isDisabled"];function be(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ye(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?be(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):be(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ce=b.ZP.div.withConfig({displayName:"TextSelector__OptionContainer",componentId:"sc-93lq8j-0"})(["padding:6px 4px 6px 8px;display:flex;align-items:center;flex-wrap:wrap;"]),ve=b.ZP.div.withConfig({displayName:"TextSelector__OptionValue",componentId:"sc-93lq8j-1"})(["flex:1;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"]),xe=b.ZP.div.withConfig({displayName:"TextSelector__OptionDescription",componentId:"sc-93lq8j-2"})(["margin-top:2px;color:",";font-size:",";line-height:1.2;",":hover &{color:",";}"],(e=>{let{theme:t}=e;return t.colors.menuTextSecondary}),(e=>{let{theme:t}=e;return t.fontSizes.xxs}),Ce,(e=>{let{theme:t}=e;return t.colors.menuTextHover})),Oe=e=>{let{isDisabled:t}=e,o=(0,i.Z)(e,ge);return(0,_.jsx)(de.F.DropdownIndicator,ye(ye({},o),{},{children:t?(0,_.jsx)(ue.Z,{opacity:"0.2",height:"10",width:"10",viewBox:"0 0 10 10"}):(0,_.jsx)(ue.Z,{height:"10",width:"10",viewBox:"0 0 10 10"})}))},Pe=e=>{let{children:t}=e,o=(0,i.Z)(e,he);return(0,_.jsx)(de.F.Option,ye(ye({},o),{},{children:(0,_.jsxs)(Ce,{children:[(0,_.jsx)(ve,{children:t}),o.isSelected&&(0,_.jsx)(me.Z,{}),o.data.description&&(0,_.jsx)(xe,{children:o.data.description})]})}))},we=e=>{let{children:t,isDisabled:o}=e,n=(0,i.Z)(e,fe);return de.F.ValueContainer&&(0,_.jsxs)(de.F.ValueContainer,ye(ye({},n),{},{children:[!!t&&n.selectProps.icon&&(0,_.jsx)(n.selectProps.icon,{style:{width:18,height:18,fill:"currentColor",marginRight:"5px",flex:"none",opacity:o?"0.5":1}}),t]}))};var je=e=>{let{currentValue:t,options:o,onBlur:n,onFocus:r,onChange:i,menuWidth:l,controlWidth:s,disabled:c,icon:d,backgroundColor:p,styles:u,placeholder:m}=e;const g=(0,b.Fg)(),h=o.filter((e=>e.value===t)),f=h.length>0?h[0]:o[0],y=(0,a.useMemo)((()=>({menu:(e,t)=>ye(ye({},e),{},{width:t.selectProps.menuWidth,fontSize:"12px",lineHeight:"16px",marginTop:"-28px",padding:"6px",color:g.colors.menuControlText,backgroundColor:g.colors.menuBackgroundLayer[0]}),control:(e,t)=>ye(ye({},e),{},{width:t.selectProps.controlWidth,border:0,boxShadow:"none",fontSize:"12px",height:"28px",minHeight:"28px",lineHeight:"16px",paddingLeft:"4px",color:g.colors.menuControlText,"&:hover":{backgroundColor:g.colors.contrast12}}),valueContainer:e=>ye(ye({},e),{},{flexWrap:"initial"}),singleValue:()=>({color:g.colors.menuControlText,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}),placeholder:(e,t)=>({color:g.colors.menuControlText,opacity:t.selectProps.isDisabled?.5:1}),menuList:e=>ye(ye({},e),{},{paddingTop:0,paddingBottom:0}),option:(e,t)=>{let{data:o}=t;return ye(ye({},e),{},{borderRadius:"6px",color:o.color||g.colors.menuText,padding:"0px","&:hover":{color:o.colorHover||o.color||g.colors.menuTextHover,backgroundColor:o.backgroundColorHover||g.colors.uiAccent}})},indicatorsContainer:e=>ye(ye({},e),{},{height:"26px",paddingRight:"2px","& > div":{marginTop:"4px"}}),dropdownIndicator:e=>ye(ye({},e),{},{stroke:g.colors.menuControlText})})),[g]),C=ye(ye({},y),u);return(0,_.jsx)(pe.ZP,{isDisabled:c,onChange:e=>i(e.value),onBlur:n,onFocus:r,styles:C,menuWidth:l,controlWidth:s,options:o,isSearchable:!1,value:f,icon:d,placeholder:m||"",components:{DropdownIndicator:Oe,IndicatorSeparator:()=>null,Option:Pe,ValueContainer:we},theme:e=>ye(ye({},e),{},{borderRadius:8,colors:ye(ye({},e.colors),{},{primary25:g.colors.transparent,primary50:g.colors.transparent,primary75:g.colors.transparent,primary:g.colors.transparent,neutral0:p??g.colors.contrast8,neutral5:g.colors.contrast8,neutral10:g.colors.contrast8,neutral90:g.colors.contrast,neutral80:g.colors.contrast,neutral70:g.colors.contrast,neutral60:g.colors.contrast,neutral50:g.colors.contrast})})})},Te=o(24306);const Ee=["style","isSelected"];function Ie(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Se(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ie(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const _e=(e,t)=>{const{style:o,isSelected:n}=e,r=(0,i.Z)(e,Ee),a=(0,b.Fg)();return(0,_.jsxs)(Te.Z,Se(Se({ref:t,style:Se(Se({},o),{},{width:24,height:24,fillOpacity:0,borderRadius:"100%",border:n?`2px solid ${a.colors.contentAccent}`:null}),viewBox:"0 0 24 24"},r),{},{children:[(0,_.jsx)("path",{d:"M21 3L3 21",stroke:n?`${a.colors.contentAccent}`:a.colors.colorSwatchBlackBorder,strokeWidth:"1.5"}),(0,_.jsx)("rect",{x:"0.75",y:"0.75",width:"22.5",height:"22.5",rx:"11.25",stroke:n?"transparent":a.colors.colorSwatchBlackBorder,strokeWidth:"1.5"})]}))};var ke=(0,a.forwardRef)(_e),Ze=o(38621);const De=b.ZP.div.withConfig({displayName:"ColorSelectorstyles__LegacySwatchContainer",componentId:"sc-1xotnel-0"})(["width:100%;height:24px;margin-top:4px;display:flex;flex-direction:row;gap:12px;"]),Me=(0,b.ZP)(Ze.Z).attrs((()=>({type:"button"}))).withConfig({displayName:"ColorSelectorstyles__LegacySwatch",componentId:"sc-1xotnel-1"})(["width:24px;height:24px;border-radius:100%;box-sizing:border-box;",";background:",";",";",";",";background-size:cover;"],(e=>e.$isSelected&&`border: 2px solid ${e.$colorPickerMode?e.theme.colors.contrast:e.theme.colors.uiAccent}`),(e=>"black"===e.$color?e.theme.colors.colorSwatchBlack:"light"===e.$color?e.theme.colors.colorSwatchWhite:null),(e=>"black"===e.$color&&!e.$isSelected&&`border: 1.5px solid ${e.theme.colors.colorSwatchBlackBorder}`),(e=>"light"===e.$color&&!e.$isSelected&&`border: 1.5px solid ${e.theme.colors.colorSwatchBlackBorder}`),(e=>e.$colorPickerMode&&"background: url(/assets/color-picker.png)"));var Re;!function(e){e[e.dark=0]="dark",e[e.light=1]="light",e[e.black=2]="black"}(Re||(Re={}));var Ae=e=>{let t,{color:o,setColor:n,disabled:r}=e;t="black"===o?"black":"light"===o?"light":"dark"===o?"dark":"custom";const i=(0,a.useCallback)((e=>{n(e.currentTarget.value)}),[n]),l=(0,I.t2)(),{t:s}=(0,y.$G)(),c=(0,a.useCallback)((()=>{l.pushPropertyPanel(S.Z.COLOR_PICKER)}),[l]);return(0,_.jsxs)(De,{children:[(0,_.jsx)(Me,{disabled:r,title:"#00000",value:"black",$isSelected:"black"===t,$color:"black",onClick:i,"data-testid":"black_color_input"}),(0,_.jsx)(Me,{disabled:r,title:"#ffffff",value:"light",$isSelected:"light"===t,$color:"light",onClick:i,"data-testid":"white_color_input"}),(0,_.jsx)(Me,{disabled:r,title:`${s("library.colorSelector.onhoverTitle.chooseAColor")}`,$colorPickerMode:!0,$isSelected:"custom"===t,onClick:c,"data-testid":"custom_color_input"}),(0,_.jsx)(Me,{disabled:r,title:`${s("library.colorSelector.onhoverTitle.removeBackgroundColor")}`,value:"dark",$isSelected:!1,onClick:i,children:(0,_.jsx)(ke,{isSelected:"dark"===t})})]})},Le=o(78963),Ne=o(83942),He=o(38156),Ve=o(34136),Be=o(88554);const $e=b.ZP.div.withConfig({displayName:"SegmentedControls",componentId:"sc-1oyxyb-0"})(["display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);& button{min-width:unset;}& button:nth-child(1) span{border-top-right-radius:0px;border-bottom-right-radius:0px;}& button:not(:first-child):not(:last-child) span{border-radius:0px;}& button:nth-last-child(1) span{border-top-left-radius:0px;border-bottom-left-radius:0px;}border:1px solid ",";border-radius:",';& [aria-selected="true"] ',"{background:",";}}"],(e=>e.theme.colors.segmentedBorder),Be.n.default,Ve.e,(e=>{let{theme:t}=e;return t.colors.segmentedSelected}));var Fe=$e,Ge=o(17463),ze=o(10196),Ue=o(70777),We=o(33159);function qe(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ke(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):qe(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Ye=e=>{let{tileData:t,updateTileData:o}=e;const{apolloClient:n}=(0,H.bp)(),r=(0,a.useRef)(null),i=(0,l.Zl)(Le.cm),s=(0,l.Zl)(Le.VJ),c=(0,l.Zl)((0,Ge.vw)(t.id)),d=(0,a.useCallback)((e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];c((0,Ge.aY)(t))}}),[c]),{imageAttributes:p,mediaTileData:u,id:m,tomeId:g}=t,{mediaFillType:h,backgroundColor:f,captionStyle:b,fillCropCenterX:C,fillCropCenterY:v,fillCropScale:x,mediaStatus:O}=u||{},P=h||Y.AL,w=f||Y.M2,j=O===U.Jpv.UploadInProgress,T=(0,a.useCallback)((e=>{o((t=>Ke(Ke({},t),{},{mediaTileData:Ke(Ke({},t.mediaTileData),{},{mediaFillType:e})}))),We.ZP.reportImageFillTypeChange({apolloClient:n,tomeId:g,tileId:m,fillType:e})}),[o,g,m,n]),E=b||Y.Io,k=(0,Y.Gj)(p,O),Z=(0,a.useCallback)((e=>{const t=e;o((e=>Ke(Ke({},e),{},{mediaTileData:Ke(Ke({},e.mediaTileData),{},{captionStyle:t})}))),E!==U.ubC.None&&null!==E||t===U.ubC.None||(0,V.VY)(!0)}),[E,o]),D=(0,a.useCallback)((e=>(0,Ne.$V)(o,e)),[o]),M=(0,a.useCallback)((e=>{o((t=>Ke(Ke({},t),{},{mediaTileData:Ke(Ke({},t.mediaTileData),{},{backgroundColor:e})}))),We.ZP.reportImageBackgroundColorChange({apolloClient:n,tomeId:g,tileId:m,color:e})}),[o,n,g,m]),R=null!=C&&null!=v&&null!=x,A=(0,a.useCallback)((()=>{P!==U.EwX.Fill&&P!==U.EwX.Fit||R?T(U.EwX.Crop):(s(P),i(!0))}),[P,R,i,s,T]),L=(0,a.useCallback)((()=>{s(P),i(!0)}),[P,i,s]),N=(0,I.t2)(),B=(0,a.useCallback)((()=>{N.pushPropertyPanel(S.Z.IMAGE_CREATE)}),[N]),{t:$}=(0,y.$G)();return(0,_.jsxs)(_.Fragment,{children:[(t.type===U.YUT.Image||t.type===U.YUT.ImageGenerative)&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(ie,{style:{height:"56px"},children:[(0,_.jsx)(Ve.Z,{onClick:B,size:"tall",startIcon:(0,_.jsx)(ze.Z,{}),iconStyles:{width:"16px",height:"16px"},children:$("sidebar.media.create")}),(0,_.jsx)(He.Z,{onClick:()=>{var e;null===(e=r.current)||void 0===e||e.click()},actionText:$("sidebar.media.upload"),disabled:j,style:{width:"100%"},size:"tall",startIcon:(0,_.jsx)(Ue.Z,{}),iconStyles:{width:"16px",height:"16px"}})]}),(0,_.jsx)("input",{ref:r,type:"file",accept:Y.lW,onChange:d,style:{display:"none"}})]}),t.type===U.YUT.Giphy&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(re,{children:$("sidebar.media.URL")}),(0,_.jsx)(ne,{children:(0,_.jsx)(le,{type:"text",value:t.contentLink||"",onChange:e=>D(e.target.value),placeholder:$("sidebar.media.giphyLink")})})]}),(0,_.jsx)(re,{disabled:k,children:$("sidebar.media.size")}),(0,_.jsxs)(Fe,{style:{marginBottom:12},role:"listbox",children:[(0,_.jsx)(Ve.Z,{disabled:k,"data-testid":"image_fill_type_fit_option",selected:P===U.EwX.Fit,onClick:()=>T(U.EwX.Fit),isSegment:!0,children:$("sidebar.media.fit")}),(0,_.jsx)(Ve.Z,{disabled:k,"data-testid":"image_fill_type_fill_option",selected:P===U.EwX.Fill,onClick:()=>T(U.EwX.Fill),isSegment:!0,children:$("sidebar.media.fill")}),(0,_.jsx)(Ve.Z,{disabled:k,"data-testid":"image_fill_type_crop_option",selected:P===U.EwX.Crop,onClick:A,isSegment:!0,children:$("sidebar.media.custom")})]}),(0,_.jsx)(ne,{children:(0,_.jsx)(Ve.Z,{disabled:k,onClick:L,style:{width:"100%"},children:$("sidebar.media.adjust")})}),(0,_.jsx)(re,{disabled:k,children:$("sidebar.caption")}),(0,_.jsx)(ne,{disabled:k,"data-testid":"image_caption_input",children:(0,_.jsx)(je,{disabled:k,currentValue:E,options:[{value:"none",label:$("sidebar.none")},{value:"top",label:$("sidebar.top")},{value:"bottom",label:$("sidebar.bottom")}],onChange:Z,menuWidth:"100%",controlWidth:"100%"})}),(0,_.jsx)(re,{disabled:k,children:$("sidebar.backgroundColor")}),(0,_.jsx)(ne,{disabled:k,"data-testid":"image_background_color_input",$lastItem:!0,children:(0,_.jsx)(Ae,{color:w,setColor:M,disabled:k})})]})},Je=o(46075),Xe=o(59361),Qe=o(77206);function et(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function tt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?et(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):et(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var ot=e=>{let{tileData:t,updateTileData:o}=e;const{id:n,videoTileData:r,mediaTileData:i}=t,{autoplay:s,loop:c,url:d}=r||{},{captionStyle:p,mediaFillType:u,fillCropCenterX:m,fillCropCenterY:g,fillCropScale:h,backgroundColor:f}=i||{},b=(0,$.ye)($.TT.NARRATION_VIDEO_OVERRIDE),C=(0,a.useRef)(null),v=(0,l.Zl)(Le.s5),x=(0,l.Zl)(Le.VJ),O=(0,l.Zl)((0,Ge.vw)(n)),P=(0,a.useCallback)((e=>{if(e.target.files&&e.target.files.length>0){const t=e.target.files[0];O((0,Ge.aY)(t))}}),[O]),w=f||Y.M2,j=u||U.EwX.Fit,T=(null===i||void 0===i?void 0:i.mediaStatus)===U.Jpv.UploadInProgress,E=(0,l.sJ)((0,Qe.M)({tileId:t.id,url:d||""})),I=(0,Xe.M)(i||void 0,E),S=(0,a.useCallback)((e=>{o((t=>tt(tt({},t),{},{mediaTileData:tt(tt({},t.mediaTileData),{},{captionStyle:e})}))),"none"!==p&&null!==p||"none"===e||(0,V.VY)(!0)}),[p,o]),k=(0,a.useCallback)((()=>{o((e=>{var t;return tt(tt({},e),{},{videoTileData:tt(tt({},e.videoTileData),{},{autoplay:!(null!==(t=e.videoTileData)&&void 0!==t&&t.autoplay)})})}))}),[o]),Z=(0,a.useCallback)((()=>{o((e=>{var t;return tt(tt({},e),{},{videoTileData:tt(tt({},e.videoTileData),{},{loop:!(null!==(t=e.videoTileData)&&void 0!==t&&t.loop)})})}))}),[o]),D=(0,a.useCallback)((e=>{o((t=>tt(tt({},t),{},{mediaTileData:tt(tt({},t.mediaTileData),{},{backgroundColor:e})})))}),[o]),M=(0,a.useCallback)((e=>{o((t=>tt(tt({},t),{},{mediaTileData:tt(tt({},t.mediaTileData),{},{mediaFillType:e})})))}),[o]),R=null!=m&&null!=g&&null!=h,A=(0,a.useCallback)((()=>{j!==U.EwX.Fill&&j!==U.EwX.Fit||R?M(U.EwX.Crop):(x(j),v(!0))}),[j,R,v,x,M]),L=(0,a.useCallback)((()=>{x(j),v(!0)}),[j,v,x]),{t:N}=(0,y.$G)();return(0,_.jsxs)(_.Fragment,{children:[b&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(re,{children:N("sidebar.media.muxVideoId")}),(0,_.jsx)(ne,{style:{userSelect:"text"},children:N("sidebar.media.videoId",{videoId:null===r||void 0===r?void 0:r.videoId})||"null"})]}),(0,_.jsx)(ne,{children:(0,_.jsx)(He.Z,{style:{width:"100%"},onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},actionText:N("sidebar.media.upload"),disabled:T})}),(0,_.jsx)(re,{disabled:I,children:N("sidebar.media.size")}),(0,_.jsxs)(Fe,{style:{marginBottom:12},role:"listbox",children:[(0,_.jsx)(Ve.Z,{disabled:I,"data-testid":"video_fill_type_fit_option",selected:j===U.EwX.Fit,onClick:()=>M(U.EwX.Fit),isSegment:!0,children:N("sidebar.media.fit")}),(0,_.jsx)(Ve.Z,{disabled:I,"data-testid":"video_fill_type_fill_option",selected:j===U.EwX.Fill,onClick:()=>M(U.EwX.Fill),isSegment:!0,children:N("sidebar.media.fill")}),(0,_.jsx)(Ve.Z,{disabled:I,"data-testid":"video_fill_type_crop_option",selected:j===U.EwX.Crop,onClick:A,isSegment:!0,children:N("sidebar.media.custom")})]}),(0,_.jsxs)(ie,{children:[(0,_.jsx)(Ve.Z,{disabled:I,onClick:L,children:N("sidebar.media.adjust")}),(0,_.jsx)(Ve.Z,{disabled:I,onClick:()=>(0,V.PS)(!(0,V.PS)()),children:N("sidebar.media.trim")})]}),(0,_.jsxs)(ae,{disabled:I,children:[(0,_.jsx)("label",{htmlFor:"VideoSidebarAutoplay",children:N("sidebar.media.autoplay")}),(0,_.jsx)(Je.Z,{inputId:"VideoSidebarAutoplay",width:"40px",height:"20px",onBgColor:!0,checked:!!s,disabled:I,onClick:k})]}),(0,_.jsxs)(ae,{disabled:I,children:[(0,_.jsx)("label",{htmlFor:"VideoSidebarRepeat",children:N("sidebar.media.repeat")}),(0,_.jsx)(Je.Z,{inputId:"VideoSidebarRepeat",width:"40px",height:"20px",onBgColor:!0,checked:!!c,disabled:I,onClick:Z})]}),(0,_.jsx)(re,{disabled:I,children:N("sidebar.caption")}),(0,_.jsx)(ne,{disabled:I,"data-testid":"video_caption_input",children:(0,_.jsx)(je,{disabled:I,currentValue:p||"none",options:[{value:"none",label:N("sidebar.none")},{value:"top",label:N("sidebar.top")},{value:"bottom",label:N("sidebar.bottom")}],onChange:S,menuWidth:"100%",controlWidth:"100%"})}),(0,_.jsx)(re,{disabled:I,children:N("sidebar.backgroundColor")}),(0,_.jsx)(ne,{$lastItem:!0,disabled:I,children:(0,_.jsx)(Ae,{color:w,setColor:D,disabled:I})}),(0,_.jsx)("input",{ref:C,type:"file",accept:"video/*",onChange:P,style:{display:"none"}})]})},nt=o(90574);function rt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function it(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):rt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var at=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,it(it({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{d:"M12 32C12 30.8954 12.8954 30 14 30H50C51.1046 30 52 30.8954 52 32C52 33.1046 51.1046 34 50 34H14C12.8954 34 12 33.1046 12 32Z"})}))));const lt=b.ZP.div.withConfig({displayName:"Stepper__StepperWrapper",componentId:"sc-1xh2odp-0"})(["display:flex;align-items:center;border-radius:8px;width:fit-content;padding:4px;background-color:",";"],(e=>e.theme.colors.stepperBackground)),st=(0,b.ZP)(Ve.Z).withConfig({displayName:"Stepper__StepButton",componentId:"sc-1xh2odp-1"})(["min-width:24px;padding:0 0px;height:20px;","{border-radius:4px;}"],Ve.e),ct=b.ZP.input.withConfig({displayName:"Stepper__CustomInput",componentId:"sc-1xh2odp-2"})(["background-color:transparent;height:20px;color:",";border:0;border-radius:0;padding:0;width:46px;outline:none;caret-color:",";text-align:center;display:inline-block;"],(e=>e.theme.colors.inputText),(e=>e.theme.colors.uiAccent));var dt=e=>{let{max:t=Number.MAX_SAFE_INTEGER,min:o=Number.MIN_SAFE_INTEGER,step:n=1,setValue:r,value:i}=e;const l=(0,a.useCallback)((()=>{r((e=>e+n<=t?e+n:e))}),[t,r,n]),s=(0,a.useCallback)((()=>{r((e=>e-n>=o?e-n:e))}),[o,r,n]),{t:c}=(0,y.$G)();return(0,_.jsxs)(lt,{children:[(0,_.jsx)(st,{onClick:s,"aria-label":c("library.stepper.ariaLabelDecreaseValue"),disabled:i-n<o,size:"small",variant:"text",iconOpacity:1,startIcon:(0,_.jsx)(at,{style:{width:16}}),iconStyles:{margin:0}}),(0,_.jsx)(ct,{value:i,readOnly:!0,autoComplete:"off",role:"spinbutton","aria-valuemin":o,"aria-valuemax":t,"aria-valuenow":i}),(0,_.jsx)(st,{onClick:l,"aria-label":c("library.stepper.ariaLabelIncreaseValue"),disabled:i+n>t,size:"small",variant:"text",iconOpacity:1,startIcon:(0,_.jsx)(nt.Z,{style:{width:16}}),iconStyles:{margin:0}})]})},pt=o(83926),ut=o(17382),mt=o(60112),gt=o(73849);function ht(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ft(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ht(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const bt=b.ZP.div.withConfig({displayName:"TableSidebar__StepperColumn",componentId:"sc-1kwyfv4-0"})(["padding-bottom:12px;"]);var yt=e=>{var t,o,n,r;let{isSelectedTileSquare:i,tileData:l,updateTileData:s}=e;const{tableTileData:c}=l,{showTitle:d,wrapText:p}=c,u=(0,a.useMemo)((()=>{var e;return((null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.data)||[]).map((e=>e.id))}),[c]),m=(0,a.useMemo)((()=>{var e;return((null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.columns)||[]).map((e=>e.accessor))}),[c]),g=(0,a.useRef)({data:null===c||void 0===c||null===(t=c.payload)||void 0===t?void 0:t.data,columns:null===c||void 0===c||null===(o=c.payload)||void 0===o?void 0:o.columns});(0,a.useEffect)((()=>{var e;g.current.data=null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.data}),[null===c||void 0===c||null===(n=c.payload)||void 0===n?void 0:n.data]),(0,a.useEffect)((()=>{var e;g.current.columns=null===c||void 0===c||null===(e=c.payload)||void 0===e?void 0:e.columns}),[null===c||void 0===c||null===(r=c.payload)||void 0===r?void 0:r.columns]);const h=(0,mt.Z)(g,l.id).deselectAllCells,f=(0,a.useCallback)((e=>(0,ut.Sd)(s,e)),[s]),{deleteColumn:b,deleteRow:C,insertColumn:v,insertRow:x}=(0,pt.ZP)(f,h),O=(0,a.useCallback)((()=>{s((e=>{var t;return ft(ft({},e),{},{tableTileData:ft(ft({},e.tableTileData),{},{showTitle:!(null!==e&&void 0!==e&&null!==(t=e.tableTileData)&&void 0!==t&&t.showTitle)})})}))}),[s]),P=(0,a.useCallback)((()=>{s((e=>{var t;return ft(ft({},e),{},{tableTileData:ft(ft({},e.tableTileData),{},{wrapText:!(null!==e&&void 0!==e&&null!==(t=e.tableTileData)&&void 0!==t&&t.wrapText)})})}))}),[s]),w=(0,a.useCallback)((e=>{const t=e(u.length)-u.length;t>0&&x(),t<0&&C(u[u.length-1])}),[C,x,u]),j=(0,a.useCallback)((e=>{const t=e(m.length)-m.length;t>0&&v(gt.Hr.string),t<0&&b(m[m.length-1])}),[m,v,b]),T=(0,a.useCallback)((()=>{s((e=>{var t;const o=i()?1:2,n=Object.entries(null===(t=e.tableTileData)||void 0===t?void 0:t.columnWidths),r=1/n.length*o,a=Object.fromEntries(n.map((e=>{let[t]=e;return[t,r]})));return ft(ft({},e),{},{tableTileData:ft(ft({},e.tableTileData),{},{columnWidths:a})})}))}),[s,i]),{t:E}=(0,y.$G)();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,_.jsxs)(bt,{"data-testid":"table_row_stepper",children:[(0,_.jsx)(re,{children:E("sidebar.rows")}),(0,_.jsx)(dt,{min:1,max:100,value:u.length,setValue:w})]}),(0,_.jsxs)(bt,{"data-testid":"table_column_stepper",children:[(0,_.jsx)(re,{children:E("sidebar.columns")}),(0,_.jsx)(dt,{min:1,max:100,value:m.length,setValue:j})]})]}),(0,_.jsxs)(ae,{children:[(0,_.jsx)("label",{htmlFor:"TableSidebarShowTitle",children:E("sidebar.showTitle")}),(0,_.jsx)(Je.Z,{inputId:"TableSidebarShowTitle",width:"40px",height:"20px",onBgColor:!0,checked:!!d,onClick:O})]}),(0,_.jsxs)(ae,{children:[(0,_.jsx)("label",{htmlFor:"TableSidebarWrapText",children:E("sidebar.wrapText")}),(0,_.jsx)(Je.Z,{inputId:"TableSidebarWrapText",width:"40px",height:"20px",onBgColor:!0,checked:!!p,onClick:P})]}),(0,_.jsx)(ne,{$lastItem:!0,children:(0,_.jsx)(Ve.Z,{onClick:T,style:{width:"100%"},children:E("sidebar.distributeColumns")})})]})},Ct=o(26190),vt=o(89030);const xt=b.ZP.div.withConfig({displayName:"MessageWithTag__MessageContainer",componentId:"sc-12nq4be-0"})(["line-height:16px;"]),Ot=b.ZP.span.withConfig({displayName:"MessageWithTag__Message",componentId:"sc-12nq4be-1"})(["font-style:normal;font-weight:normal;font-size:11px;line-height:15px;color:",";"],(e=>e.theme.colors.contrast40));var Pt=e=>{let{message:t,tag:o}=e;return(0,_.jsxs)(xt,{children:[(0,_.jsx)(vt.Vp,{color:"gray",children:o})," ",(0,_.jsx)(Ot,{children:t})]})};function wt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function jt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):wt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Tt=e=>{let{tileData:t,updateTileData:o}=e;const n=(0,K.An)(t.type),r=n.length>0?n[0].label:void 0,{t:i}=(0,y.$G)();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(re,{children:i("sidebar.url")}),(0,_.jsx)(ne,{children:(0,_.jsx)(le,{type:"text",value:t.contentLink||"",onChange:e=>{o((t=>jt(jt({},t),{},{contentLink:e.target.value})))},placeholder:`${i("sidebar.embed.placeholder",r?{tileType:r,context:"tileLabel"}:{})}`,onContextMenuCapture:Ct.Z})}),r&&(0,_.jsx)(Pt,{tag:i("tag.tip"),message:`${i("sidebar.embed.message",r?{tileType:r,context:"tileLabel"}:{})}`})]})},Et=o(99990);function It(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function St(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?It(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):It(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const _t=(e,t)=>(0,_.jsxs)(Te.Z,St(St({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M15.2731 27.6365C17.2814 27.6365 18.9094 26.0084 18.9094 24.0001C18.9094 21.9918 17.2814 20.3638 15.2731 20.3638C13.2648 20.3638 11.6367 21.9918 11.6367 24.0001C11.6367 26.0084 13.2648 27.6365 15.2731 27.6365Z"}),(0,_.jsx)("path",{d:"M31.2731 27.6365C33.2814 27.6365 34.9094 26.0084 34.9094 24.0001C34.9094 21.9918 33.2814 20.3638 31.2731 20.3638C29.2648 20.3638 27.6367 21.9918 27.6367 24.0001C27.6367 26.0084 29.2648 27.6365 31.2731 27.6365Z"}),(0,_.jsx)("path",{d:"M50.9094 24.0001C50.9094 26.0084 49.2814 27.6365 47.2731 27.6365C45.2648 27.6365 43.6367 26.0084 43.6367 24.0001C43.6367 21.9918 45.2648 20.3638 47.2731 20.3638C49.2814 20.3638 50.9094 21.9918 50.9094 24.0001Z"}),(0,_.jsx)("path",{d:"M15.2731 43.6365C17.2814 43.6365 18.9094 42.0084 18.9094 40.0001C18.9094 37.9918 17.2814 36.3638 15.2731 36.3638C13.2648 36.3638 11.6367 37.9918 11.6367 40.0001C11.6367 42.0084 13.2648 43.6365 15.2731 43.6365Z"}),(0,_.jsx)("path",{d:"M34.9094 40.0001C34.9094 42.0084 33.2814 43.6365 31.2731 43.6365C29.2648 43.6365 27.6367 42.0084 27.6367 40.0001C27.6367 37.9918 29.2648 36.3638 31.2731 36.3638C33.2814 36.3638 34.9094 37.9918 34.9094 40.0001Z"}),(0,_.jsx)("path",{d:"M47.2731 43.6365C49.2814 43.6365 50.9094 42.0084 50.9094 40.0001C50.9094 37.9918 49.2814 36.3638 47.2731 36.3638C45.2648 36.3638 43.6367 37.9918 43.6367 40.0001C43.6367 42.0084 45.2648 43.6365 47.2731 43.6365Z"})]}));var kt=(0,a.forwardRef)(_t),Zt=o(24581),Dt=o(2372);const Mt="12px",Rt=(0,b.ZP)(kt).withConfig({displayName:"SidebarTemplate__CustomDraggableIcon",componentId:"sc-1ipmnnf-0"})(["position:absolute;top:11px;left:0;right:0;margin-left:auto;margin-right:auto;fill:",";transition:fill 0.2s ease-out;"],(e=>{let{theme:t}=e;return t.colors.sidebarDraggingIcon})),At=(0,b.iv)(["&:hover{cursor:grab;& ","{fill:",";}}"],Rt,(e=>{let{theme:t}=e;return t.colors.sidebarDraggingIconHover})),Lt=b.ZP.div.withConfig({displayName:"SidebarTemplate__PanelHeader",componentId:"sc-1ipmnnf-1"})(["width:100%;padding-left:",";padding-right:",";padding-top:12px;padding-bottom:12px;display:flex;flex-direction:row;align-items:center;z-index:999999999;position:relative;",""],Mt,Mt,(e=>{let{$draggable:t}=e;return t&&At})),Nt=(0,b.iv)(["justify-content:center;width:100%;position:absolute;left:0;"]),Ht=b.ZP.div.withConfig({displayName:"SidebarTemplate__HeaderLabel",componentId:"sc-1ipmnnf-2"})(["font-size:",";color:",";line-height:20px;font-weight:600;flex:1;white-space:nowrap;display:flex;",";"],(e=>{let{$smallFont:t,theme:o}=e;return t?o.fontSizes.sm:o.fontSizes.smmd}),(e=>{let{theme:t}=e;return t.colors.sidebarHeaderText}),(e=>{let{$childLabel:t}=e;return t&&Nt})),Vt=(0,b.iv)(["height:24px;width:24px;min-width:auto;"]),Bt=(0,b.ZP)(Ve.Z).attrs({variant:"text"}).withConfig({displayName:"SidebarTemplate__CloseButton",componentId:"sc-1ipmnnf-3"})(["position:absolute;right:12px;top:10px;",""],Vt),$t=(0,b.ZP)(Ze.Z).withConfig({displayName:"SidebarTemplate__CloseButtonInteractionTarget",componentId:"sc-1ipmnnf-4"})(["position:absolute;right:0px;top:0px;height:40px;width:38px;cursor:pointer;"]),Ft=(0,b.ZP)(Ve.Z).withConfig({displayName:"SidebarTemplate__SidebarHeaderButton",componentId:"sc-1ipmnnf-5"})([""," margin-left:-4px;z-index:",";"],Vt,T.Mf+1),Gt=b.ZP.div.withConfig({displayName:"SidebarTemplate__PanelContent",componentId:"sc-1ipmnnf-6"})(["will-change:height,padding;padding:",";",""],(e=>e.$noPadding?"0px":"8px 12px 12px 12px"),(e=>"number"===typeof e.$imageCreatePanelsMaxHeight&&(0,b.iv)(["max-height:","px;overflow-y:auto;"],e.$imageCreatePanelsMaxHeight))),zt=(0,b.ZP)(vt.Ur).withConfig({displayName:"SidebarTemplate__SidebarBetaTag",componentId:"sc-1ipmnnf-7"})([":first-child{line-height:100%;margin:3px 0 3px 6px;}"]),Ut=[S.Z.IMAGE_CREATE,S.Z.IMAGE_GENERATION_HISTORY];var Wt=(0,a.forwardRef)(((e,t)=>{let{hasHeader:o,headerText:n,contentNoPadding:r,panelContent:i,headerBetaTag:s=!1,draggable:c,startDrag:d}=e;const p=(0,I.Z5)(),u=(0,I.t2)(),m=(0,I.f3)(),{0:g,1:h}=(0,a.useState)(!1),{height:f}=(0,F.Z)(),b=(0,l.sJ)(ee.ej),C=(0,a.useCallback)((e=>{c&&d&&(d(e),h(!0))}),[c,d]),v=(0,a.useCallback)((()=>{h(!1)}),[]),x=(0,L.E)(),O=(0,a.useCallback)((()=>{x.start("hover")}),[x]),P=(0,a.useCallback)((()=>{x.start("default")}),[x]),w=(0,a.useCallback)((()=>{x.start("active"),u.closePropertyPanel()}),[x,u]),j=!!m&&Ut.includes(m),{t:T}=(0,y.$G)();return(0,_.jsxs)("div",{ref:t,children:[o&&(0,_.jsxs)(Lt,{onPointerDown:C,onPointerUp:v,$draggable:c,children:[p>1&&(0,_.jsx)(Ft,{variant:"text",size:"small","data-testid":"property_panel_back_button",startIcon:(0,_.jsx)(Et.Z,{style:{height:20,width:20}}),iconStyles:{margin:0},onClick:u.popPropertyPanel}),(0,_.jsxs)(Ht,{"data-testid":"property_panel_header_label",$smallFont:!!c,$childLabel:p>1,children:[n,s&&(0,_.jsx)(zt,{})]}),c&&(0,_.jsxs)(_.Fragment,{children:[p<=1&&(0,_.jsx)(Rt,{style:{width:22,height:22}}),(0,_.jsx)(Bt,{size:"small",animationControls:x,iconStyles:{margin:0},icon:(0,_.jsx)(Zt.Z,{style:{width:22,height:22}}),iconOpacity:.2}),(0,_.jsx)($t,{"aria-label":T("sidebar.closePanel"),onMouseOver:O,onMouseOut:P,onClick:w})]})]}),(0,_.jsx)(Gt,{$imageCreatePanelsMaxHeight:j?f-48-156:void 0,style:{height:m===S.Z.IMAGE_GENERATION_HISTORY?Math.max(b,476):"unset"},$noPadding:r,children:i}),g&&(0,_.jsx)(Dt.Z,{})]})})),qt=o(50576),Kt=o(59764),Yt=o(32579);var Jt=()=>{const{activeEditorRef:e}=(0,a.useContext)(Kt.f);return(0,l.sJ)(Yt.Z),e.current},Xt=o(69029),Qt=o(12459),eo=o(96375),to=o(65111);function oo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function no(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?oo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):oo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var ro=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,no(no({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M12 20C12 18.8954 12.8954 18 14 18H50C51.1046 18 52 18.8954 52 20C52 21.1046 51.1046 22 50 22H14C12.8954 22 12 21.1046 12 20Z"}),(0,_.jsx)("path",{d:"M12 32C12 30.8954 12.8954 30 14 30H38C39.1046 30 40 30.8954 40 32C40 33.1046 39.1046 34 38 34H14C12.8954 34 12 33.1046 12 32Z"}),(0,_.jsx)("path",{d:"M14 42C12.8954 42 12 42.8954 12 44C12 45.1046 12.8954 46 14 46H50C51.1046 46 52 45.1046 52 44C52 42.8954 51.1046 42 50 42H14Z"})]}))));function io(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ao(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?io(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):io(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var lo=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,ao(ao({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M12 20C12 18.8954 12.8954 18 14 18H50C51.1046 18 52 18.8954 52 20C52 21.1046 51.1046 22 50 22H14C12.8954 22 12 21.1046 12 20Z"}),(0,_.jsx)("path",{d:"M18 32C18 30.8954 18.8954 30 20 30H44C45.1046 30 46 30.8954 46 32C46 33.1046 45.1046 34 44 34H20C18.8954 34 18 33.1046 18 32Z"}),(0,_.jsx)("path",{d:"M14 42C12.8954 42 12 42.8954 12 44C12 45.1046 12.8954 46 14 46H50C51.1046 46 52 45.1046 52 44C52 42.8954 51.1046 42 50 42H14Z"})]}))));function so(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function co(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?so(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):so(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var po=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,co(co({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M12 20C12 18.8954 12.8954 18 14 18H50C51.1046 18 52 18.8954 52 20C52 21.1046 51.1046 22 50 22H14C12.8954 22 12 21.1046 12 20Z"}),(0,_.jsx)("path",{d:"M24 32C24 30.8954 24.8954 30 26 30H50C51.1046 30 52 30.8954 52 32C52 33.1046 51.1046 34 50 34H26C24.8954 34 24 33.1046 24 32Z"}),(0,_.jsx)("path",{d:"M14 42C12.8954 42 12 42.8954 12 44C12 45.1046 12.8954 46 14 46H50C51.1046 46 52 45.1046 52 44C52 42.8954 51.1046 42 50 42H14Z"})]}))));function uo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function mo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?uo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):uo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var go=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,mo(mo({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M14 18C12.8954 18 12 18.8954 12 20C12 21.1046 12.8954 22 14 22H50C51.1046 22 52 21.1046 52 20C52 18.8954 51.1046 18 50 18H14Z"}),(0,_.jsx)("path",{d:"M33.4142 33.5858C32.6332 32.8047 31.3668 32.8047 30.5858 33.5858L22.5858 41.5858C21.8047 42.3668 21.8047 43.6332 22.5858 44.4142C23.3668 45.1953 24.6332 45.1953 25.4142 44.4142L32 37.8284L38.5858 44.4142C39.3668 45.1953 40.6332 45.1953 41.4142 44.4142C42.1953 43.6332 42.1953 42.3668 41.4142 41.5858L33.4142 33.5858Z"})]}))));function ho(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function fo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ho(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ho(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var bo=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,fo(fo({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M33.4142 24.4142L41.4142 16.4142C42.1953 15.6332 42.1953 14.3668 41.4142 13.5858C40.6332 12.8047 39.3668 12.8047 38.5858 13.5858L32 20.1716L25.4142 13.5858C24.6332 12.8047 23.3668 12.8047 22.5858 13.5858C21.8047 14.3668 21.8047 15.6332 22.5858 16.4142L30.5858 24.4142C31.3668 25.1953 32.6332 25.1953 33.4142 24.4142Z"}),(0,_.jsx)("path",{d:"M12 32C12 33.1046 12.8954 34 14 34H50C51.1046 34 52 33.1046 52 32C52 30.8954 51.1046 30 50 30H14C12.8954 30 12 30.8954 12 32Z"}),(0,_.jsx)("path",{d:"M41.4142 47.5858L33.4142 39.5858C32.6332 38.8047 31.3668 38.8047 30.5858 39.5858L22.5858 47.5858C21.8047 48.3668 21.8047 49.6332 22.5858 50.4142C23.3668 51.1953 24.6332 51.1953 25.4142 50.4142L32 43.8284L38.5858 50.4142C39.3668 51.1953 40.6332 51.1953 41.4142 50.4142C42.1953 49.6332 42.1953 48.3668 41.4142 47.5858Z"})]}))));function yo(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Co(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?yo(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):yo(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var vo=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,Co(Co({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M41.4142 22.4142L33.4142 30.4142C32.6332 31.1953 31.3668 31.1953 30.5858 30.4142L22.5858 22.4142C21.8047 21.6332 21.8047 20.3668 22.5858 19.5858C23.3668 18.8047 24.6332 18.8047 25.4142 19.5858L32 26.1716L38.5858 19.5858C39.3668 18.8047 40.6332 18.8047 41.4142 19.5858C42.1953 20.3668 42.1953 21.6332 41.4142 22.4142Z"}),(0,_.jsx)("path",{d:"M14 46C12.8954 46 12 45.1046 12 44C12 42.8954 12.8954 42 14 42H50C51.1046 42 52 42.8954 52 44C52 45.1046 51.1046 46 50 46H14Z"})]})))),xo=o(24603),Oo=o(40105);function Po(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Po(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Po(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var jo=(e,t)=>wo(wo({},e),{},{textTileData:wo(wo({},e.textTileData),t)}),To=o(767),Eo=o(49279);const Io=(0,b.ZP)(Ve.Z).attrs(Eo.S7).withConfig({displayName:"SlateTextSidebar__TextStyleButton",componentId:"uc20ao-0"})(["width:50%;"]),So=(0,b.ZP)(ne).withConfig({displayName:"SlateTextSidebar__TextStyleRow",componentId:"uc20ao-1"})(["position:relative;display:flex;margin-bottom:8px;"," + ","{margin-left:8px;}:last-child{margin-bottom:0;}"],Io,Io),_o=(0,b.ZP)(Io).withConfig({displayName:"SlateTextSidebar__DisplayButton",componentId:"uc20ao-2"})(["font-size:17px;font-weight:600;"]),ko=(0,b.ZP)(Io).withConfig({displayName:"SlateTextSidebar__TitleButton",componentId:"uc20ao-3"})(["font-size:16px;font-weight:600;"]),Zo=(0,b.ZP)(Io).withConfig({displayName:"SlateTextSidebar__HeadingButton",componentId:"uc20ao-4"})(["font-size:14.5px;font-weight:600;"]),Do=(0,b.ZP)(Io).withConfig({displayName:"SlateTextSidebar__SubheadingButton",componentId:"uc20ao-5"})(["font-size:13px;font-weight:600;"]),Mo=(0,b.ZP)("span").withConfig({displayName:"SlateTextSidebar__GroupLabel",componentId:"uc20ao-6"})(["display:flex;color:",";font-size:",";margin-top:12px;margin-bottom:8px;:first-child{margin-top:0;}"],(e=>e.theme.colors.commentEditorPlaceholder),(e=>e.theme.fontSizes.xxs)),Ro=(0,b.ZP)(Io).attrs(Eo.S7).withConfig({displayName:"SlateTextSidebar__BodyButton",componentId:"uc20ao-7"})(["font-size:13px;font-weight:400;svg{width:24px;height:24px;}"]),Ao=(0,b.ZP)(Io).attrs(Eo.S7).withConfig({displayName:"SlateTextSidebar__CaptionButton",componentId:"uc20ao-8"})(["font-size:11px;font-weight:400;"]),Lo=(0,b.ZP)(Ve.Z).attrs(Eo.S7).withConfig({displayName:"SlateTextSidebar__AlignmentButton",componentId:"uc20ao-9"})(["svg{width:24px;height:24px;}"]),No=(0,b.ZP)(Fe).attrs(Eo.Jo).withConfig({displayName:"SlateTextSidebar__StyledSegmentedControls",componentId:"uc20ao-10"})(["margin-bottom:8px;:last-child{margin-bottom:0;}"]);var Ho=e=>{var t,o;let{tileData:n,updateTileData:r}=e;const i=Jt(),{t:a}=(0,y.$G)(),l=(0,Oo.Z)((function(){let{vertical:e,horizontal:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return()=>{r((o=>{var n,r;return jo(o,{verticalAlignment:e||(null===(n=o.textTileData)||void 0===n?void 0:n.verticalAlignment),horizontalAlignment:t||(null===(r=o.textTileData)||void 0===r?void 0:r.horizontalAlignment)})}))}}),[r]);if(null===i||void 0===i||!i.children.length)return null;const s=(0,xo.oA)(null===(t=n.textTileData)||void 0===t?void 0:t.horizontalAlignment),c=(0,xo.xZ)(null===(o=n.textTileData)||void 0===o?void 0:o.verticalAlignment),d=(0,Xt.Hk)(i),p=(0,Xt.Lk)(i,d);return(0,_.jsxs)("div",{"data-testid":"text_sidebar",children:[(0,_.jsx)(Mo,{children:a("sidebar.alignment")}),(0,_.jsxs)(No,{role:"listbox",children:[(0,_.jsx)(Lo,{isSegment:!0,role:"option",onClick:l({horizontal:U.KxP.Leading}),"aria-selected":s===U.KxP.Leading,selected:s===U.KxP.Leading,startIcon:(0,_.jsx)(ro,{})}),(0,_.jsx)(Lo,{isSegment:!0,role:"option",onClick:l({horizontal:U.KxP.Center}),"aria-selected":s===U.KxP.Center,selected:s===U.KxP.Center,startIcon:(0,_.jsx)(lo,{})}),(0,_.jsx)(Lo,{isSegment:!0,role:"option",onClick:l({horizontal:U.KxP.Trailing}),"aria-selected":s===U.KxP.Trailing,selected:s===U.KxP.Trailing,startIcon:(0,_.jsx)(po,{})})]}),(0,_.jsxs)(No,{role:"listbox",children:[(0,_.jsx)(Lo,{isSegment:!0,role:"option",onClick:l({vertical:U.Q4P.Top}),"aria-selected":c===U.Q4P.Top,selected:c===U.Q4P.Top,startIcon:(0,_.jsx)(go,{})}),(0,_.jsx)(Lo,{isSegment:!0,role:"option",onClick:l({vertical:U.Q4P.Center}),"aria-selected":c===U.Q4P.Center,selected:c===U.Q4P.Center,startIcon:(0,_.jsx)(bo,{})}),(0,_.jsx)(Lo,{isSegment:!0,role:"option",onClick:l({vertical:U.Q4P.Bottom}),"aria-selected":c===U.Q4P.Bottom,selected:c===U.Q4P.Bottom,startIcon:(0,_.jsx)(vo,{})})]}),(0,_.jsx)(Mo,{children:a("sidebar.style")}),(0,_.jsxs)(So,{children:[(0,_.jsx)(_o,{"data-testid":"sidebar_button_display",selected:(0,qt.Z)(p,[Qt.L$]),onClick:()=>{(0,Xt.U9)(i,Qt.L$,!0)},children:a("sidebar.display")}),(0,_.jsx)(ko,{"data-testid":"sidebar_button_title",selected:(0,qt.Z)(p,[Qt.Ch]),onClick:()=>{(0,Xt.U9)(i,Qt.Ch,!0)},children:a("sidebar.title")})]}),(0,_.jsxs)(So,{children:[(0,_.jsx)(Zo,{"data-testid":"sidebar_button_heading",selected:(0,qt.Z)(p,[Qt.r3]),onClick:()=>{(0,Xt.U9)(i,Qt.r3,!0)},children:a("sidebar.heading")}),(0,_.jsx)(Do,{"data-testid":"sidebar_button_subheading",selected:(0,qt.Z)(p,[Qt.yq]),onClick:()=>{(0,Xt.U9)(i,Qt.yq,!0)},children:a("sidebar.subheading")})]}),(0,_.jsxs)(So,{children:[(0,_.jsx)(Ro,{"data-testid":"sidebar_button_body",selected:(0,qt.Z)(p,[Qt.JB]),onClick:()=>{(0,Xt.U9)(i,Qt.JB,!0)},children:a("sidebar.body")}),(0,_.jsx)(Ao,{"data-testid":"sidebar_button_caption",selected:(0,qt.Z)(p,[Qt.Oo]),onClick:()=>{(0,Xt.U9)(i,Qt.Oo,!0)},children:a("sidebar.caption")})]}),(0,_.jsx)(Mo,{children:a("sidebar.lists")}),(0,_.jsxs)(So,{children:[(0,_.jsx)(Ro,{"data-testid":"sidebar_button_bulleted",selected:(0,Xt.ku)(i,Qt.qR),onClick:()=>{(0,Xt.th)(i,Qt.qR,!0)},startIcon:(0,_.jsx)(eo.Z,{})}),(0,_.jsx)(Ro,{"data-testid":"sidebar_button_numbered",selected:(0,Xt.ku)(i,Qt.y1),onClick:()=>{(0,Xt.th)(i,Qt.y1,!0)},startIcon:(0,_.jsx)(to.Z,{})})]}),(0,_.jsx)(Mo,{children:a("sidebar.colors")}),(0,_.jsx)(So,{children:(0,_.jsx)(To.EL,{onChange:e=>(0,Xt.z_)(i,e),editor:i})})]})},Vo=o(62820),Bo=o(25675),$o=o.n(Bo);const Fo=b.ZP.div.withConfig({displayName:"ImageCardList__CardListWrapper",componentId:"sc-5aed7r-0"})([""]);function Go(e){let t,o;switch(e){case U.h7B.Square:t=103,o=103;break;case U.h7B.Widescreen:t=216,o=121;break;case U.h7B.Vertical:t=103,o=183;break;case U.h7B.Ultrawide:t=216,o=92;break;case U.h7B.Portrait:t=103,o=128}return{width:t,height:o}}const zo=b.ZP.div.withConfig({displayName:"ImageCardList__PreviewDiv",componentId:"sc-5aed7r-1"})([""," border-radius:8px;background-color:",";display:flex;justify-content:center;align-items:center;"],(e=>{let{$dimensionType:t}=e;const{width:o,height:n}=Go(t);return`width: ${o}px; height: ${n}px;`}),(e=>{let{theme:t}=e;return t.colors.inputBg})),Uo=(0,b.ZP)(zo).withConfig({displayName:"ImageCardList__GlimmerPreviewDiv",componentId:"sc-5aed7r-2"})(["animation:glimmer 1.36s infinite;animation-delay:",";background:linear-gradient( to bottom right,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 32.65%,rgba(255,255,255,0.2) 45.58%,rgba(255,255,255,0) 60.74%,rgba(255,255,255,0) 100% );background-size:400px 400px;@keyframes glimmer{0%{background-position:-220px -220px;}100%{background-position:-10px -10px;}}"],(e=>{let{index:t}=e;switch(t){case 0:default:return"0s";case 1:case 2:return"0.198s";case 3:return"0.395s"}})),Wo=[U.h7B.Ultrawide,U.h7B.Widescreen],qo=b.ZP.div.withConfig({displayName:"ImageCardList__CardList",componentId:"sc-5aed7r-3"})(["gap:10px;display:grid;",""],(e=>{let{$dimensionType:t,columns:o}=e;return Wo.includes(t)?"":`grid-template-columns: repeat(${o}, 1fr);`})),Ko=b.ZP.div.withConfig({displayName:"ImageCardList__Card",componentId:"sc-5aed7r-4"})(["display:flex;column-span:1;-webkit-column-break-inside:avoid;-moz-column-break-inside:avoid;border-radius:8px;"," border-width:2px;border-width:",";border-style:solid;border-color:",";img{width:100%;height:100%;border-radius:8px;}cursor:",";content-visibility:auto;"],(e=>{let{$dimensionType:t}=e;const{width:o,height:n}=Go(t);return`width: ${o}px; height: ${n}px;`}),(e=>{let{selected:t}=e;return t?"2px":"0px"}),(e=>{let{selected:t,theme:o}=e;return t?o.colors.contentAccent:"transparent"}),(e=>{let{disabled:t}=e;return t?"default":"pointer"}));var Yo=e=>{let{images:t,selectedImage:o,dimensionType:n,onImageClick:r,loading:i=!1,columns:a,style:l}=e;const s=i?[0,1,2,3].map((e=>({index:e,imagePath:`${e}`,imageUrlPreview:"",imageUrlTile:""}))):t,{width:c,height:d}=Go(n);return(0,_.jsx)(Fo,{style:l,children:s&&(0,_.jsx)(qo,{$dimensionType:n,columns:a,children:null===s||void 0===s?void 0:s.map((e=>{return(0,_.jsxs)(Ko,{$dimensionType:n,disabled:i,selected:(null===o||void 0===o?void 0:o.imagePath)===e.imagePath,onClick:()=>{i||r(e)},children:[!i&&(0,_.jsx)($o(),{unoptimized:!0,width:c,height:d,alt:e.imagePath,src:e.imageUrlPreview,loader:(0,Ne.T8)(e.imageUrlPreview),quality:50,draggable:!1,placeholder:"blur",blurDataURL:`data:image/svg+xml;base64,${a=103,l=103,t=`\n<svg width="${a}" height="${l}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n<path d="M0,0 h103 v103 h-103 v-103 a8,8 0 0 1 8,-8 z" fill="rgba(255, 255, 255, 0.1)" />\n</svg>`,window.btoa(t)}`}),i&&(0,_.jsx)(zo,{$dimensionType:n,children:(0,_.jsx)(Uo,{$dimensionType:n,index:e.index})})]},e.imagePath);var t,a,l}))})})};const Jo=b.ZP.div.withConfig({displayName:"ImageGenerationHistory__RecordRow",componentId:"sc-12p6rpn-0"})([""]),Xo=(0,b.ZP)(oe).withConfig({displayName:"ImageGenerationHistory__MinHeightPanelContent",componentId:"sc-12p6rpn-1"})(["height:100%;"]),Qo=(0,b.ZP)(re).withConfig({displayName:"ImageGenerationHistory__RecordRowText",componentId:"sc-12p6rpn-2"})(["line-height:14px;height:auto;font-weight:400;padding:0px;margin-top:12px;margin-bottom:6px;user-select:text;cursor:text;&::selection{background-color:",";}"],(e=>e.theme.colors.textSelection)),en=e=>{let{record:t,setImage:o}=e;const n=(0,a.useCallback)((e=>{o({url:e.imagePath,prompt:t.prompt,generationId:t.id,generationCandidates:t.images||[],negativePrompt:t.negativePrompt??null,dimensionType:t.dimensionType??null,usedCustomNegativePrompt:t.usedCustomNegativePrompt??!1})}),[o,t.prompt,t.id,t.images,t.negativePrompt,t.dimensionType,t.usedCustomNegativePrompt]);return(0,_.jsxs)(Jo,{children:[(0,_.jsx)(Qo,{children:`"${t.prompt}"`}),(0,_.jsx)(Yo,{dimensionType:t.dimensionType??U.h7B.Square,images:t.images||[],onImageClick:n,columns:2})]})};var tn=e=>{var t,o;let{setImage:n}=e;const{loading:r,data:i}=(0,U.Z5V)({fetchPolicy:"network-only"});return r?(0,_.jsx)(Xo,{children:(0,_.jsx)(Vo.Z,{shouldCenter:!0})}):i?(0,_.jsx)(oe,{children:null===(t=i.me)||void 0===t||null===(o=t.imageGenerationRecords)||void 0===o?void 0:o.map((e=>(0,_.jsx)(en,{record:e,setImage:n},e.id)))}):null},on=o(65309);function nn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function rn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):nn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var an=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,rn(rn({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M34 20C34 18.8954 33.1046 18 32 18C30.8954 18 30 18.8954 30 20V32C30 32.5304 30.2107 33.0391 30.5858 33.4142L39.0858 41.9142C39.8668 42.6953 41.1332 42.6953 41.9142 41.9142C42.6953 41.1332 42.6953 39.8668 41.9142 39.0858L34 31.1716V20Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M56 32C56 45.2548 45.2548 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8C45.2548 8 56 18.7452 56 32ZM52 32C52 43.0457 43.0457 52 32 52C20.9543 52 12 43.0457 12 32C12 20.9543 20.9543 12 32 12C43.0457 12 52 20.9543 52 32Z"})]})))),ln=o(71515);const sn=b.ZP.div.withConfig({displayName:"TextRowWithIconButton__RowContainer",componentId:"sc-1pl7ah3-0"})(["display:flex;padding-top:4px;padding-bottom:8px;"]),cn=b.ZP.div.withConfig({displayName:"TextRowWithIconButton__TextContainer",componentId:"sc-1pl7ah3-1"})(["font-size:",";line-height:20px;color:",";flex:1;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),dn=b.ZP.div.withConfig({displayName:"TextRowWithIconButton__TipIconContainer",componentId:"sc-1pl7ah3-2"})(["width:20px;height:20px;"]);var pn=e=>{let{text:t,icon:o,onIconClick:n,tooltipText:r}=e;return(0,_.jsxs)(sn,{children:[(0,_.jsx)(cn,{children:t}),(0,_.jsx)(dn,{children:(0,_.jsx)(ln.Z,{content:r,placement:"left",children:(0,_.jsx)(Ve.Z,{variant:"text",size:"small",icon:o,onClick:n,style:{padding:3,minWidth:"unset",height:"unset"}})})})]})},un=o(39293),mn=o(75802),gn=o(29304),hn=o(16963);const fn=b.ZP.button.withConfig({displayName:"DimensionTypeDropdown__DimensionDropdownButton",componentId:"sc-1wikc83-0"})(["width:100%;color:",";background-color:",";text-align:center;z-index:1000000;display:flex;justify-content:center;align-items:center;border-radius:8px;font-size:12px;height:28px;padding:4px 8px;will-change:transform;cursor:pointer;svg{display:flex;}","{fill:",";}&:hover:enabled{background-color:",";opacity:1;}&[data-dropdown-option='true']:hover{color:",";background-color:",";}&[data-state='open']{background-color:",";}"],(e=>e.theme.colors.menuControlText),(e=>e.theme.colors.inputBg),Te.K,(e=>e.isActive?e.theme.colors.uiAccent:"currentColor"),(e=>e.theme.colors.inputBgFocus),(e=>(0,gn.VQ)(e)),(e=>(0,gn.jR)(e)),(e=>e.theme.colors.inputBgHover)),bn=b.ZP.span.withConfig({displayName:"DimensionTypeDropdown__ButtonIconStyle",componentId:"sc-1wikc83-1"})(["display:flex;align-items:center;opacity:",";width:100%;height:100%;"],(e=>e.disabled?.16:1)),yn=b.ZP.span.withConfig({displayName:"DimensionTypeDropdown__DimensionDropdownButtonText",componentId:"sc-1wikc83-2"})(["flex:1 0 auto;font-size:12px;line-height:12px;display:flex;align-items:center;padding:0 4px;"]),Cn=b.ZP.div.withConfig({displayName:"DimensionTypeDropdown__ItemContainer",componentId:"sc-1wikc83-3"})(["width:100%;display:flex;align-items:center;justify-content:space-between;"]),vn=b.ZP.div.withConfig({displayName:"DimensionTypeDropdown__ItemLabel",componentId:"sc-1wikc83-4"})(["flex:0 0 auto;display:flex;align-items:center;font-size:12px;"]),xn=b.ZP.div.withConfig({displayName:"DimensionTypeDropdown__ItemCheckIcon",componentId:"sc-1wikc83-5"})(["flex:0 0 auto;display:flex;align-items:center;"]);var On=e=>{var t;let{disabled:o,containerRef:n,value:r,onChange:i,items:a}=e;return(0,_.jsxs)(un.h_,{modal:!1,children:[(0,_.jsx)(un.$F,{asChild:!0,disabled:o,children:(0,_.jsx)(fn,{type:"button",disabled:o,children:(0,_.jsxs)(bn,{disabled:o,children:[(0,_.jsx)(yn,{children:null===(t=a.find((e=>e.value===r)))||void 0===t?void 0:t.label}),(0,_.jsx)(mn.Z,{style:{width:14,height:14}})]})})}),(0,_.jsx)(un.AW,{portalProps:{container:n.current},align:"start",avoidCollisions:!1,side:"bottom",sideOffset:8,style:{marginLeft:6,width:216,zIndex:550},children:a.map((e=>{let{label:t,value:o}=e;return(0,_.jsx)(un.Xi,{onSelect:()=>{i(o)},children:(0,_.jsxs)(Cn,{children:[(0,_.jsx)(vn,{children:t}),r===o&&(0,_.jsx)(xn,{children:(0,_.jsx)(hn.Z,{style:{width:16}})})]})},o)}))})]})};function Pn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Pn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const jn=(0,b.ZP)(d.E.div).withConfig({displayName:"ImageGenerationSidebar__AdvancedSettingsContainer",componentId:"sc-19689mv-0"})(["will-change:height,opacity;overflow:hidden;"]),Tn=(0,b.ZP)(se).withConfig({displayName:"ImageGenerationSidebar__PromptInput",componentId:"sc-19689mv-1"})(["height:132px;"]),En=(0,b.ZP)(se).withConfig({displayName:"ImageGenerationSidebar__NegativePromptInput",componentId:"sc-19689mv-2"})(["height:28px;padding:6px 0 6px 12px;"]),In={duration:.3,type:"spring",bounce:0};var Sn=e=>{var t,o,n,r,i;let{tomeId:s,tileData:c,setImage:d,advancedSettingsVisible:p=!1}=e;const{apolloClient:u}=(0,H.bp)(),m=(0,a.useRef)(null),g=(0,l.Zl)(ee.ej);(0,N.Z)({ref:m,onResize:e=>{let{height:t}=e;"number"===typeof t&&g(t??1/0)}});const h=(0,$.ye)($.TT.IMAGE_TILE_ADVANCED_SETTINGS),f=(0,a.useRef)(null),b=(0,a.useRef)(null),C=c.id,[v,x]=(0,l.FV)((0,ee.$v)(C)),{0:O,1:P}=(0,a.useState)((null===(t=c.imageTileData)||void 0===t?void 0:t.dimensionType)||U.h7B.Square),{0:w,1:j}=(0,a.useState)(!(null===(o=c.imageTileData)||void 0===o||!o.usedCustomNegativePrompt)),{0:T,1:E}=(0,a.useState)(w?(null===(n=c.imageTileData)||void 0===n?void 0:n.negativePrompt)??"":""),[k,Z]=(0,l.FV)((0,ee.L2)(C)),[D,M]=(0,l.FV)((0,ee.xZ)(C)),R=!(null===D||void 0===D||!D.images)&&D.images.length>1,A=(0,a.useRef)(),[L,V]=(0,l.FV)((0,ee.j3)(C)),{isBalanceLoading:B,refetchCurrentCreditBalance:F,attemptToPerformCreditsOperation:G,handleGenerationError:z}=(0,on.KW)(),[W,{loading:q,error:K}]=(0,U.Lre)({errorPolicy:"all",onCompleted:e=>{var t,o,n;(F(),e.generateImages&&A.current)&&(M({prevGenerationId:(null===(t=c.imageTileData)||void 0===t?void 0:t.generationId)||"",generationId:(null===e||void 0===e||null===(o=e.generateImages)||void 0===o?void 0:o.id)||"",prompt:A.current,images:(null===e||void 0===e||null===(n=e.generateImages)||void 0===n?void 0:n.images)||[],negativePrompt:T,dimensionType:O,usedCustomNegativePrompt:w}),A.current=void 0)}});(0,a.useEffect)((()=>{z(K)}),[K,z]),(0,a.useEffect)((()=>{L&&(V(null),Z(L),G(on.Cw.DALLE_TILE,(()=>{A.current=L,W({variables:{prompt:L,tileId:C,tomeId:s}})})))}),[L,V,C,s,W,Z,G]);const Y=p||!(null===(r=c.imageTileData)||void 0===r||!r.dimensionType)&&c.imageTileData.dimensionType!==U.h7B.Square||!(null===(i=c.imageTileData)||void 0===i||!i.negativePrompt)&&w;(0,a.useEffect)((()=>{var e,t,o,n,r,i,a,l,s,d,p,u,m;null!==(e=c.imageTileData)&&void 0!==e&&e.prompt&&(!D&&!k||null!==(t=c.imageTileData)&&void 0!==t&&t.generationId&&(null===(o=c.imageTileData)||void 0===o?void 0:o.generationId)!==(null===D||void 0===D?void 0:D.prevGenerationId))&&(Z(null===(n=c.imageTileData)||void 0===n?void 0:n.prompt),M({prevGenerationId:(null===(r=c.imageTileData)||void 0===r?void 0:r.generationId)||"",generationId:(null===(i=c.imageTileData)||void 0===i?void 0:i.generationId)||"",prompt:null===(a=c.imageTileData)||void 0===a?void 0:a.prompt,images:(null===(l=c.imageTileData)||void 0===l||null===(s=l.generationCandidates)||void 0===s?void 0:s.length)&&(null===(d=c.imageTileData)||void 0===d?void 0:d.generationCandidates)||[],negativePrompt:(null===(p=c.imageTileData)||void 0===p?void 0:p.negativePrompt)||"",usedCustomNegativePrompt:!(null===(u=c.imageTileData)||void 0===u||!u.usedCustomNegativePrompt),dimensionType:(null===(m=c.imageTileData)||void 0===m?void 0:m.dimensionType)||U.h7B.Square}));v.isDirty||x({isDirty:!0,value:Y})}),[]),(0,a.useEffect)((()=>{f.current&&(f.current.selectionStart=f.current.value.length,f.current.selectionEnd=f.current.value.length,f.current.focus())}),[]);const J=(0,a.useCallback)((e=>{if(null===e||void 0===e||e.preventDefault(),q)return;const t=k;t&&G(on.Cw.DALLE_TILE,(()=>{A.current=t,W({variables:{prompt:t,tileId:C,tomeId:s,advancedOptions:{negativePrompt:T,dimension:O}}})}))}),[q,k,T,O,G,W,C,s]),X=(0,I.t2)(),Q=(0,a.useCallback)((()=>{X.pushPropertyPanel(S.Z.IMAGE_GENERATION_HISTORY)}),[X]),te=(0,a.useCallback)((e=>{null!==D&&void 0!==D&&D.generationId&&null!==D&&void 0!==D&&D.prompt&&d({url:e.imagePath,prompt:null===D||void 0===D?void 0:D.prompt,generationId:null===D||void 0===D?void 0:D.generationId,generationCandidates:null===D||void 0===D?void 0:D.images,negativePrompt:(null===D||void 0===D?void 0:D.negativePrompt)??null,dimensionType:null===D||void 0===D?void 0:D.dimensionType,usedCustomNegativePrompt:null===D||void 0===D?void 0:D.usedCustomNegativePrompt})}),[d,D]),oe=(0,a.useCallback)((e=>{P(e)}),[]),ie=(0,a.useMemo)((()=>v.isDirty?v.value:Y),[Y,v.isDirty,v.value]),le=(0,a.useCallback)((e=>{"Enter"===e.key&&(e.preventDefault(),J())}),[J]),se=(0,a.useCallback)((()=>{x((e=>(We.ZP.reportToggleImageAdvancedSettings({apolloClient:u,tomeId:s,tileId:C,mode:e.value?We.jv.OFF:We.jv.ON}),wn(wn({},e),{},{value:!e.value}))))}),[u,s,C,x]),de=q||B(),{t:pe}=(0,y.$G)();return(0,_.jsxs)("form",{ref:m,onSubmit:J,children:[(0,_.jsx)(pn,{text:pe("sidebar.imageGeneration.prompt"),tooltipText:pe("sidebar.imageGeneration.historyTooltip"),icon:(0,_.jsx)(an,{}),onIconClick:Q}),(0,_.jsx)(ce,{children:(0,_.jsx)(Tn,{ref:f,disabled:de,value:k,placeholder:pe("sidebar.imageGeneration.imagePlaceholder"),rows:3,onKeyDown:le,onChange:e=>{Z(e.target.value)}})}),(0,_.jsx)(ne,{children:(0,_.jsx)(Ve.Z,{type:"submit",style:{width:"100%"},disabled:0===k.trim().length||de,children:pe("sidebar.imageGeneration.generate")})}),h&&(0,_.jsxs)(ae,{children:[(0,_.jsx)("label",{htmlFor:"AdvancedSettingsToggle",children:pe("sidebar.media.advanced")}),(0,_.jsx)(Je.Z,{inputId:"AdvancedSettingsToggle",width:"40px",height:"20px",onBgColor:!0,checked:ie,disabled:de,onClick:se})]}),(0,_.jsxs)(jn,{initial:{opacity:ie?1:0,height:ie?130:0},animate:{opacity:ie?1:0,height:ie?130:0},transition:In,children:[(0,_.jsx)(re,{children:pe("sidebar.imageGeneration.negativePrompt")}),(0,_.jsx)(ce,{children:(0,_.jsx)(En,{disabled:de,ref:b,value:T,placeholder:pe("sidebar.imageGeneration.negativePromptPlaceholder"),rows:1,onKeyDown:le,onChange:e=>{E(e.target.value),j(e.target.value.trim().length>0)}})}),(0,_.jsx)(re,{children:pe("sidebar.imageGeneration.dimension")}),(0,_.jsx)(ne,{children:(0,_.jsx)(On,{disabled:q,containerRef:m,value:O,onChange:oe,items:[{value:U.h7B.Square,label:pe("sidebar.imageGeneration.dimensionType.square")},{value:U.h7B.Widescreen,label:pe("sidebar.imageGeneration.dimensionType.widescreen")},{value:U.h7B.Ultrawide,label:pe("sidebar.imageGeneration.dimensionType.ultrawide")},{value:U.h7B.Vertical,label:pe("sidebar.imageGeneration.dimensionType.vertical")},{value:U.h7B.Portrait,label:pe("sidebar.imageGeneration.dimensionType.portrait")}]})})]},C),(q||(null===D||void 0===D?void 0:D.images)&&D.images.length>1)&&(0,_.jsx)(Yo,{style:{paddingBottom:"12px"},dimensionType:!q&&R&&null!==D&&void 0!==D&&D.dimensionType?null===D||void 0===D?void 0:D.dimensionType:O,images:(null===D||void 0===D?void 0:D.images)||[],onImageClick:te,loading:!!k&&q,columns:2})]})},_n=o(99747),kn=o(54232),Zn=o(85671),Dn=o(7996);var Mn=e=>{let{tileId:t}=e;const o=Jt(),n=(0,Dn.Oz)(),r=(0,G.Z)(t),i=(0,I.t2)(),s=(0,a.useCallback)((e=>{o&&((0,Xt.z_)(o,e),requestAnimationFrame((()=>{(0,_n.$Rk)(o)})))}),[o]),c=(0,Dn.px)({editor:o}),d=(0,l.Zl)(Zn.k);(0,a.useEffect)((()=>(d(!0),()=>{d(!1)})),[d]),(0,a.useEffect)((()=>{r&&t!==r&&i.popPropertyPanel()}),[t,r,i]);const p=(0,a.useCallback)((()=>{const e=c();return e.length?e[0]:"white"}),[c]);return(0,_.jsx)(kn.default,{color:p(),setColor:s,setColorComplete:n})};function Rn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function An(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Rn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ln=m()((()=>Promise.resolve().then(o.bind(o,54232))),{loadableGenerated:{webpack:()=>[54232]}}),Nn=e=>{var t,o;let{tomeId:n,tile:r,currentPanel:i,draggable:s,startDrag:c}=e;const{apolloClient:d,clientId:p}=(0,H.bp)(),u=function(){const{query:{debug:e}}=(0,g.useRouter)();return"true"===e}(),{tileData:m,updateTileData:h}=(0,W.Z)(r,n),{t:f}=(0,y.$G)(),b=(0,l.Zl)((0,ee.L2)(r.id)),C=(0,l.Zl)((0,ee.xZ)(r.id)),{getActiveController:v}=(0,a.useContext)(Q.Z),x=v(),O=(0,a.useCallback)((()=>!x.isSingleTile(r.id)),[x,r.id]),P=(0,a.useCallback)((e=>{h((t=>An(An({},t),{},{mediaTileData:An(An({},t.mediaTileData),{},{backgroundColor:e})})))}),[h]),w=(0,a.useCallback)((e=>{var t;let{url:o,prompt:n,generationId:r,generationCandidates:i,negativePrompt:a,usedCustomNegativePrompt:l,dimensionType:s}=e;h((e=>An(An({},e),{},{contentLink:o,imageAttributes:An(An({},e.imageAttributes),{},{imagePath:o}),imageTileData:An(An({},e.imageTileData),{},{prompt:n,generationId:r,generationCandidates:i,negativePrompt:a,dimensionType:s,usedCustomNegativePrompt:l}),mediaTileData:An(An({},e.mediaTileData),{},{aspectRatio:null,fillCropCenterX:null,fillCropCenterY:null,fillCropScale:null,mediaFillType:U.EwX.Fill,mediaStatus:U.Jpv.Ready}),fileUploadTileData:{uploadId:null,createdAt:null}}))),b(n),C({prevGenerationId:(null===m||void 0===m||null===(t=m.imageTileData)||void 0===t?void 0:t.generationId)||"",generationId:r,prompt:n,images:i,negativePrompt:a||null,dimensionType:s||U.h7B.Square,usedCustomNegativePrompt:l})}),[h,b,C,null===m||void 0===m||null===(t=m.imageTileData)||void 0===t?void 0:t.generationId]),j=(0,a.useCallback)((e=>{(0,J.Gs)(e,d,p)}),[d,p]),T=(0,a.useMemo)((()=>(0,z.Z)((e=>j(e)),300)),[j]),E=(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(q.Z,{data:m,saveData:K.KS.includes(m.type)?T:j}),i===S.Z.COLOR_PICKER&&((0,Y.ck)(r.type)||r.type===U.YUT.Video)&&(0,_.jsx)(Ln,{color:(null===(o=m.mediaTileData)||void 0===o?void 0:o.backgroundColor)||Y.M2,setColor:P}),i===S.Z.TEXT_COLOR_PICKER&&(0,_.jsx)(Mn,{tileId:m.id}),i===S.Z.IMAGE_GENERATION_HISTORY&&r&&(0,_.jsx)(tn,{setImage:w}),i===S.Z.IMAGE_EDIT&&r&&(0,_.jsx)(oe,{children:(0,_.jsx)(Ye,{tileData:m,updateTileData:h})}),i===S.Z.IMAGE_CREATE&&r&&(0,_.jsx)(oe,{style:{marginBottom:0},children:(0,_.jsx)(Sn,{tomeId:n,tileData:m,setImage:w})}),i===S.Z.TILE&&r&&(0,_.jsxs)(_.Fragment,{children:[u&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(re,{children:"id"}),(0,_.jsx)(ne,{children:m.id}),(0,_.jsx)(re,{children:"URL"}),(0,_.jsx)(ne,{children:m.contentLink})]}),("TEXT"===r.type||"TEXT_SLATE"===r.type)&&(0,_.jsx)(Ho,{tileData:m,updateTileData:h}),("IMAGE"===r.type||"GIPHY"===r.type||"IMAGE_GENERATIVE"===r.type)&&(0,_.jsx)(Ye,{tileData:m,updateTileData:h}),"VIDEO"===r.type&&(0,_.jsx)(ot,{tileData:m,updateTileData:h}),"TABLE"===r.type&&(0,_.jsx)(yt,{tileData:m,updateTileData:h,isSelectedTileSquare:O}),K.KS.includes(r.type)&&(0,_.jsx)(Tt,{tileData:m,updateTileData:h})]})]});let I=i,k=!1;if(i===S.Z.TILE){const e=(0,K.An)(r.type)[0];I=null===e||void 0===e?void 0:e.label,k=!(null===e||void 0===e||!e.beta)}else i===S.Z.COLOR_PICKER?I=f("sidebar.tileSidebar.backgroundColorHeaderText"):i===S.Z.TEXT_COLOR_PICKER?I=f("sidebar.tileSidebar.textColorHeaderText"):i===S.Z.IMAGE_GENERATION_HISTORY?I=f("sidebar.tileSidebar.historyHeaderText"):i===S.Z.IMAGE_EDIT?I=f("sidebar.tileSidebar.editImageHeaderText"):i===S.Z.IMAGE_CREATE&&(I=f("sidebar.tileSidebar.createImageHeaderText"));return(0,_.jsx)(Wt,{hasHeader:!0,headerText:`${f("sidebar.header",{header:I})}`,contentNoPadding:i!==S.Z.TILE,panelContent:E,headerBetaTag:k,draggable:s,startDrag:c})};var Hn=e=>{let{tomeId:t,currentPanel:o,draggable:n,startDrag:r}=e;const i=(0,c.l)(V.Dm);return i?(0,_.jsx)(X.Z,{id:i,children:e=>e?(0,_.jsx)(Nn,{tomeId:t,tile:e,currentPanel:o,draggable:n,startDrag:r}):null}):null},Vn=o(68652),Bn=o(47250),$n=o(97210);function Fn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Gn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Fn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const zn=(e,t)=>(0,_.jsx)(Te.Z,Gn(Gn({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{d:"M32.423 42C42.7214 42 49.8333 33.6184 49.8333 31C49.8333 28.3687 42.7086 20 32.423 20C22.2649 20 15 28.3687 15 31C15 33.6184 22.2522 42 32.423 42ZM32.423 39.972C24.0238 39.972 17.2305 32.8098 17.2305 31C17.2305 29.4726 24.0238 22.028 32.423 22.028C40.7841 22.028 47.6029 29.4726 47.6029 31C47.6029 32.8098 40.7841 39.972 32.423 39.972ZM32.423 38.1879C36.3869 38.1879 39.5732 34.9148 39.5732 31C39.5732 26.9825 36.3869 23.8121 32.423 23.8121C28.4337 23.8121 25.2346 26.9825 25.2473 31C25.2728 34.9148 28.4337 38.1879 32.423 38.1879ZM32.423 33.3874C31.0975 33.3874 30.0269 32.3092 30.0269 31C30.0269 29.6779 31.0975 28.6126 32.423 28.6126C33.7358 28.6126 34.8064 29.6779 34.8064 31C34.8064 32.3092 33.7358 33.3874 32.423 33.3874Z"})}));var Un=(0,a.forwardRef)(zn);function Wn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function qn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Kn=(e,t)=>(0,_.jsx)(Te.Z,qn(qn({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{d:"M33.4509 16.4508C33.4509 15.6671 32.7877 15 31.9917 15C31.2123 15 30.5491 15.6671 30.5491 16.4508V21.3203C30.5491 22.1041 31.2123 22.7712 31.9917 22.7712C32.7877 22.7712 33.4509 22.1041 33.4509 21.3203V16.4508ZM22.5564 25.6728C23.1202 26.2398 24.0488 26.2398 24.596 25.6728C25.1598 25.1225 25.1598 24.1886 24.596 23.6216L21.1967 20.1863C20.6495 19.636 19.7209 19.6193 19.1571 20.1697C18.6099 20.72 18.6099 21.6538 19.1571 22.2208L22.5564 25.6728ZM39.205 23.7884C38.6578 24.3554 38.6578 25.2893 39.205 25.8396C39.7688 26.4066 40.714 26.4066 41.2612 25.8396L44.6771 22.4043C45.2409 21.8373 45.2409 20.9034 44.6771 20.3364C44.1299 19.7861 43.2013 19.7861 42.6541 20.3364L39.205 23.7884ZM30.6817 44.6838C30.6651 45.3342 31.4279 45.5343 31.8425 45.1174L34.363 42.5659L37.1985 49.62C37.3312 49.9202 37.6794 50.0869 37.9779 49.9535L39.6195 49.3031C39.918 49.153 40.0341 48.8028 39.8848 48.5027L36.9 41.5653L40.4818 41.4152C41.1119 41.3819 41.4104 40.7815 40.9627 40.2979L31.9088 30.9425C31.4777 30.509 30.8475 30.7424 30.831 31.3594L30.6817 44.6838ZM15.4427 31.6429C14.6633 31.6429 14 32.31 14 33.0938C14 33.8776 14.6633 34.5446 15.4427 34.5446H20.3012C21.0972 34.5446 21.7605 33.8776 21.7605 33.0938C21.7605 32.31 21.0972 31.6429 20.3012 31.6429H15.4427ZM48.5408 34.5446C49.3367 34.5446 50 33.8776 50 33.0938C50 32.31 49.3367 31.6429 48.5408 31.6429H43.6988C42.9194 31.6429 42.2561 32.31 42.2561 33.0938C42.2561 33.8776 42.9194 34.5446 43.6988 34.5446H48.5408ZM19.3063 43.7833C18.7591 44.3336 18.7591 45.2841 19.2897 45.8345C19.8369 46.3848 20.7821 46.4015 21.3459 45.8511L24.7619 42.4158C25.3257 41.8655 25.3257 40.9316 24.7619 40.3646C24.2312 39.8143 23.286 39.8143 22.7222 40.3646L19.3063 43.7833Z"})}));var Yn=(0,a.forwardRef)(Kn);function Jn(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Xn(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Jn(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Qn=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,Xn(Xn({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{d:"M56 32.6667H8V31.3333H56V32.6667Z"})})))),er=o(19614);function tr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function or(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):tr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const nr=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorSelector",componentId:"ts0vn9-0"})(["display:grid;grid-template-columns:repeat(4,24px);column-gap:10px;margin-bottom:16px;"]),rr=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorWrap",componentId:"ts0vn9-1"})(["position:relative;width:24px;height:24px;"]),ir=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorCircle",componentId:"ts0vn9-2"})(["position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;"]),ar=(0,b.ZP)(d.E.div).withConfig({displayName:"AnnotationPanel__ColorOutline",componentId:"ts0vn9-3"})(["position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;border:2px solid white;"]),lr=b.ZP.div.withConfig({displayName:"AnnotationPanel__OptionSelector",componentId:"ts0vn9-4"})(["margin-bottom:16px;"]),sr=(0,b.ZP)(Fe).withConfig({displayName:"AnnotationPanel__StyledSegmentedControls",componentId:"ts0vn9-5"})(["& button{text-transform:capitalize;}"]),cr={duration:.25,ease:[.4,0,.1,1]};var dr=e=>{let{annotations:t,tomeId:o}=e;const n=(0,l.sJ)($n.Qf),r=(0,l.Zl)($n.Hl),i=(0,l.Zl)($n.f8),{apolloClient:s,clientId:c}=(0,H.bp)(),[d,p]=(0,l.FV)($n.LN),[u,m]=(0,l.FV)($n.Qc),{t:g}=(0,y.$G)(),{0:h,1:f}=(0,a.useState)(d.color),{0:C,1:v}=(0,a.useState)(d.line),{0:x,1:O}=(0,a.useState)(d.displayType),P=(0,a.useCallback)((e=>{if(null===n)return;if(n.annotationId===(null===u||void 0===u?void 0:u.id))m((t=>t?e(t):null));else{const r=t.find((e=>e.id===n.annotationId));if(void 0===r)return;const i=e(r);(0,Bn._E)(o,n.tileId,i,s,c)}}),[n,t,s,c,null===u||void 0===u?void 0:u.id,m,o]),w=(0,a.useCallback)((e=>{const t=e.currentTarget.getAttribute("value");h!==t&&(f(t),p((e=>or(or({},e),{},{color:t}))),P((e=>{const o=(0,Vn.Z)(e);return o.style.colorScheme=t,o})))}),[h,p,P]),j=(0,a.useCallback)((e=>{const t=e.currentTarget.getAttribute("value");C!==t&&(v(t),p((e=>or(or({},e),{},{line:t}))),P((e=>{const o=(0,Vn.Z)(e);return o.style.lineStyle=t,o})))}),[C,p,P]),T=(0,a.useCallback)((e=>{const t=e.currentTarget.getAttribute("value");x!==t&&(O(t),p((e=>or(or({},e),{},{displayType:t}))),P((e=>{const o=(0,Vn.Z)(e);return o.displayType=t,o})))}),[x,p,P]);(0,a.useEffect)((()=>(i(!0),r(!0),()=>{r(!1)})),[r,i]),(0,a.useEffect)((()=>{var e,o,r,i,a;if(!n)return;let l;if(n.annotationId===(null===u||void 0===u?void 0:u.id))l=u;else{const e=t.find((e=>e.id===n.annotationId));if(void 0===e)return;l=e}null!==(e=l)&&void 0!==e&&null!==(o=e.style)&&void 0!==o&&o.lineStyle?v((e=>e===l.style.lineStyle?e:l.style.lineStyle)):v(d.line),null!==(r=l)&&void 0!==r&&null!==(i=r.style)&&void 0!==i&&i.colorScheme?f((e=>e===l.style.colorScheme?e:l.style.colorScheme)):f(d.color),null!==(a=l)&&void 0!==a&&a.displayType?O((e=>e===l.displayType?e:l.displayType)):O(d.displayType)}),[n,d,h,C,x,u,t]);const E={hairline:Qn,wavy:er.Z,click:Yn,always:Un},I=(0,b.Fg)();return(0,_.jsxs)(oe,{onMouseDown:e=>{e.preventDefault()},children:[(0,_.jsx)(re,{children:g("components.annotationPanel.colorTitle")}),(0,_.jsx)(nr,{role:"listbox",children:Object.entries(I.annotationColors).map((e=>{let[t,o]=e;return(0,_.jsxs)(rr,{onClick:w,value:t,"aria-selected":h===t,role:"option",children:[(0,_.jsx)(ir,{style:{backgroundColor:o.background},initial:!1,animate:{scale:h===t?.6666666667:1},transition:cr}),(0,_.jsx)(ar,{style:{borderColor:o.background},initial:!1,animate:{scale:h===t?1:.5},transition:cr})]},t)}))}),(0,_.jsx)(re,{children:g("components.annotationPanel.lineStyleTitle")}),(0,_.jsx)(lr,{children:(0,_.jsx)(sr,{role:"listbox",children:["hairline","wavy"].map((e=>{const t=E[e];return(0,_.jsx)(Ve.Z,{"aria-selected":C===e,role:"option",onClick:j,value:e,isSegment:!0,selected:C===e,startIcon:(0,_.jsx)(t,{style:{width:24,height:24}}),children:e},e)}))})}),(0,_.jsx)(re,{children:g("components.annotationPanel.showTitle")}),(0,_.jsx)(lr,{children:(0,_.jsx)(sr,{role:"listbox",children:[{type:"click",label:g("components.annotationPanel.onClickButtonLabel")},{type:"always",label:g("components.annotationPanel.alwaysButtonLabel")}].map((e=>{const t=E[e.type];return(0,_.jsx)(Ve.Z,{"aria-selected":x===e.type,role:"option",onClick:T,isSegment:!0,value:e.type,selected:x===e.type,startIcon:(0,_.jsx)(t,{style:{width:24,height:24}}),children:e.label},e.type)}))})})]})},pr=o(98525),ur=o(82391),mr=o(20543),gr=o(19579),hr=o(55075);function fr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}var br=e=>{let{tomeId:t,shouldSetPropertyPanel:o=!0,shouldFocusInput:n=!1}=e;const i=(0,l.sJ)(V.Vx),s=(0,I.t2)(),{apolloClient:c,clientId:d}=(0,H.bp)(),{getMainController:p}=(0,a.useContext)(Q.Z),u=p(i);return(0,l._8)((e=>{let{set:a}=e;return e=>{let{tileType:l,additionalTileData:p={},afterAddTileAction:m}=e;const g=(0,hr.x)(t,i,u,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):fr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({type:l},p),c,d,{kind:mr.r.END});o&&s.setPropertyPanel(S.Z.TILE),g&&((0,V.Dm)(g),a((0,V.Eq)(g),!0),n&&a((0,ee.pt)(g),!0),m!==gr.B.NONE&&a((0,gr.A)(g),{triggered:!0,action:m}))}}),[c,d,i,u,s,t,o,n])},yr=o(7377),Cr=o(85684),vr=o(41366),xr=o(26188),Or=o(12464),Pr=o(27618),wr=o(70974),jr=o(88989);function Tr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Er(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Tr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ir=104,Sr=b.ZP.div.withConfig({displayName:"TileSelectionOption__TileOption",componentId:"sc-19p6lg4-0"})(["position:absolute;display:flex;flex-direction:column;align-items:center;background-color:transparent !important;"]),_r=b.ZP.div.withConfig({displayName:"TileSelectionOption__TileContainer",componentId:"sc-19p6lg4-1"})(["position:static;display:flex;justify-content:center;"]),kr=(0,b.ZP)(d.E.div).withConfig({displayName:"TileSelectionOption__OptionLabel",componentId:"sc-19p6lg4-2"})(["font-weight:500;font-size:",";color:",";"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.sidebarTileText)),Zr=(0,b.ZP)(d.E.div).withConfig({displayName:"TileSelectionOption__OptionIcon",componentId:"sc-19p6lg4-3"})(["width:","px;height:","px;display:inline-block;background-color:",";border-radius:16px;display:flex;flex:none;transform:translate(0,0);justify-content:center;align-items:center;flex-direction:column;border-width:2px;border-color:",";border-style:solid;cursor:grab;svg{pointer-events:none;fill:",";}&:hover{background-color:",";}"],Ir,Ir,(e=>e.$isDragging?e.theme.colors.sidebarTileDragging:e.theme.colors.sidebarTile),(e=>e.selected?e.theme.colors.contentAccent:e.theme.colors.transparent),(e=>{let{theme:t}=e;return t.colors.sidebarTileIcon}),(e=>{let{theme:t}=e;return t.colors.sidebarTileHover})),Dr=b.ZP.div.withConfig({displayName:"TileSelectionOption__AddTileIcon",componentId:"sc-19p6lg4-4"})(["width:26px;height:26px;background:",";border-radius:99px;display:flex;align-items:center;justify-content:center;position:absolute;top:-13px;left:-13px;svg{fill:",";}"],(e=>e.theme.colors.contentAccent),(e=>{let{theme:t}=e;return t.colors.accentForeground}));var Mr=e=>{let{addNewTile:t,option:o,selectedType:n,tileData:r,onTileDragStart:i,onTileDragEnd:s}=e;const c=(0,l.Zl)(R.LY),d=(0,l.sJ)(R.M9),{0:p,1:u}=(0,a.useState)(!1),{0:m,1:g}=(0,a.useState)(!1),{0:h,1:f}=(0,a.useState)({x:0,y:0}),b=(0,a.useRef)(null),C=(0,a.useMemo)((()=>(0,Or.oD)()),[]),{scrollContainerIfNeeded:v,cancelAnyScrolling:x}=(0,jr.Z)(),O=(0,a.useCallback)(((e,t)=>{(Math.abs(t.offset.x)>8||Math.abs(t.offset.y)>8)&&i(),v(e)}),[v,i]),P=(0,a.useCallback)((()=>{x(),u(!1),c(null),(0,V.bT)(!1)}),[x,c]);(0,a.useEffect)((()=>()=>{P()}),[P]);const w=(0,a.useCallback)((()=>{const e=b.current.getBoundingClientRect();g(!0),f({x:e.x,y:e.y}),u(!0),(0,V.bT)(!0);const t={kind:Pr.A.ADD_TILE,typeType:o.value};c(t)}),[o.value,c]),j=(0,a.useCallback)((()=>{s({dismiss:!d}),P()}),[P,d,s]),I=(0,a.useCallback)((()=>{g(!1)}),[]),S={intital:{opacity:1,scale:1,width:Ir},addTile:{opacity:1,scale:.8,width:"horizontal"===(null===d||void 0===d?void 0:d.kind)?208:Ir}},{t:k}=(0,y.$G)();return(0,_.jsxs)(_r,{children:[(0,_.jsxs)(Sr,{style:Er({},p?{pointerEvents:"none"}:{}),onClick:()=>t({tileType:o.value,additionalTileData:r,afterAddTileAction:gr.B.NONE}),children:[(0,_.jsx)(Or.Nq,{node:C,children:(0,_.jsxs)(Zr,{ref:b,id:o.value,selected:o.value===n,$isDragging:p,onDragTransitionEnd:I,drag:!0,dragSnapToOrigin:!0,onDrag:O,onDragStart:w,onDragEnd:j,dragTransition:{from:.001},dragPropagation:!0,initial:"intitial",variants:S,animate:p&&d?"addTile":"initial",transition:p&&d?E.iy:{duration:0},children:[p&&d&&(0,_.jsx)(Dr,{children:(0,_.jsx)(nt.Z,{style:{width:"21px",height:"21px"}})}),(0,_.jsx)(o.icon,{}),(!p||p&&!d)&&(0,_.jsx)(kr,{children:`${k("sidebar.optionLabel",{option:o.label})}`})]})}),p||m?(0,_.jsx)(wr.Z,{scaleToPage:!1,dragPosition:h,node:C,containerZIndex:T.C8}):(0,_.jsx)(Or.t0,{node:C})]},o.value),(p||m)&&(0,_.jsx)(Dt.Z,{})]})};function Rr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ar(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Rr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Lr=b.ZP.div.withConfig({displayName:"AddTileSelector__SearchContainer",componentId:"fr9vk1-0"})([""]),Nr=(0,b.ZP)(te.Z).withConfig({displayName:"AddTileSelector__SearchInput",componentId:"fr9vk1-1"})(["height:","px;padding:12px 14px;background:transparent;margin-top:0;font-size:",";line-height:21px;border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-left-radius:0px;border-bottom-right-radius:0px;border-bottom:"," ","px solid;"],45,(e=>e.theme.fontSizes.md),(e=>e.theme.colors.contrast8),1),Hr=b.ZP.div.withConfig({displayName:"AddTileSelector__DragHint",componentId:"fr9vk1-2"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;height:42px;font-size:",";color:",";",""],(e=>e.theme.fontSizes.xxs),(e=>{let{theme:t}=e;return t.colors.sidebarTileDragHint}),(e=>{let{theme:t}=e;return(0,yr.Z)({base:t.colors.sidebarTileDragHint,highlight:t.colors.sidebarTileDragShimmerHighlight})})),Vr=b.ZP.div.withConfig({displayName:"AddTileSelector__Group",componentId:"fr9vk1-3"})(["display:grid;grid-template-columns:1fr 1fr;grid-template-rows:repeat(",",102px);gap:12px;padding:0 12px 12px;overflow-y:scroll;position:relative;max-height:","px;min-height:","px;"],(e=>e.$numRows),(e=>e.$maxHeight),(e=>e.$minHeight));var Br=e=>{let{tomeId:t,maxHeight:o,onTileDragStart:n,onTileDragEnd:r}=e;const{0:i,1:l}=(0,a.useState)(""),{flags:s}=(0,a.useContext)(xr.Z),c=K.YM.filter((e=>!e.launchDarklyKey||(null===s||void 0===s?void 0:s[e.launchDarklyKey]))),d=Math.ceil(c.length/2),p=(0,a.useRef)(null),u=(0,a.useRef)(null);(0,a.useEffect)((()=>{u.current&&u.current.select()}),[]);const m=c.filter((e=>{let{label:t,value:o}=e;return!(i&&!t.toLowerCase().includes(i.toLowerCase())&&!o.toLowerCase().includes(i.toLowerCase()))}));let g=m,h={};if(0===m.length){const e=(0,vr.w)(i);e.tileType&&(g=c.filter((t=>t.value===e.tileType)),h=Ar(Ar({},h),e.tileData))}const f=(0,I.t2)(),b=(0,a.useCallback)((()=>{i&&i.length>0?l(""):f.closePropertyPanel()}),[f,i]),{0:C,1:v}=(0,a.useState)(null);(0,a.useEffect)((()=>{i&&i.length>0&&g.length>0?v(g[0].value):v(null)}),[i]);const x=br({tomeId:t}),O=(0,a.useCallback)((()=>{C&&x({tileType:C,additionalTileData:h,afterAddTileAction:gr.B.NONE})}),[C,h]),{onKeyDown:P}=(0,ur.Z)({options:g.map((e=>e.value)),selectedType:C,setSelectedType:v,didSelect:O,didEscape:b}),w=o-45-1,j=104*d<w?104*d:w,{t:T}=(0,y.$G)();return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(Cr.Z,{exemptContainerRefs:p.current?[p.current.ref]:[],onClick:()=>{v(null)},children:(0,_.jsxs)(Lr,{children:[(0,_.jsx)(Nr,{type:"text",placeholder:T("sidebar.searchInput"),value:i,onChange:e=>l(e.target.value),onKeyDown:P,ref:u}),(0,_.jsx)(Hr,{children:T("sidebar.dragTilesHint")}),(0,_.jsx)(Vr,{$maxHeight:w,$minHeight:j,$numRows:d,children:g.map((e=>(0,_.jsx)(Mr,{option:e,addNewTile:x,selectedType:C,tileData:h,onTileDragStart:n,onTileDragEnd:r},e.value)))})]})})})},$r=o(77774),Fr=o(36828);function Gr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function zr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Gr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Gr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Ur=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,zr(zr({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{d:"M56.7661 45.8477V45.8477C56.0186 46.1574 55.1582 45.9863 54.5861 45.4141L44.5861 35.4141V35.4141C44.211 35.0391 44.0002 34.5304 44.0001 34V30V30.0003C44.0001 29.4699 44.2108 28.9612 44.5859 28.5861L54.5859 18.5861H54.5859C55.367 17.8052 56.6334 17.8054 57.4143 18.5866C57.7892 18.9615 57.9998 19.47 57.9999 20.0002V44.0002V44.0003C57.9999 44.8089 57.513 45.538 56.766 45.8477L56.7661 45.8477ZM12 16H36V16C39.3137 16 42 18.6863 42 22V42C42 45.3137 39.3137 48 36 48H12V48C8.68629 48 6 45.3137 6 42V42V22V22C6 18.6863 8.68629 16 12 16H12Z"})}))));function Wr(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function qr(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wr(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Kr=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,qr(qr({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{d:"M34.0208 47.8686V52.0068H42.0208C43.1254 52.0068 44.0208 52.9023 44.0208 54.0068C44.0208 55.1114 43.1254 56.0068 42.0208 56.0068H22.0208C20.9162 56.0068 20.0208 55.1114 20.0208 54.0068C20.0208 52.9023 20.9162 52.0068 22.0208 52.0068H30.0208V47.8686C22.0241 46.8643 16.0241 40.0664 16.0208 32.0068V28.0068C16.0208 26.9023 16.9162 26.0068 18.0208 26.0068C19.1254 26.0068 20.0208 26.9023 20.0208 28.0068V32.0068C20.0208 38.6343 25.3934 44.0068 32.0208 44.0068C38.6482 44.0068 44.0208 38.6343 44.0208 32.0068V28.0068C44.0208 26.9023 44.9162 26.0068 46.0208 26.0068C47.1254 26.0068 48.0208 26.9023 48.0208 28.0068V32.0068V32.0058C48.018 40.0654 42.0185 46.8636 34.0218 47.8685L34.0208 47.8686ZM32.0208 40.0068C27.6025 40.0068 24.0208 36.4251 24.0208 32.0068V16.0068V16.0068C24.0208 11.5886 27.6025 8.00684 32.0208 8.00684C36.4391 8.00684 40.0208 11.5886 40.0208 16.0068V32.0068C40.0208 36.4251 36.4391 40.0068 32.0208 40.0068C32.0208 40.0068 32.0208 40.0068 32.0208 40.0068H32.0208Z"})}))));const Yr=b.ZP.div.withConfig({displayName:"RecordingPanel__ButtonsContainer",componentId:"sc-1bx09b7-0"})(["display:flex;flex-direction:row;margin-bottom:14px;gap:9px;margin-top:11px;"]),Jr=b.ZP.span.withConfig({displayName:"RecordingPanel__RecordCircle",componentId:"sc-1bx09b7-1"})(["background-color:#ff3434;height:12px;width:12px;border-radius:6px;margin-right:5px;"]),Xr=b.ZP.div.withConfig({displayName:"RecordingPanel__DevicePicker",componentId:"sc-1bx09b7-2"})(["margin-bottom:7px;"]);var Qr=e=>{let{videoStatus:t,tomeId:o,pageId:n,videoId:r}=e;const{t:i}=(0,y.$G)(),{apolloClient:s,clientId:c}=(0,H.bp)(),d=(0,l.sJ)(j.ep),p=(0,l.sJ)((0,Ge.vw)(n)),u=(0,l.rb)((0,Ge.vw)(n)),m=(0,l.Zl)(j.wo),[g,h]=(0,l.FV)(j.HV),[f,b]=(0,l.FV)(j.LW),C=(0,l.sJ)(j.jd),v=(0,l.sJ)(j.$6),x=(0,$.ye)($.TT.NARRATION_VIDEO_OVERRIDE),O=(0,I.t2)(),P=!!p.localMediaUrl||t===U.Kwn.Ready,w=e=>e.startsWith("Default - ")?i("sidebar.recordingPanel.sameAsSystemMicrophoneDropdownItem"):e.replace(/ *\([^)]*\) */g,""),T="NONE"!==d,E=d===Fr.D.NOT_ALLOWED_ERROR,S=d===Fr.D.NOT_READABLE_ERROR,k=d===Fr.D.UNSUPPORTED_BROWSER||d===Fr.D.OVERCONSTRAINED_ERROR,Z=(0,a.useCallback)((()=>{u(),(0,$r.Np)(o,n,s,c)}),[s,c,n,u,o]),D=p.inProgress;let M;return M=i(D?"sidebar.recordingPanel.uploading":P?"sidebar.recordingPanel.retake":"sidebar.recordingPanel.record"),(0,_.jsxs)(oe,{children:[x&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(re,{children:i("sidebar.media.muxVideoId")}),(0,_.jsx)(ne,{children:(0,_.jsx)(le,{type:"text",value:r||"",onChange:e=>{e.target.value&&(0,$r.w8)(o,n,e.target.value,s,c,(()=>{(0,V.ak)({message:`${i("sidebar.recording.overrideMessage")}`})}))}})})]}),(0,_.jsx)(Xr,{children:(0,_.jsx)(je,{disabled:0===v.length||T,currentValue:g||"",options:v.map((e=>({value:e.deviceId,label:w(e.label)}))),onChange:e=>{h(e)},menuWidth:"100%",icon:Ur,controlWidth:"100%",placeholder:i("sidebar.media.camera")})}),(0,_.jsx)(Xr,{children:(0,_.jsx)(je,{disabled:0===C.length||T,currentValue:f||"",options:C.map((e=>({value:e.deviceId,label:w(e.label)}))),onChange:e=>{b(e)},menuWidth:"100%",icon:Kr,controlWidth:"100%",placeholder:i("sidebar.media.microphone")})}),(0,_.jsxs)(Yr,{children:[(0,_.jsx)(Ve.Z,{disabled:D||T,"data-testid":"record_button","aria-label":i("sidebar.media.record"),onClick:()=>{m(!0),O.closePropertyPanel(),(0,V.oG)(!0)},iconOpacity:1,startIcon:D?(0,_.jsx)(_.Fragment,{}):(0,_.jsx)(Jr,{}),style:{width:"100%"},children:M}),P&&(0,_.jsx)(Ve.Z,{"data-testid":"delete_recording_button","aria-label":i("sidebar.media.delete"),onClick:Z,children:i("sidebar.media.delete")})]}),k&&(0,_.jsx)(Pt,{tag:i("sidebar.media.unsupportedBrowserTag"),message:i("sidebar.media.unsupportedBrowserMessage")}),S&&(0,_.jsx)(Pt,{tag:i("sidebar.media.cameraErrorTag"),message:i("sidebar.media.cameraErrorMessage")}),E&&(0,_.jsx)(Pt,{tag:i("sidebar.media.permissionNeededTag"),message:i("sidebar.media.permissionNeededMessage")})]})},ei=o(28648),ti=o(28670),oi=o.n(ti),ni=o(15814),ri=o(28205),ii=o(21585),ai=o(65890),li=o(36488),si=o(22951);function ci(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function di(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ci(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ci(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const pi=(0,b.ZP)(ue.Z).attrs({width:"8",height:"8",viewBox:"0 0 10 10"}).withConfig({displayName:"ThemeDropdown__DropdownArrow",componentId:"sc-1pl3wgr-0"})(["align-self:middle;display:inline-flex;margin:0.1em 0 0 0.35em;stroke:currentColor;flex-shrink:0;"]),ui=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeRow",componentId:"sc-1pl3wgr-1"})(["display:flex;flex-direction:row;gap:8px;align-items:center;font-size:",";"],(e=>{let{theme:t}=e;return t.fontSizes.sm})),mi=b.ZP.div.attrs((e=>{let{color:t,theme:o}=e;return{style:{backgroundColor:t,borderColor:(0,ai.D1)({foregroundColorHex:t,backgroundColorHex:o.RAW_VALUES_LEGACY.menuBackgroundLayer[0]})}}})).withConfig({displayName:"ThemeDropdown__ThemeSwatch",componentId:"sc-1pl3wgr-2"})(["display:inline-flex;flex-direction:column;flex-shrink:0;justify-content:center;align-items:flex-start;width:32px;height:20px;border-radius:3px;border-width:1px;border-style:solid;text-align:left;padding-left:4px;"]),gi=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeTitle",componentId:"sc-1pl3wgr-3"})(["font-size:7px;line-height:1;color:",";"],(e=>{let{color:t}=e;return t})),hi=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeBody",componentId:"sc-1pl3wgr-4"})(["font-size:6px;line-height:1;color:",";"],(e=>{let{color:t}=e;return t})),fi=b.ZP.button.withConfig({displayName:"ThemeDropdown__ThemeDropdownTrigger",componentId:"sc-1pl3wgr-5"})(["background:",";color:",";border-radius:",";padding:6px;width:100%;","{width:48px;height:28px;border-radius:",";padding-left:5px;}","{font-size:9px;}","{font-size:7px;}svg{margin-left:auto;margin-right:6px;}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.colors.menuControlText}),(e=>{let{theme:t}=e;return t.borderRadius.sm}),mi,(e=>{let{theme:t}=e;return t.borderRadius.xs}),gi,hi),bi=b.ZP.div.withConfig({displayName:"ThemeDropdown__ThemeName",componentId:"sc-1pl3wgr-6"})([""," ",""],si.wR,(e=>{let{$isAnonymous:t}=e;return t&&"\n    font-style: italic;\n  "})),yi=e=>{let{colors:t,children:o}=e;return(0,_.jsxs)(ui,{children:[(0,_.jsxs)(mi,{color:t.pageColor,children:[(0,_.jsx)(gi,{color:t.titleColor,children:"Title"}),(0,_.jsx)(hi,{color:t.bodyColor,children:"Body"})]}),o]})};var Ci=e=>{let{selected:t,themes:o,onChange:n,dropdownProps:r}=e;const{height:i}=(0,F.Z)(),a=o.map((e=>new li.Z(e))).filter((e=>!e.isAnonymous)).map((e=>({id:e.id,checked:e.id===t,action:()=>n(e.id),text:(0,_.jsx)(yi,{colors:e.colors,children:(0,_.jsx)(bi,{$isAnonymous:e.isAnonymous,title:e.displayName,children:e.displayName})})}))),l=new li.Z(o.filter((e=>e.id===t))[0]);return(0,_.jsx)(ii.Z,di(di({menuWidth:216,menuPosition:"below",menuAlign:"left",maxHeight:Math.min(i?.5*i+50:500,500),itemsOrFn:a},r),{},{children:(0,_.jsx)(fi,{type:"button","data-testid":"theme_dropdown_trigger",children:l&&l.hasColors&&(0,_.jsxs)(yi,{colors:l.colors,children:[(0,_.jsx)(bi,{$isAnonymous:l.isAnonymous,title:l.displayName,children:l.displayName}),(0,_.jsx)(pi,{"data-testid":"dropdown_arrow"})]})})}))},vi=o(88263),xi=o(25934),Oi=o(62830),Pi=o.n(Oi),wi=o(67679),ji=o(6748);function Ti(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ei(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ti(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ti(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Ii(e){var t;let{tomeId:o,pageId:n,colors:{bodyColor:r,pageColor:i,titleColor:a},headingTypeface:l,paragraphTypeface:s,apolloClient:c,clientId:d}=e;const p=Pi()(),u=(0,xi.Z)(),m=null===(t=c.cache.readFragment({id:`Tome:${o}`,fragment:U.bcy,fragmentName:"TomeOrgIdFragment"}).org)||void 0===t?void 0:t.id;(0,wi.L)(!!m,"Trying to create a theme and update its page, but was not able to retrieve an orgId from the cache",{tomeId:o,pageId:n});const g=[{operation:U.C8.CreateTheme,id:p,theme:{orgId:m,colors:{bodyColor:r,pageColor:i,titleColor:a},headingTypeface:l,paragraphTypeface:s,headingFontId:null===l||void 0===l?void 0:l.baseline.id,paragraphFontId:null===s||void 0===s?void 0:s.baseline.id}}];g.push({operation:U.C8.UpdatePage,id:n,page:{themeId:p}});const h={id:u,tomeId:o,clientId:d,apply:g,revert:(0,ji.oF)(g,c.cache)};(0,ji.iO)(c,h)}function Si(e){var t;let{tomeId:o,pageId:n,previousThemeId:r,colors:{bodyColor:i,pageColor:a,titleColor:l},headingTypeface:s,paragraphTypeface:c,apolloClient:d,clientId:p}=e;const u=Pi()(),m=(0,xi.Z)(),g=null===(t=d.cache.readFragment({id:`Tome:${o}`,fragment:U.bcy,fragmentName:"TomeOrgIdFragment"}).org)||void 0===t?void 0:t.id;(0,wi.L)(!!g,"Trying to create a theme and update its page, but was not able to retrieve an orgId from the cache",{tomeId:o,pageId:n});const h=[{operation:U.C8.CreateTheme,id:u,theme:{orgId:g,colors:{bodyColor:i,pageColor:a,titleColor:l},headingTypeface:s,paragraphTypeface:c,headingFontId:null===s||void 0===s?void 0:s.baseline.id,paragraphFontId:null===c||void 0===c?void 0:c.baseline.id}}];h.push({operation:U.C8.UpdateTome,id:o,tome:{themeId:u}});d.cache.readFragment({id:`Tome:${o}`,fragment:U.s0Y,fragmentName:"TomePagesFragment"}).pages.forEach((e=>{r&&e.theme.id!==r||h.push({operation:U.C8.UpdatePage,id:e.id,page:{id:e.id,themeId:u}})}));const f=(0,ji.oF)(h,d.cache),b={id:m,tomeId:o,clientId:p,apply:h,revert:f};(0,ji.iO)(d,b)}function _i(e,t,o,n,r){var i;const a=(0,xi.Z)(),l=null===(i=n.cache.readFragment({id:`Tome:${e}`,fragment:U.bcy,fragmentName:"TomeOrgIdFragment"}).org)||void 0===i?void 0:i.id,s=[{operation:U.C8.UpdateTheme,id:t,theme:o}],c={id:a,tomeId:e,clientId:r,apply:s,revert:(0,ji.oF)(s,n.cache)},d=[{operation:U.C8.UpdateTheme,id:t,theme:Ei({orgId:l},o)}],p={id:a,tomeId:e,clientId:r,apply:d,revert:(0,ji.oF)(d,n.cache)};(0,ji.iO)(n,c,p)}var ki=o(22111);const Zi=oi()("#000000").hex();function Di(e){const t=oi()(e),o=t.luminance(),n=t.lch()[1],r=t.lch()[2];let i,a;return oi()(e).hex()===Zi?{titleColor:"#FFFFFF",bodyColor:"#959595"}:(o>=.5?n>=30?(i=t.set("lch.l","/2.8").saturate(2.5).set("lch.h",r).hex(),a=oi().mix(t,i,.8).hex()):n<30&&n>=1?(i=t.set("lch.l","/2.7").saturate(2.5).set("lch.h",r).hex(),a=oi().mix(t,i,.8).hex()):(i=t.luminance(.02).hex(),a=t.luminance(.16).hex()):o<.5&&o>=.3?n>=30?(i=t.set("lch.l","/2.3").set("lch.h",r).hex(),a=oi().mix(t,i,.8).hex()):n<30&&n>=1?(i=t.set("lch.l","/2.7").saturate(1.2).set("lch.h",r).hex(),a=oi().mix(t,i,.8).hex()):(i=t.luminance(.02).hex(),a=t.luminance(.08).hex()):o<.3&&o>=.15?(i=n>=50?t.set("lch.l","*2.3").set("lch.h",r).hex():n<50&&n>=1?t.set("lch.l","*2.7").saturate(.8).set("lch.h",r).hex():t.set("lch.l","*3.4").set("lch.h",r).hex(),a=oi().mix(t,i,.7).hex()):o<.15&&o>=.02?(i=n>=50?t.set("lch.l","*4").set("lch.h",r).hex():n<50&&n>=1?t.set("lch.l","*6.5").saturate(.4).set("lch.h",r).hex():t.set("lch.l","*4").set("lch.h",r).hex(),a=oi().mix(t,i,.5).hex()):(i=t.luminance(.9).hex(),a=t.luminance(.3).hex()),{titleColor:i,bodyColor:a})}var Mi=o(50135),Ri=o(31951);function Ai(e){var t,o;const{tomeId:n}=(0,a.useContext)(Mi.z),{data:r}=(0,U.OXH)({variables:{tomeId:n}}),i=null===r||void 0===r||null===(t=r.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.typeFamilies;return(0,a.useCallback)((()=>{const t=e?(0,pr.Fx)(e,i):(0,pr.RE)(i);Ri.Z.getInstance().loadFonts(t,!1)}),[e,i])}function Li(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ni(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Li(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Li(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Hi=(0,b.ZP)(ue.Z).attrs({width:8,height:8,viewBox:"0 0 10 10"}).withConfig({displayName:"FontDropdown__DropdownArrow",componentId:"gn8i8w-0"})(["stroke:currentColor;min-width:8px;"]),Vi=b.ZP.div.withConfig({displayName:"FontDropdown__RowText",componentId:"gn8i8w-1"})(["",""],si.wR),Bi=b.ZP.div.withConfig({displayName:"FontDropdown__Row",componentId:"gn8i8w-2"})(["display:flex;justify-content:space-between;gap:8px;width:88px;align-items:center;font-family:",",'Inter',sans-serif;font-weight:",";"],(e=>{let{$font:t}=e;return t??"Inter"}),(e=>{let{$weight:t}=e;return t??"normal"})),$i=(0,b.ZP)(Ve.Z).withConfig({displayName:"FontDropdown__DropdownTrigger",componentId:"gn8i8w-3"})(["padding:0px 8px;justify-content:flex-start;width:100%;line-height:16px;"]),Fi=e=>{let{value:t,items:o,onChange:n,dropdownProps:r}=e;const{height:i}=(0,F.Z)(),l=[];for(const a of o){l.length>0&&l.push({type:"separator"}),a.name&&l.push({type:"label",text:a.name,paddingVertical:5,paddingHorizontal:8});for(const e of a.typeFamilies)l.push({type:"option",id:e.name,checked:e.id===(null===t||void 0===t?void 0:t.id),action:()=>{n(e)},text:(0,_.jsx)(Bi,{$font:e.family,children:e.name})})}const s=Ai(),c=(0,a.useCallback)((()=>{s()}),[s]);return(0,_.jsx)(ii.Z,Ni(Ni({menuWidth:106,menuPosition:"below",menuAlign:"left",dynamicMenuWidth:216,maxHeight:Math.min(i?.5*i+50:500,500),itemsOrFn:l,dataTestId:null===r||void 0===r?void 0:r.dataTestId,onOpenDropdown:c},r),{},{children:(0,_.jsx)($i,{type:"button","data-testid":"typeFamily_dropdown_trigger",onMouseOver:c,children:(0,_.jsxs)(Bi,{children:[(0,_.jsx)(Vi,{children:null===t||void 0===t?void 0:t.name}),(0,_.jsx)(Hi,{"data-testid":"typefaceWeight_dropdown_arrow"})]})})}))},Gi=e=>{let{value:t,font:o,items:n,onChange:r,dropdownProps:i}=e;const{height:l}=(0,F.Z)(),{t:s}=(0,y.$G)(),c=n.map((e=>({id:e.id??e.weight.toString(),checked:e.weight===(null===t||void 0===t?void 0:t.weight),action:()=>{r(e)},text:(0,_.jsx)(Bi,{$font:o,$weight:e.weight,children:e.variantName??s("themes.regularFontType")})}))),d=Ai(o),p=(0,a.useCallback)((()=>{d()}),[d]);return(0,_.jsx)(ii.Z,Ni(Ni({menuWidth:106,menuPosition:"below",menuAlign:"left",dynamicMenuWidth:216,maxHeight:Math.min(l?.5*l+50:500,500),itemsOrFn:c,onOpenDropdown:p},i),{},{children:(0,_.jsx)($i,{type:"button","data-testid":"typefaceWeight_dropdown_trigger",onMouseOver:p,children:(0,_.jsxs)(Bi,{children:[(0,_.jsx)(Vi,{children:(null===t||void 0===t?void 0:t.variantName)??s("themes.regularFontType")}),(0,_.jsx)(Hi,{"data-testid":"typefaceWeight_dropdown_arrow"})]})})}))};var zi=o(77717);const Ui=b.ZP.div.withConfig({displayName:"CustomizePanelColorPicker__ColorPickerBackground",componentId:"sc-14ermo3-0"})(["background-color:",";border-radius:20px;width:","px;display:flex;box-shadow:",";"],(e=>e.theme.colors.sidebar),240,(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow})),Wi=b.ZP.div.withConfig({displayName:"CustomizePanelColorPicker__ColorPickerWrapper",componentId:"sc-14ermo3-1"})(["padding-top:12px;"]);var qi=e=>{let{top:t,right:o,color:n,setColor:r,setColorComplete:i}=e;const{colorPickerContainerRef:a}=(0,vi.R)();return(0,_.jsx)(zi.Z,{top:t,left:o-240,zIndex:T.y$,children:(0,_.jsx)(Ui,{ref:a,onMouseDown:Ct.Z,children:(0,_.jsx)(Wi,{children:(0,_.jsx)(kn.default,{color:n,setColor:r,setColorComplete:i})})})})};const Ki=b.ZP.div.withConfig({displayName:"styles__CustomColorButtonWrapper",componentId:"sc-1b0g9v8-0"})(["display:flex;flex-wrap:wrap;gap:8px;"]),Yi=b.ZP.div.withConfig({displayName:"styles__ButtonWrapper",componentId:"sc-1b0g9v8-1"})(["display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr);gap:8px;width:100%;"]),Ji=b.ZP.div.withConfig({displayName:"styles__StyledSegmentedControlsContainer",componentId:"sc-1b0g9v8-2"})(["padding-bottom:12px;"]),Xi=b.ZP.div.withConfig({displayName:"styles__Content",componentId:"sc-1b0g9v8-3"})(["margin-top:8px;margin-bottom:12px;"]),Qi=b.ZP.div.withConfig({displayName:"styles__FontSection",componentId:"sc-1b0g9v8-4"})(["display:grid;grid-auto-flow:column;grid-auto-columns:minmax(0,1fr) minmax(0,1fr);width:100%;gap:8px;"]),ea=b.ZP.div.withConfig({displayName:"styles__FontDropdownsSection",componentId:"sc-1b0g9v8-5"})(["display:flex;flex-direction:column;gap:6px;"]),ta=b.ZP.label.withConfig({displayName:"styles__ToggleWrapper",componentId:"sc-1b0g9v8-6"})(["display:flex;margin-left:auto;cursor:pointer;height:auto;"]),oa=(0,b.ZP)(re).withConfig({displayName:"styles__TextColorPropertyRowText",componentId:"sc-1b0g9v8-7"})(["display:flex;padding-top:12px;padding-top:8px;padding-bottom:0px;height:auto;"]);let na;!function(e){e.TOME="Tome",e.PAGE="Page"}(na||(na={}));var ra,ia=e=>{let{panelMode:t,closeColorPicker:o,setPanelMode:n}=e;const r=(0,Oo.Z)((e=>()=>{o(),n(e)}),[o,n]),{t:i}=(0,y.$G)();return(0,_.jsx)(Ji,{children:(0,_.jsx)(Fe,{role:"listbox","data-testid":"customize_panel_mode_toggle",children:Object.values(na).map((e=>(0,_.jsx)(Ve.Z,{isSegment:!0,onClick:r(e),selected:t===e,children:`${i("sidebar.customizePanel.mode",{mode:e})}`},e)))})})};function aa(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function la(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):aa(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}!function(e){e.PAGE_COLOR="pageColor",e.TITLE_COLOR="titleColor",e.BODY_COLOR="bodyColor",e.NONE="none"}(ra||(ra={}));var sa;!function(e){e.HEADING="HEADING",e.PARAGRAPH="PARAGRAPH"}(sa||(sa={}));const ca=e=>{let{checked:t,onClick:o}=e;return(0,_.jsx)(ta,{"data-disable-event-propagation":!0,children:(0,_.jsx)(Je.Z,{inputId:"customize_panel_auto_color_toggle",width:"21px",height:"12px",radius:4,checked:t,onBgColor:!0,onClick:e=>{e.currentTarget.blur(),o(e)}})})};var da;!function(e){e.UPDATE_COLOR="UPDATE_COLOR",e.UPDATE_COLORS="UPDATE_COLORS",e.UPDATE_ACTIVE_COLOR_PROPERTY="UPDATE_ACTIVE_COLOR_PROPERTY",e.UPDATE_ACTIVE_COLOR_CHANGE="UPDATE_ACTIVE_COLOR_CHANGE",e.UPDATE_HEADING_FONT_ID="UPDATE_HEADING_FONT_ID",e.UPDATE_PARAGRAPH_FONT_ID="UPDATE_PARAGRAPH_FONT_ID"}(da||(da={}));const pa=(e,t)=>{switch(t.type){case da.UPDATE_ACTIVE_COLOR_PROPERTY:return la(la({},e),{},{[e.activeColorChange]:t.payload});case da.UPDATE_ACTIVE_COLOR_CHANGE:return e.activeColorChange===t.payload?e:la(la({},e),{},{activeColorChange:t.payload});case da.UPDATE_COLORS:return la(la({},e),t.payload);case da.UPDATE_HEADING_FONT_ID:return la(la({},e),{},{headingFontId:t.payload});case da.UPDATE_PARAGRAPH_FONT_ID:return la(la({},e),{},{paragraphFontId:t.payload});default:return e}};function ua(e){const t=Di(e.pageColor);return oi()(e.titleColor).hex()===oi()(t.titleColor).hex()&&oi()(e.bodyColor).hex()===oi()(t.bodyColor).hex()}var ma=e=>{var t,o,n,r,i,l,s,c,d,p,u,m,g,h,f,b,C;let{tomeId:v,pageId:x,pageTheme:O,tomeTheme:P,fontData:w,nonTileSidebarRef:j}=e;const T=(0,a.useRef)(!1),E=(0,a.useMemo)((()=>new li.Z(O)),[O]),I=(0,a.useMemo)((()=>new li.Z(P)),[P]),{0:S,1:k}=(0,a.useState)(O.id===P.id?na.TOME:na.PAGE),Z=S===na.TOME?I:E,{0:D,1:M}=(0,a.useReducer)(pa,{activeColorChange:ra.NONE,pageColor:Z.colors.pageColor,titleColor:Z.colors.titleColor,bodyColor:Z.colors.bodyColor,headingFontId:null===(t=Z.headingTypeface)||void 0===t||null===(o=t.baseline)||void 0===o?void 0:o.id,paragraphFontId:null===(n=Z.paragraphTypeface)||void 0===n||null===(r=n.baseline)||void 0===r?void 0:r.id}),{0:R,1:A}=(0,a.useState)(ua(E.colors)),{0:L,1:N}=(0,a.useState)(ua(I.colors)),V=S===na.TOME?L:R;(0,a.useEffect)((()=>{T.current||(A(ua(E.colors)),N(ua(I.colors))),T.current=!1}),[E.colors,E.id,I.colors,I.id]);const{updateThemeCssVars:B}=(0,vi.R)(),F=(0,$.ye)($.TT.FONTS),G=(0,ni.m)(),{propertyPanelRef:z}=(0,H.TR)(),{clientId:W,apolloClient:q}=(0,H.bp)(),K=(0,a.useCallback)((e=>{!function(e){let{tomeId:t,pageId:o,themeId:n,previousThemeId:r,apolloClient:i,clientId:a}=e;const l=(0,xi.Z)(),s=li.Z.fromCacheFragment(r,i.cache),c=[{operation:U.C8.UpdatePage,id:o,page:{themeId:n,autoThemeColor:!0}}];null!==s&&void 0!==s&&s.isAnonymous&&c.push({operation:U.C8.DeleteTheme,id:r});const d={id:l,tomeId:t,clientId:a,apply:c,revert:(0,ji.oF)(c,i.cache)};(0,ji.iO)(i,d)}({tomeId:v,pageId:x,themeId:e,previousThemeId:E.id,apolloClient:q,clientId:W}),A(ua(E.colors))}),[q,W,E.id,E.colors,x,v]),Y=(0,a.useCallback)((()=>{M({type:da.UPDATE_ACTIVE_COLOR_CHANGE,payload:ra.NONE})}),[]),{data:J,loading:X}=(0,U.CHH)({variables:{tomeId:v},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"}),Q=(null===J||void 0===J||null===(i=J.tome)||void 0===i||null===(l=i.org)||void 0===l?void 0:l.themes)??[],{data:ee}=(0,U.hC_)({variables:{tomeId:v,pageId:x},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"}),te=null===ee||void 0===ee||null===(s=ee.page)||void 0===s?void 0:s.theme,ne=null===ee||void 0===ee||null===(c=ee.tome)||void 0===c?void 0:c.theme,{data:ie}=(0,U.sn6)({variables:{tomeId:v}}),ae=(0,ei.Z)([...Q,...te?[te]:[]],(e=>e.id)),le=(0,ei.Z)([...Q,...ne?[ne]:[]],(e=>e.id));(0,a.useEffect)((()=>{M({type:da.UPDATE_COLORS,payload:{pageColor:Z.colors.pageColor,titleColor:Z.colors.titleColor,bodyColor:Z.colors.bodyColor}})}),[Z.colors.pageColor,Z.colors.titleColor,Z.colors.bodyColor]),(0,a.useEffect)((()=>{var e,t;M({type:da.UPDATE_HEADING_FONT_ID,payload:null===(e=Z.headingTypeface)||void 0===e||null===(t=e.baseline)||void 0===t?void 0:t.id})}),[null===(d=Z.headingTypeface)||void 0===d||null===(p=d.baseline)||void 0===p?void 0:p.id]),(0,a.useEffect)((()=>{var e,t;M({type:da.UPDATE_PARAGRAPH_FONT_ID,payload:null===(e=Z.paragraphTypeface)||void 0===e||null===(t=e.baseline)||void 0===t?void 0:t.id})}),[null===(u=Z.paragraphTypeface)||void 0===u||null===(m=u.baseline)||void 0===m?void 0:m.id]);const se=(0,a.useCallback)((e=>{if(!e)return;const t=e.trim();return(0,ki.B)(t||"")?oi()(t).hex():void 0}),[]),ce=(0,a.useCallback)(((e,t)=>{const o=la({pageColor:D.pageColor,titleColor:D.titleColor,bodyColor:D.bodyColor},D.activeColorChange!==ra.NONE&&{[D.activeColorChange]:e});if(t){const{titleColor:t,bodyColor:n}=Di(e);o.bodyColor=n,o.titleColor=t}return{colors:o}}),[D.activeColorChange,D.titleColor,D.pageColor,D.bodyColor]),de=(0,a.useCallback)(((e,t)=>{const o=se(e);if(!o)return;const{colors:n}=ce(o,t);switch(S){case na.TOME:I.isAnonymous?_i(v,I.id,{colors:n},q,W):Si({tomeId:v,pageId:x,previousThemeId:I.id,colors:n,headingTypeface:I.headingTypeface,paragraphTypeface:I.paragraphTypeface,apolloClient:q,clientId:W});break;case na.PAGE:E.isAnonymous&&E.id!==I.id?_i(v,E.id,{colors:n},q,W):Ii({tomeId:v,pageId:x,colors:n,headingTypeface:E.headingTypeface,paragraphTypeface:E.paragraphTypeface,apolloClient:q,clientId:W})}T.current=!0}),[se,ce,S,I.isAnonymous,I.id,E.isAnonymous,E.id,I.headingTypeface,I.paragraphTypeface,E.headingTypeface,E.paragraphTypeface,v,x,q,W]),pe=(0,a.useCallback)((()=>{if(S===na.PAGE){const e=!R;ua(E.colors)||de(D.pageColor,e),A(e)}if(S===na.TOME){const e=!L;ua(I.colors)||de(D.pageColor,e),N(e)}}),[S,R,E.colors,de,D.pageColor,L,I.colors]),ue=(0,a.useCallback)((e=>{const t=se(e);if(!t)return;const o=D.activeColorChange===ra.PAGE_COLOR&&V,{colors:n}=ce(t,o);M({type:da.UPDATE_COLORS,payload:n}),S===na.TOME&&B(I.id,n),S===na.PAGE&&B(E.id,n)}),[ce,se,B,S,I.id,E.id,D.activeColorChange,V]),me=(0,a.useCallback)((e=>{null!==e.target.closest("[data-disable-event-propagation]")||D.activeColorChange===ra.NONE||M({type:da.UPDATE_ACTIVE_COLOR_CHANGE,payload:ra.NONE})}),[D.activeColorChange]),{headingFontId:ge,paragraphFontId:he}=D,fe=(0,a.useMemo)((()=>(0,pr.Rk)(w,ge,pr.uF)),[w,ge]),be=(0,a.useMemo)((()=>{var e;if(ge){const e=w.fontIDToFontDataMap[ge];if(e)return e}return(0,pr.AK)(null===(e=w.typeFamilyToWeightsDataMap[pr.uF])||void 0===e?void 0:e.normal,pr.dR,"ROUND_UP")}),[ge,w.fontIDToFontDataMap,w.typeFamilyToWeightsDataMap]),ye=(0,a.useMemo)((()=>(0,pr.Rk)(w,he,pr.yc)),[w,he]),Ce=(0,a.useMemo)((()=>{var e;if(he){const e=w.fontIDToFontDataMap[he];if(e)return e}return(0,pr.AK)(null===(e=w.typeFamilyToWeightsDataMap[pr.yc])||void 0===e?void 0:e.normal,pr.w2,"ROUND_DOWN")}),[he,w.fontIDToFontDataMap,w.typeFamilyToWeightsDataMap]);(0,a.useEffect)((()=>{const e=null===j||void 0===j?void 0:j.current;return e&&e.addEventListener("click",me),()=>{null===e||void 0===e||e.removeEventListener("click",me)}}),[me,j]);const ve=(0,Oo.Z)((e=>t=>{t.stopPropagation();const o=e===D.activeColorChange?ra.NONE:e;M({type:da.UPDATE_ACTIVE_COLOR_CHANGE,payload:o})}),[D.activeColorChange]),xe=(0,a.useCallback)((e=>{if(!e)return;const t=S===na.TOME?I.id:E.id;_i(v,t,{name:e},q,W)}),[S,v,I.id,q,W,E.id]),Oe=(0,a.useCallback)((e=>{e||(S===na.PAGE&&A(!1),S===na.TOME&&N(!1))}),[S,A,N]),Pe=(0,a.useCallback)((e=>{const t=D.activeColorChange===ra.PAGE_COLOR;Oe(t);de(e,t&&V)}),[D.activeColorChange,Oe,V,de]),we=null===(g=z.current)||void 0===g?void 0:g.getBoundingClientRect(),je=(0,a.useCallback)((e=>{!function(e,t,o,n,r){const i=[{operation:U.C8.UpdateTome,id:e,tome:{themeId:t}}];n.cache.readFragment({id:`Tome:${e}`,fragment:U.s0Y,fragmentName:"TomePagesFragment"}).pages.forEach((e=>{o&&e.theme.id!==o||i.push({operation:U.C8.UpdatePage,id:e.id,page:{id:e.id,themeId:t}})}));const a=(0,ji.oF)(i,n.cache),l={id:(0,xi.Z)(),tomeId:e,clientId:r,apply:i,revert:a};(0,ji.iO)(n,l)}(v,e,I.id,q,W),N(ua(I.colors))}),[q,W,v,I.id,I.colors]),Te=(0,a.useCallback)((()=>{K(I.id)}),[K,I.id]),Ee=S===na.TOME?!I.isAnonymous:!E.isAnonymous,Ie=(0,a.useCallback)((e=>t=>{const o=S===na.TOME,n=e===sa.HEADING,r=n?t.id:D.headingFontId,i=n?D.paragraphFontId:t.id,a=(0,pr.QL)(w,r),l=(0,pr.QL)(w,i);o&&!I.isAnonymous?Si({tomeId:v,pageId:x,previousThemeId:I.id,colors:{pageColor:I.colors.pageColor,titleColor:I.colors.titleColor,bodyColor:I.colors.bodyColor},headingTypeface:a,paragraphTypeface:l,apolloClient:q,clientId:W}):o||E.isAnonymous&&E.id!==I.id?_i(v,o?I.id:E.id,{headingTypeface:a,paragraphTypeface:l,headingFontId:r,paragraphFontId:i},q,W):Ii({tomeId:v,pageId:x,colors:{pageColor:E.colors.pageColor,titleColor:E.colors.titleColor,bodyColor:E.colors.bodyColor},headingTypeface:a,paragraphTypeface:l,apolloClient:q,clientId:W}),M({type:n?da.UPDATE_HEADING_FONT_ID:da.UPDATE_PARAGRAPH_FONT_ID,payload:t.id})}),[q,W,D.headingFontId,D.paragraphFontId,w,x,E.colors.bodyColor,E.colors.pageColor,E.colors.titleColor,E.id,E.isAnonymous,S,v,I.colors.bodyColor,I.colors.pageColor,I.colors.titleColor,I.id,I.isAnonymous]),Se=(0,a.useCallback)((e=>t=>{const o=t,n=w.typeFamilyToWeightsDataMap[o.name].normal,r=e===sa.HEADING,i=(0,pr.AK)(n,r?(null===be||void 0===be?void 0:be.weight)??pr.dR:(null===Ce||void 0===Ce?void 0:Ce.weight)??pr.w2,r?"ROUND_UP":"ROUND_DOWN");i&&(M({type:r?da.UPDATE_HEADING_FONT_ID:da.UPDATE_PARAGRAPH_FONT_ID,payload:i.id}),Ie(e)(i))}),[null===Ce||void 0===Ce?void 0:Ce.weight,null===be||void 0===be?void 0:be.weight,w.typeFamilyToWeightsDataMap,Ie]),{t:_e}=(0,y.$G)(),ke=S===na.TOME?"sidebar.tomeTheme":"sidebar.pageTheme";return(0,_.jsx)(oe,{children:(!X||Q.length>0)&&O&&ae&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(Xi,{children:[(0,_.jsx)(ia,{panelMode:S,setPanelMode:k,closeColorPicker:Y}),(0,_.jsx)(re,{children:_e(ke)}),S===na.TOME?(0,_.jsx)(Ci,{selected:I.id,themes:le,onChange:je}):(0,_.jsx)(Ci,{selected:E.id,themes:ae,onChange:K}),(0,_.jsx)(re,{style:{marginTop:12},children:_e("sidebar.page")}),(0,_.jsxs)(Ki,{children:[(0,_.jsx)(ri.Z,{color:D.pageColor,label:_e("sidebar.background"),selected:D.activeColorChange===ra.PAGE_COLOR,onButtonClick:ve(ra.PAGE_COLOR),"data-disable-event-propagation":!0}),!F&&(0,_.jsxs)("div",{style:{marginTop:4},children:[(0,_.jsx)(re,{children:_e("sidebar.textColor")}),(0,_.jsxs)(Ki,{children:[(0,_.jsx)(ri.Z,{color:D.titleColor,label:_e("sidebar.heading"),selected:D.activeColorChange===ra.TITLE_COLOR,onButtonClick:ve(ra.TITLE_COLOR),"data-disable-event-propagation":!0}),(0,_.jsx)(ri.Z,{color:D.bodyColor,label:_e("sidebar.paragraph"),selected:D.activeColorChange===ra.BODY_COLOR,onButtonClick:ve(ra.BODY_COLOR),"data-disable-event-propagation":!0})]}),(0,_.jsxs)(oa,{children:[_e("sidebar.autoColor"),S===na.PAGE&&(0,_.jsx)(ca,{checked:R,onClick:pe}),S===na.TOME&&(0,_.jsx)(ca,{checked:L,onClick:pe})]})]}),F&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(Qi,{style:{marginTop:8},children:[(0,_.jsxs)("div",{children:[(0,_.jsx)(re,{children:_e("sidebar.heading")}),(0,_.jsxs)(ea,{children:[(0,_.jsx)(Fi,{value:fe,items:w.typeFamilySections,onChange:Se(sa.HEADING),dropdownProps:{dataTestId:"heading_type_family_dropdown"}},"typeFamily"),(0,_.jsx)(Gi,{value:be,font:null===fe||void 0===fe?void 0:fe.family,items:fe?w.typeFamilyToWeightsDataMap[fe.name].normal:[],onChange:Ie(sa.HEADING),dropdownProps:{dataTestId:"heading_weight_dropdown"}},"weight"),(0,_.jsx)(Ki,{children:(0,_.jsx)(ri.Z,{color:D.titleColor,label:_e("sidebar.heading"),selected:D.activeColorChange===ra.TITLE_COLOR,onButtonClick:ve(ra.TITLE_COLOR),"data-disable-event-propagation":!0})})]})]},"heading"),(0,_.jsxs)("div",{children:[(0,_.jsx)(re,{children:_e("sidebar.paragraph")}),(0,_.jsxs)(ea,{children:[(0,_.jsx)(Fi,{value:ye,items:w.typeFamilySections,onChange:Se(sa.PARAGRAPH),dropdownProps:{menuAlign:"right",dataTestId:"paragraph_type_family_dropdown"}},"typeFamily"),(0,_.jsx)(Gi,{value:Ce,font:null===ye||void 0===ye?void 0:ye.family,items:ye?w.typeFamilyToWeightsDataMap[ye.name].normal:[],onChange:Ie(sa.PARAGRAPH),dropdownProps:{menuAlign:"right",dataTestId:"paragraph_weight_dropdown"}},"weight"),(0,_.jsx)(Ki,{children:(0,_.jsx)(ri.Z,{color:D.bodyColor,label:_e("sidebar.paragraph"),selected:D.activeColorChange===ra.BODY_COLOR,onButtonClick:ve(ra.BODY_COLOR),"data-disable-event-propagation":!0})})]})]},"paragraph")]}),(0,_.jsxs)(oa,{style:{paddingTop:0},children:[_e("sidebar.autoColor"),S===na.PAGE&&(0,_.jsx)(ca,{checked:R,onClick:pe}),S===na.TOME&&(0,_.jsx)(ca,{checked:L,onClick:pe})]})]}),(0,_.jsxs)(Yi,{style:{marginTop:4},children:[S===na.PAGE&&(0,_.jsx)(Ve.Z,{onClick:Te,disabled:E.id===I.id,children:_e("sidebar.reset")}),(0,_.jsx)(Ve.Z,{onClick:G.open,disabled:Ee,children:`${_e("sidebar.save")} ${_e("sidebar.customizePanel.theme")}`})]})]}),(0,_.jsx)(ni.Z,{ref:G.ref,title:`${_e("sidebar.customizePanel.saveTheme")}`,subtitle:null!==ie&&void 0!==ie&&null!==(h=ie.tome)&&void 0!==h&&null!==(f=h.org)&&void 0!==f&&f.name?_e("sidebar.customizePanel.subtitle",{context:"organization",organization:null===ie||void 0===ie||null===(b=ie.tome)||void 0===b||null===(C=b.org)||void 0===C?void 0:C.name}):_e("sidebar.customizePanel.subtitle"),primaryButtonText:_e("sidebar.save"),onSubmit:xe,placeholder:_e("sidebar.themeName")})]}),D.activeColorChange!==ra.NONE&&(0,_.jsx)(qi,{top:we.top,right:we.left-8,color:D[D.activeColorChange],setColor:ue,setColorComplete:Pe})]})})};var ga=e=>{var t,o,n,r;let{tome:i,page:s,currentPanel:c,maxHeight:d,onTileDragStart:p,onTileDragEnd:u,draggable:m,startDrag:g}=e;const h=(0,l.sJ)($n.Qf),f=(0,a.useRef)(null),{data:b}=(0,U.OXH)({variables:{tomeId:i.id}}),C=(0,a.useMemo)((()=>{var e,t;return(0,pr.Zq)(null===b||void 0===b||null===(e=b.tome)||void 0===e||null===(t=e.org)||void 0===t?void 0:t.typeFamilies)}),[null===b||void 0===b||null===(t=b.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.typeFamilies]),{t:v}=(0,y.$G)(),x=(0,_.jsxs)(_.Fragment,{children:[c===S.Z.ADD_TILE&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(Br,{tomeId:i.id,maxHeight:d,onTileDragStart:p,onTileDragEnd:u})}),c===S.Z.RECORD&&s&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(Qr,{videoStatus:null===(n=s.overlay)||void 0===n?void 0:n.videoStatus,tomeId:i.id,pageId:s.id,videoId:null===(r=s.overlay)||void 0===r?void 0:r.videoId})}),c===S.Z.CUSTOMIZE&&s&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(ma,{nonTileSidebarRef:f,tomeId:i.id,pageId:s.id,pageTheme:s.theme,tomeTheme:i.theme,fontData:C})}),c===S.Z.ANNOTATION&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(dr,{tomeId:i.id,annotations:s.tiles.flatMap((e=>e.annotations)).filter((e=>!!e))})})]});let O=c;return c===S.Z.RECORD?O=v("sidebar.nonTileSidebar.record"):c===S.Z.CUSTOMIZE?O=v("sidebar.nonTileSidebar.setTheme"):c===S.Z.ANNOTATION&&(O=v(null!==h?"sidebar.nonTileSidebar.editAnnotation":"sidebar.nonTileSidebar.addAnnotation")),(0,_.jsx)(Wt,{ref:f,hasHeader:c!==S.Z.ADD_TILE,headerText:`${v("sidebar.header",{header:O})}`,contentNoPadding:!0,panelContent:x,draggable:m,startDrag:g})},ha=o(86760);function fa(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ba(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?fa(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):fa(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ya=(0,b.ZP)(f.animated.div).withConfig({displayName:"PropertyPanel__PanelContainer",componentId:"sc-1lja238-0"})(["width:","px;display:flex;align-items:center;position:absolute;top:50%;translate:0 calc(-50% - ","px);right:","px;cursor:default;"," transition:opacity 0.1s ease-in;will-change:transition,transform,opacity;"],(e=>e.$width),(e=>e.theme.headerHeight/2),(e=>e.$toolbarWidth+e.theme.panelSpacing),(e=>{let{$draggablePanelsFlag:t}=e;return t&&`z-index: ${T.IT};`})),Ca=(0,b.ZP)(d.E.div).withConfig({displayName:"PropertyPanel__PanelStyles",componentId:"sc-1lja238-1"})(["margin-right:","px;padding:0;border-radius:16px;z-index:",";width:240px;height:fit-content;background:",";box-shadow:",";",""],(e=>e.theme.panelSpacing),T.Mf,(e=>e.theme.colors.sidebar),(e=>e.theme.colors.panelBoxShadow),ha.Z),va=[S.Z.TILE,S.Z.COLOR_PICKER,S.Z.TEXT_COLOR_PICKER,S.Z.IMAGE_GENERATION_HISTORY,S.Z.IMAGE_EDIT,S.Z.IMAGE_CREATE],xa=(0,a.forwardRef)(((e,t)=>{let{tome:o,width:n,toolbarWidth:r,height:i,style:s}=e;const d=(0,b.Fg)(),p=(0,l.sJ)(V.Vx),u=(0,B.yW)(o.pages,p),m=(0,c.l)(V.Dm),g=(0,G.Z)(m),{0:h,1:f}=(0,a.useState)(!1),{0:y,1:C}=(0,a.useState)({top:0,bottom:0,left:0,right:0}),v=(0,I.f3)(),x=(0,I.t2)(),{propertyPanelRef:O}=(0,H.TR)(),{width:P=0,height:w=0}=(0,F.Z)(),j=(0,a.useCallback)((()=>{var e;const t=null===(e=O.current)||void 0===e?void 0:e.getBoundingClientRect();t&&C({top:12-t.top,left:12-t.left,right:P-(t.left+t.width)-12,bottom:w-(t.top+t.height)-12})}),[O,w,P]);(0,N.Z)({ref:O,onResize:()=>{j()}});const T=(0,l.sJ)(V.uz),E=(0,a.useCallback)((()=>{T()}),[T]);(0,a.useEffect)((()=>{j()}),[w,P,m,j]);const k=(0,a.useCallback)((()=>{j()}),[j]);(0,a.useImperativeHandle)(t,(()=>({triggerReMeasure:k})));const Z=(0,$.ye)($.TT.DRAGGABLE_PANELS),D=(0,A.o)(),M=(0,L.E)(),R=(0,a.useCallback)((e=>D.start(e)),[D]),z=(0,a.useCallback)((()=>{f(!0)}),[]),U=(0,a.useCallback)((e=>{let{dismiss:t=!1}=e;f(!1),t&&x.closePropertyPanel()}),[x]),W=(0,a.useCallback)((()=>{M.set({x:0,y:0})}),[M]);if((0,a.useEffect)((()=>{g&&m!==g&&W()}),[g,m,W]),!v)return null;const q=Z,K=v!==S.Z.ADD_TILE,Y=i-2*d.headerHeight-32-43*(K?1:0),J=va.includes(v)?(0,_.jsx)(Hn,{tomeId:o.id,currentPanel:v,draggable:q,startDrag:q?R:void 0}):(0,_.jsx)(ga,{tome:o,page:u,currentPanel:v,maxHeight:Y,draggable:q,startDrag:q?R:void 0,onTileDragStart:z,onTileDragEnd:U});return(0,_.jsx)(ya,{style:ba(ba({},s),h?{opacity:0,pointerEvents:"none"}:{opacity:1}),$width:n,$toolbarWidth:r,"data-testid":"property_panel_container",onClick:E,$draggablePanelsFlag:Z,children:q?(0,_.jsx)(Ca,{drag:!0,dragListener:!1,dragMomentum:!1,animate:M,dragControls:D,dragElastic:.1,dragConstraints:y,ref:O,children:J},v):(0,_.jsx)(Ca,{ref:O,children:J})})}));var Oa=xa,Pa=o(57819),wa=o(22817);var ja=e=>{let{tomeId:t}=e;const{apolloClient:o,clientId:n}=(0,H.bp)(),{user:r,loading:i,error:l}=(0,a.useContext)(xr.Z),c=!i&&!l&&!!r,d=(0,a.useRef)(),p=(0,a.useRef)();return(0,a.useEffect)((()=>(c&&p.current!==t&&(p.current&&d.current&&d.current.unsubscribe(),d.current=function(e,t,o){return e.subscribe({query:U.e9Y,variables:{tomeId:t,clientId:o}}).subscribe({next(t){let{data:o}=t;if(o&&o.tomeEdit)switch(o.tomeEdit.type){case U._tx.Generic:{const{edit:t}=o.tomeEdit;(0,ji.Bw)(t,e.cache);break}case U._tx.CreateComment:{const{comment:t}=o.tomeEdit;(0,Pa.I0)(e.cache,t);break}case U._tx.UpdateComment:{const{comment:t}=o.tomeEdit;(0,Pa.QA)(e.cache,t);break}case U._tx.DeleteComment:{const{comment:t}=o.tomeEdit;(0,Pa.PS)(e.cache,t);break}case U._tx.Presence:{const t=o.tomeEdit;wa.z.updateTomePresenceWithPresenceEdit(e.cache,t),wa.z.updatePagePresenceWithPresenceEdit(e.cache,t);break}default:s.v.addError(new Error(`Unknown edit type: ${o.tomeEdit.type}`),{edit:o.tomeEdit})}else s.v.addError(new Error("No tomeEdit data in subscription"),{data:o})},error(e){console.error("err",e),s.v.addError(e)}})}(o,t,n),p.current=t),()=>{d.current&&(d.current.unsubscribe(),d.current=void 0,p.current=void 0)})),[o,t,n,c]),null},Ta=o(3853),Ea=o(57142),Ia=o(86781);var Sa=e=>{const[t,o]=(0,l.FV)(V.Vx),n=(0,B.xh)(e,t),r=n>0,i=n<e.length-1,s=(0,a.useCallback)((()=>{i&&o(e[n+1].id)}),[n,i,e,o]),c=(0,a.useCallback)((()=>{r&&o(e[n-1].id)}),[n,r,e,o]);return(0,a.useMemo)((()=>({hasPrevPage:r,hasNextPage:i,nextPage:s,prevPage:c})),[i,r,s,c])};var _a=e=>{let{timeout:t,visibilityBasedOnMouseEvent:o,disabled:n}=e;const r=(0,a.useRef)(),{0:i,1:l}=(0,a.useState)(!1),s=(0,a.useCallback)((()=>l(!1)),[l]),c=(0,a.useCallback)((()=>l(!0)),[l]),d=(0,a.useCallback)((()=>{r.current=setTimeout((()=>{c()}),t)}),[t,r,c]),p=(0,a.useCallback)((()=>{r.current&&clearTimeout(r.current),s()}),[r,s]),u=(0,a.useCallback)((()=>{n||(r.current&&clearTimeout(r.current),d())}),[n,d]),m=(0,a.useCallback)((e=>{o(e)?p():u()}),[o,p,u]);return(0,a.useEffect)((()=>(n?(r.current&&clearTimeout(r.current),document.removeEventListener("mousemove",m)):(document.addEventListener("mousemove",m),d()),()=>{r.current&&clearTimeout(r.current),document.removeEventListener("mousemove",m)})),[n,r,m,d]),{isHidden:i,show:s,hide:c}};function ka(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Za(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ka(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Da=(0,b.ZP)(d.E.div).withConfig({displayName:"FooterNavigation__FooterWrapper",componentId:"oll5g3-0"})(["height:","px;position:fixed;bottom:0;width:100%;display:flex;align-items:center;justify-content:space-between;padding:","px;margin-bottom:","px;"],40,16,16),Ma=(0,b.ZP)(Ve.Z).withConfig({displayName:"FooterNavigation__FooterNavButton",componentId:"oll5g3-1"})(["width:","px;height:","px;"],40,40);var Ra=e=>{let{pages:t,isFullscreen:o}=e;const n=(0,a.useRef)(null),{currentPageRef:r}=(0,H.TR)(),i=(0,l.sJ)(j.wo),{0:s,1:c}=(0,a.useState)(!1),{0:d,1:u}=(0,a.useState)(!1),{hasPrevPage:m,hasNextPage:g,prevPage:h,nextPage:f}=Sa(t),y=(0,b.Fg)(),C={width:y.largerIconSize,height:y.largerIconSize},v=(0,a.useCallback)((e=>{var t;if(!n.current)return!1;const o=n.current.getBoundingClientRect();if(e.clientY>=o.top)return u(!1),u(!1),!0;const i=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect();return e.clientX<(null===i||void 0===i?void 0:i.left)?(c(!0),!0):e.clientX>(null===i||void 0===i?void 0:i.right)?(u(!0),!0):(c(!1),u(!1),!1)}),[r]),{isHidden:x}=_a({visibilityBasedOnMouseEvent:v,timeout:3e3,disabled:o}),O=(0,a.useMemo)((()=>({animate:{opacity:t.length<2||x||o||i?0:1},transition:E.Z2,initial:{opacity:1},exit:{opacity:0}})),[t.length,x,o,i]);return(0,_.jsx)(p.M,{children:(0,_.jsxs)(Da,Za(Za({ref:n,"data-testid":"footer_navigation"},O),{},{children:[(0,_.jsx)(Ma,{variant:"text",disabled:!m,onClick:h,"aria-label":"Previous page",iconStyles:{margin:0,transform:s&&m?"translateX(-4px)":"none",transition:"transform 0.3s ease-out"},startIcon:(0,_.jsx)(Ea.Z,{style:C}),style:m?{}:{visibility:"hidden"}}),(0,_.jsx)(Ma,{variant:"text",disabled:!g,onClick:f,"aria-label":"Next page",iconStyles:{margin:0,transform:d&&g?"translateX(4px)":"none",transition:"transform 0.3s ease-out"},startIcon:(0,_.jsx)(Ia.Z,{style:C}),style:g?{}:{visibility:"hidden"}})]}))})},Aa=o(41664),La=o.n(Aa),Na=o(37982),Ha=o(52260),Va=o(87495),Ba=o(57451);function $a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Fa(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?$a(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):$a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Ga=b.ZP.div.withConfig({displayName:"PageProgressIndicator__IndicatorStyles",componentId:"ijfywb-0"})(["display:flex;flex-direction:row;align-items:center;justify-content:center;width:100%;"]),za=b.ZP.div.withConfig({displayName:"PageProgressIndicator__ProgressSegment",componentId:"ijfywb-1"})(["width:100%;height:2px;border-top-left-radius:",";border-bottom-left-radius:",";border-top-right-radius:",";border-bottom-right-radius:",";background-color:",";"],(e=>{let{$withLeftRadius:t}=e;return t?"4px":"0"}),(e=>{let{$withLeftRadius:t}=e;return t?"4px":"0"}),(e=>{let{$withRightRadius:t}=e;return t?"4px":"0"}),(e=>{let{$withRightRadius:t}=e;return t?"4px":"0"}),(e=>{let{$active:t,theme:o}=e;return t?o.colors.contrast60:o.colors.contrast16})),Ua=b.ZP.div.withConfig({displayName:"PageProgressIndicator__ProgressSegmentHover",componentId:"ijfywb-2"})(["width:",";margin-left:","px;",""],(e=>{let{$width:t}=e;return"number"===typeof t?`${t}px`:t}),(e=>{let{$space:t}=e;return t}),(e=>{let{$interactive:t,$active:o,theme:n}=e;return t&&(0,b.iv)(["cursor:pointer;padding:4px 0;&:hover ","{background-color:",";}"],za,o?n.colors.contrast60:n.colors.contrast25)}));var Wa=e=>{let{pageIds:t,maxComponentWidthPx:o,activePageId:n,onSegmentClick:r,isMobile:i,numPages:a}=e;const l=n?t.indexOf(n):-1;let s=40,c=3;(i||40*a+3*(a-1)>o)&&(s=(o-3*(a-1))/a,s<24&&(s=100/a+"%",c=0));const d=Array.from(Array(a).keys());return(0,_.jsx)(Ga,{"data-testid":`active_page_index_${l}`,"data-tome-bypass-tap-navigation":!0,children:(0,_.jsx)(ln.Z,{placement:"bottom",style:{width:"100%",justifyContent:"center"},children:d.map((e=>{const o=t[e]||`fake_page_id_${e}`,n=!t[e];return(0,_.jsx)(Ua,Fa(Fa({$active:e<=l,$width:s,$space:0===e?0:c,onClick:()=>{n||r(o)},$interactive:!i},i?{}:{renderTooltip:()=>`Page ${e+1} of ${a}`}),{},{children:(0,_.jsx)(za,{"data-testid":"progress_segment",$active:e<=l,$withLeftRadius:c>0||0===e,$withRightRadius:c>0||e===a-1})}),o)}))})})},qa=o(4832),Ka=o(60559);const Ya=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__HeaderLeft",componentId:"sc-883y9v-0"})(["display:flex;justify-content:flex-start;flex:1;min-width:calc(33% - ","px);margin-left:10px;overflow:hidden;pointer-events:none;"],(e=>{let{$gap:t}=e;return t})),Ja=b.ZP.div.withConfig({displayName:"Headerstyles__HeaderMiddle",componentId:"sc-883y9v-1"})(["display:flex;justify-content:center;overflow:hidden;flex:'initial';",""],(e=>{let{$presentMode:t,$gap:o}=e;return t&&(0,b.iv)(["flex:1;margin-left:","px;margin-right:","px;"],o,o)})),Xa=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__HeaderRight",componentId:"sc-883y9v-2"})(["position:relative;display:flex;justify-content:flex-end;flex:",";margin-right:10px;overflow:hidden;min-width:","px;"],(e=>{let{$presentMode:t}=e;return t?"1":"0 0 auto"}),205),Qa=b.ZP.div.withConfig({displayName:"Headerstyles__HeaderWrapper",componentId:"sc-883y9v-3"})(["z-index:",";pointer-events:none;&::before{background-image:",";content:'';height:","px;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1;opacity:",";transition:opacity 0.3s ease;}"],T.bf,(e=>{let{$presentMode:t,theme:o}=e;return t?o.gradients.headerGradientPresent:o.gradients.headerGradient}),Ka.Zk,(e=>{let{$showScrim:t}=e;return t?1:0})),el=b.ZP.div.withConfig({displayName:"Headerstyles__Header",componentId:"sc-883y9v-4"})(["display:flex;width:100%;z-index:",";cursor:default;height:","px;position:relative;color:",";"," *,"," *,"," *{pointer-events:",";}"],T.bf,(e=>{let{theme:t}=e;return t.headerHeight}),(e=>{let{theme:t}=e;return t.colors.contrast}),Ya,Ja,Xa,(e=>{let{$pointerEventsEnabled:t}=e;return t?"all":"none"})),tl=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__HeaderComponent",componentId:"sc-883y9v-5"})(["display:flex;flex-direction:row;align-items:center;justify-content:center;position:relative;height:","px;"],(e=>{let{theme:t}=e;return t.headerHeight})),ol=(0,b.ZP)(tl).withConfig({displayName:"Headerstyles__HeaderRightHeaderComponent",componentId:"sc-883y9v-6"})(["margin-left:8px;"]),nl=(0,b.ZP)(Ve.Z).attrs((e=>({variant:"text",opacity:e.theme.opacity.headerButtonText,iconOpacity:e.theme.opacity.headerButtonIcons}))).withConfig({displayName:"Headerstyles__HeaderButton",componentId:"sc-883y9v-7"})(["height:32px;width:40px;pointer-events:all;"]),rl=(0,b.ZP)(d.E.div).withConfig({displayName:"Headerstyles__Transition",componentId:"sc-883y9v-8"})(["position:absolute;left:0;top:0;"]),il=b.ZP.div.withConfig({displayName:"MobileHeader__MobileHeaderStyles",componentId:"sc-1pm5ycw-0"})(["position:fixed;width:100%;z-index:",";"],T.bf),al=b.ZP.div.withConfig({displayName:"MobileHeader__PageProgressIndicatorStyles",componentId:"sc-1pm5ycw-1"})(["padding:8px ","px 0;width:100%;"],24),ll=(0,b.ZP)(d.E.div).withConfig({displayName:"MobileHeader__AttributionRow",componentId:"sc-1pm5ycw-2"})(["display:flex;width:100%;padding:0 ","px;justify-content:space-between;"],24),sl=b.ZP.div.withConfig({displayName:"MobileHeader__AttributionLeft",componentId:"sc-1pm5ycw-3"})(["display:flex;align-items:center;flex:1;overflow-x:hidden;"]),cl=b.ZP.div.withConfig({displayName:"MobileHeader__AttributionRight",componentId:"sc-1pm5ycw-4"})(["display:flex;margin-left:12px;align-items:center;color:",";"],(e=>{let{theme:t}=e;return t.colors.headerLogo})),dl=b.ZP.span.withConfig({displayName:"MobileHeader__ButtonInner",componentId:"sc-1pm5ycw-5"})(["display:flex;align-items:center;"]);var pl=e=>{var t,o,n;let{isInExpandMode:r,tome:i,className:s}=e;const c=(0,Ba.Z)(),{workspaceUrl:d,apolloClient:p}=(0,H.bp)(),[u,m]=(0,l.FV)(V.Vx),g=(0,l.sJ)(Ha.R),h=(0,l.sJ)(V.SM),{user:f,loading:b}=(0,a.useContext)(xr.Z),C=!(!f||!f.id),v=(0,B.yW)(i.pages,u),{t:x}=(0,y.$G)(),O=(0,a.useCallback)((()=>{We.ZP.reportTryTomeClickEvent({apolloClient:p,tomeId:i.id,pageId:u})}),[i,u,p]),P=(0,Va.iR)(void 0,"/signup",{utmMedium:"referral",utmSource:h?"public_tome_embedded":"public_tome",utmCampaign:i.id,utmContent:"public_tome_logo"}),w=(0,qa.I)(null===i||void 0===i||null===(t=i.org)||void 0===t?void 0:t.logo),j=(null===(o=i.org)||void 0===o?void 0:o.showTomeBranding)??!0,T=c?window.innerWidth:400;return(0,a.useEffect)((()=>{document.body.style.setProperty("--mobile-header-top-padding",g?"52px":"10px")}),[g]),(0,_.jsxs)(il,{className:s,children:[i.pages.length>1&&!r&&(0,_.jsx)(al,{children:(0,_.jsx)(Wa,{pageIds:i.pages.map((e=>e.id)),activePageId:u,onSegmentClick:m,maxComponentWidthPx:T-48,isMobile:!0,numPages:i.numPages})}),!r&&(0,_.jsxs)(ll,{animate:{height:g?52:0,opacity:g?1:0},initial:{height:g?52:0,opacity:g?1:0},transition:E.Z2,"data-testid":"mobile_header_attribution",style:{pointerEvents:g?"auto":"none"},children:[(0,_.jsx)(sl,{children:w&&(0,_.jsx)(qa.Z,{show:i.showLogo,logo:null===(n=i.org)||void 0===n?void 0:n.logo,theme:v.theme})}),!b&&(0,_.jsxs)(cl,{"data-tome-bypass-tap-navigation":"MobileHeader__AttributionRight",children:[C&&(0,_.jsx)(La(),{href:d,children:(0,_.jsx)(Na.Z,{style:{height:24,width:24,opacity:.8}})}),!C&&j&&(0,_.jsx)(La(),{href:P,children:(0,_.jsxs)(nl,{onClick:O,variant:"text",style:{width:"unset",padding:"0px"},children:[(0,_.jsx)(Na.Z,{style:{height:18,width:18}}),(0,_.jsxs)(dl,{children:["\xa0",x("tome.header.mobileHeader.tryTomeButtonLabel")]})]})})]})]})]})},ul=o(30587),ml=o(16320);const gl=b.ZP.span.withConfig({displayName:"BadgeChip__StyledComponent",componentId:"nuq6re-0"})(["position:relative;"]),hl=b.ZP.span.withConfig({displayName:"BadgeChip__BadgeIcon",componentId:"nuq6re-1"})(["display:flex;align-items:center;& > svg{height:14px;width:14px;}"]),fl=b.ZP.span.withConfig({displayName:"BadgeChip__BadgeChildren",componentId:"nuq6re-2"})(["display:flex;"]),bl=b.ZP.span.withConfig({displayName:"BadgeChip__BadgeDisplay",componentId:"nuq6re-3"})(["display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;align-content:center;align-items:center;box-sizing:border-box;z-index:1;border-radius:",";font-size:",";font-weight:400;height:22px;min-width:20px;padding:12px;background-color:",";color:",";"],(e=>{let{theme:t}=e;return t.borderRadius.xs}),(e=>{let{theme:t}=e;return t.fontSizes.sm}),(e=>{let{color:t,theme:o}=e;return"destructive"===t?o.colors.redBadgeBackground:"inherit"}),(e=>{let{color:t,theme:o}=e;return"destructive"===t?o.colors.redBadge:"inherit"}));var yl=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(gl,{as:e.component,ref:t,children:(0,_.jsx)(ln.Z,{content:e.toolTipContent,placement:"bottom",perpendicularOffset:-20,children:(0,_.jsxs)(bl,{color:e.color,children:[(0,_.jsx)(hl,{children:e.icon}),(0,_.jsx)(fl,{children:e.children})]})})}))),Cl=o(1653),vl=o(47901),xl=o(76661);var Ol=xl.Ps`
  mutation CREATE_PERMISSION_MUTATION(
    $id: String!
    $tomeId: String!
    $email: String!
    $role: TomeRole!
  ) {
    createPermissionWithUser(
      input: { id: $id, tomeId: $tomeId, email: $email, role: $role }
    ) {
      ... on Permission {
        ...PermissionFragment
      }
      ... on PermissionError {
        message
      }
    }
  }
  ${U.VJv}
`;var Pl=xl.Ps`
  mutation DELETE_PERMISSION_MUTATION($id: String!) {
    deletePermission(input: { id: $id }) {
      ... on PermissionSuccess {
        id
        tome {
          id
        }
      }
      ... on PermissionError {
        message
      }
    }
  }
`;var wl=xl.Ps`
  mutation UPDATE_PERMISSION_MUTATION($id: String!, $role: TomeRole!) {
    updatePermission(input: { id: $id, role: $role }) {
      ... on Permission {
        ...PermissionFragment
      }
      ... on PermissionError {
        message
      }
    }
  }
  ${U.VJv}
`;function jl(e,t,o){const n=e.writeFragment({id:`Permission:${t.id}`,fragment:U.VJv,data:t,fragmentName:"PermissionFragment"});e.modify({id:e.identify(o),fields:{permissions:e=>e.every((e=>e.__ref!==(null===n||void 0===n?void 0:n.__ref)))?[...e,n]:e}})}function Tl(e){const{__typename:t,message:o}=e;return!("PermissionError"!==t||!o)&&((0,V.ak)({message:o}),!0)}const El={value:"NONE",label:"No access"},Il={value:"VIEWER",label:"Can play",description:"Tome opens in present mode for visitors"},Sl=[Il,{value:"COMMENTER",label:"Can comment"},{value:"EDITOR",label:"Can edit"},{value:"FULL",label:"Full access"}],_l=[El,...Sl],kl=[El,Il];var Zl=o(48811);function Dl(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ml(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Dl(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Rl=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,Ml(Ml({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M8.80235 18.5039C8.94529 18.2101 9.33262 18.161 9.56361 18.392L21.8601 30.6886C22.0473 30.8757 22.0562 31.1764 21.8803 31.3743L9.46525 45.3412C9.23616 45.5989 8.82154 45.5521 8.68189 45.2369C8.24352 44.2472 8 43.1521 8 42V22C8 20.7464 8.28835 19.5601 8.80235 18.5039Z"}),(0,_.jsx)("path",{d:"M12.2693 49.0787C11.9958 48.9342 11.9445 48.5728 12.15 48.3416L24.6745 34.2516C24.8656 34.0366 25.1983 34.0268 25.4018 34.2302L27.7574 36.5858C30.1005 38.9289 33.8995 38.9289 36.2426 36.5858L38.5982 34.2302C38.8017 34.0268 39.1344 34.0366 39.3255 34.2516L51.85 48.3416C52.0555 48.5728 52.0042 48.9342 51.7307 49.0787C50.6168 49.6669 49.3473 50 48 50H16C14.6527 50 13.3832 49.6669 12.2693 49.0787Z"}),(0,_.jsx)("path",{d:"M54.5348 45.3412C54.7638 45.5989 55.1785 45.5521 55.3181 45.2369C55.7565 44.2472 56 43.1521 56 42V22C56 20.7464 55.7116 19.5601 55.1977 18.5039C55.0547 18.2101 54.6674 18.161 54.4364 18.392L42.1399 30.6886C41.9527 30.8757 41.9438 31.1764 42.1197 31.3743L54.5348 45.3412Z"}),(0,_.jsx)("path",{d:"M12.392 15.5636C12.161 15.3326 12.2101 14.9453 12.5039 14.8024C13.5601 14.2884 14.7464 14 16 14H48C49.2536 14 50.4399 14.2884 51.4961 14.8023C51.7899 14.9453 51.839 15.3326 51.608 15.5636L33.4142 33.7574C32.6332 34.5384 31.3668 34.5384 30.5858 33.7574L12.392 15.5636Z"})]}))));const Al=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__Wrapper",componentId:"tr8c03-0"})(["display:flex;flex-direction:row;align-items:center;height:32px;.control{margin-left:auto;}"]),Ll=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__IconStyles",componentId:"tr8c03-1"})(["svg{flex-shrink:0;}"]),Nl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItem",componentId:"tr8c03-2"})(["margin:0;padding-left:8px;flex-grow:1;display:flex;align-items:baseline;overflow:hidden;"]),Hl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItemHeading",componentId:"tr8c03-3"})(["font-size:",";font-weight:400;line-height:17px;",""],(e=>{let{theme:t}=e;return t.fontSizes.sm}),si.wR),Vl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItemPending",componentId:"tr8c03-4"})(["color:",";font-size:",";padding:0 0.5em;"],(e=>{let{theme:t}=e;return t.colors.contrast40}),(e=>{let{theme:t}=e;return t.fontSizes.sm})),Bl=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__MenuItemGuest",componentId:"tr8c03-5"})(["color:",";font-size:",";padding:0 0.5em;"],(e=>{let{theme:t}=e;return t.colors.guestBadgeText}),(e=>{let{theme:t}=e;return t.fontSizes.sm})),$l=b.ZP.div.withConfig({displayName:"SharingSheetRowstyles__OwnerLabel",componentId:"tr8c03-6"})(["font-size:13px;min-height:28px;line-height:16px;height:28px;padding:6px 8px;color:",";"],(e=>{let{theme:t}=e;return t.colors.ownerBadgeText}));function Fl(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Gl(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Fl(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Fl(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var zl=e=>{let{icon:t,heading:o,disabled:n,handler:r=(()=>{}),currentValue:i="",options:a=[],pending:l=!1,guest:s=!1}=e;const c=(0,b.Fg)(),{t:d}=(0,y.$G)(),p={control:(e,t)=>Gl(Gl({},e),{},{flexWrap:"nowrap",width:t.selectProps.controlWidth,boxSizing:"border-box",border:0,borderRadius:"6px",boxShadow:"none",fontSize:"13px",lineHeight:"16px",height:"28px",minHeight:"28px",padding:"6px 8px",color:t.isDisabled?c.colors.contrast20:c.colors.secondaryUiText,"&:hover":{backgroundColor:c.colors.menuControlHover},backgroundColor:c.colors.sheetBg,cursor:"pointer",whiteSpace:"nowrap"}),dropdownIndicator:(e,t)=>Gl(Gl({},e),{},{paddingRight:0,paddingTop:"3px",paddingBottom:"3px",paddingLeft:"6px",color:t.isDisabled?c.colors.contrast20:"currentColor"}),group:()=>({borderTop:`1px solid ${c.colors.contrast8}`}),indicatorsContainer:(e,t)=>Gl(Gl({},e),{},{height:"16px",padding:"0",margin:0,display:t.isDisabled?"none":"block",stroke:c.colors.secondaryUiText}),singleValue:()=>({display:"flex",flexShrink:0}),valueContainer:e=>Gl(Gl({},e),{},{padding:0,flexWrap:"nowrap"}),menu:(e,t)=>Gl(Gl({},e),{},{width:t.selectProps.menuWidth,fontSize:"13px",lineHeight:"16px",marginTop:"-28px",padding:"6px",color:c.colors.secondaryUiText,backgroundColor:c.colors.menuBackgroundLayer[0],right:0})},u=(0,_.jsx)(je,{onChange:r,handler:r,styles:p,options:a,disabled:n,currentValue:i??"",menuWidth:"156px",backgroundColor:c.colors.transparent});return(0,_.jsxs)(Al,{children:[(0,_.jsx)(Ll,{children:t}),(0,_.jsxs)(Nl,{children:[(0,_.jsx)(Hl,{title:o,children:o}),l&&(0,_.jsx)(Vl,{children:d("tome.sharingSheetRow.pendingUserMenuItemLabel")}),s&&!l&&(0,_.jsx)(Bl,{children:d("tome.sharingSheetRow.guestUserMenuItemLabel")})]}),u]})};const Ul=b.ZP.div.withConfig({displayName:"SharingSheetstyles__SharingSheetWrapper",componentId:"sc-19huyep-0"})(["cursor:default;position:absolute;top:","px;right:12px;pointer-events:auto;color:",";> div{background:",";box-shadow:",";width:360px;border-radius:18px;padding:6px 12px 12px 12px;}z-index:",";"],(e=>e.theme.headerHeight),(e=>e.theme.colors.primaryUiText),(e=>{let{theme:t}=e;return t.colors.sheetBg}),(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow}),T.Ue),Wl=b.ZP.div.withConfig({displayName:"SharingSheetstyles__SharingSheetIconWrap",componentId:"sc-19huyep-1"})(["height:20px;width:20px;background-color:",";border-radius:10px;overflow:hidden;display:flex;& ","{height:16px;margin:2px;opacity:0.5;}"],(e=>{let{theme:t}=e;return t.colors.iconBg}),Te.K),ql=b.ZP.hr.withConfig({displayName:"SharingSheetstyles__SharingSheetSeparator",componentId:"sc-19huyep-2"})(["border:0;height:1px;margin:4px 0;background-color:",";"],(e=>{let{theme:t}=e;return t.colors.separator}));var Kl=e=>{var t;let{tome:o}=e;const{apolloClient:n}=(0,H.bp)(),{data:r}=(0,U.BYn)({variables:{id:o.id},fetchPolicy:"cache-and-network"}),i=(0,b.Fg)(),{t:a}=(0,y.$G)(),{canManage:l}=o.currentUserPermission,s=(e,t)=>{"remove"===t?function(e,t){e.mutate({mutation:Pl,variables:{id:t},update(e,t){let{data:{deletePermission:o}}=t;Tl(o)||function(e,t){e.modify({id:`Tome:${t.tome.id}`,fields:{permissions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{readField:o}=arguments.length>1?arguments[1]:void 0;return e.filter((e=>t.id!==o("id",e)))}}})}(e,o)}})}(n,e):function(e,t,o){e.mutate({mutation:wl,variables:{id:t,role:o},update(e,t){let{data:{updatePermission:o}}=t;Tl(o)||function(e,t){e.modify({id:e.identify(t),fields:{role:e=>t.role??e}})}(e,o)}})}(n,e,t)};return(0,_.jsx)(_.Fragment,{children:null===r||void 0===r||null===(t=r.tome)||void 0===t?void 0:t.permissions.map((e=>(0,_.jsx)(zl,{handler:t=>s(e.id,t),icon:e.user.pending?(0,_.jsx)(Wl,{children:(0,_.jsx)(Rl,{})}):(0,_.jsx)(Zl.Z,{user:e.user,size:20}),pending:e.user.pending,guest:e.isGuest||!1,currentValue:e.role,heading:e.user.name||e.user.email,options:[...Sl,{options:[{label:a("tome.sharingSheetIndividuals.removeAccessLabel"),value:"remove",color:i.colors.red,colorHover:i.colors.contrast,backgroundColorHover:i.colors.red}]}],disabled:!l},e.user.id)))})},Yl=o(1027);var Jl=e=>{const{items:t,isMenuOpen:o,onDismiss:n}=e,{0:r,1:i}=(0,a.useState)(0),l=(0,a.useCallback)((e=>r===e),[r]),s=(0,a.useCallback)((e=>{i(e)}),[i]),c=(0,a.useCallback)((e=>{if(!o)return;e.preventDefault();let n=r+1;for(;n<t.length;){const e=t[n],{type:o="option",disabled:r}=e;if(!r&&"option"===o)break;n+=1}n!==t.length&&i(n)}),[r,i,t]),d=(0,a.useCallback)((e=>{if(!o)return;e.preventDefault();let n=r-1;for(;n>=0;){const e=t[n],{type:o="option",disabled:r}=e;if(!r&&"option"===o)break;n-=1}n<0||i(n)}),[r,i,t]),p=(0,a.useCallback)((e=>{var n,i;t.length>0&&o&&(null===(n=t[r])||void 0===n||null===(i=n.action)||void 0===i||i.call(n),e.preventDefault())}),[t,r]),u=(0,a.useCallback)((e=>{o&&(i(0),e.preventDefault()),n()}),[n,i]),m=(0,a.useCallback)((e=>{"ArrowDown"===e.key?c(e):"ArrowUp"===e.key?d(e):"Enter"===e.key?p(e):"Escape"===e.key&&u(e)}),[c,d,p,u]);return(0,a.useMemo)((()=>({isIndexSelected:l,setIndex:s,onKeyPress:m})),[l,s,m])},Xl=o(9517);const Ql=b.ZP.div.withConfig({displayName:"SharingSheetInvitestyles__MenuWrapper",componentId:"obue3a-0"})(["position:absolute;left:","px;top:","px;z-index:",";"],(e=>e.$left),(e=>e.$top),T.m6),es=b.ZP.form.withConfig({displayName:"SharingSheetInvitestyles__Form",componentId:"obue3a-1"})(["display:flex;margin:7px 0px;input{background:",";margin:0;border-top-right-radius:0;border-bottom-right-radius:0;padding:0px 12px;height:28px;min-height:28px;}> div{margin:0;display:box;width:200px;> div[class*='control']{padding-top:1px;height:28px;background:",";border-radius:0 "," "," 0;> div:first-child{height:28px;padding:0;> div{text-align:right;width:100%;flex:none;}}}> div[class*='menu']{margin-top:8px;width:200px;right:0;}}"],(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.colors.inputBg}),(e=>{let{theme:t}=e;return t.borderRadius.sm}),(e=>{let{theme:t}=e;return t.borderRadius.sm}));function ts(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function os(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ts(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var ns=e=>{var t,o;let{tome:n}=e;const r=(0,a.useRef)(null),{0:i,1:l}=(0,a.useState)(""),{0:s,1:c}=(0,a.useState)(U.yrp.Full),d=(0,b.Fg)(),{t:p}=(0,y.$G)(),{0:u,1:m}=(0,a.useState)(!1),{data:g,loading:h}=(0,U.vj0)(),{apolloClient:f}=(0,H.bp)(),{user:C,flags:v,loading:x}=(0,a.useContext)(xr.Z);let O=[];h||x||null===g||void 0===g||null===(t=g.me)||void 0===t||null===(o=t.org)||void 0===o||!o.members||(O=function(e){let{tome:t,members:o,value:n,currentUser:r}=e;return o.filter((e=>{var o;return(null===(o=e.name)||void 0===o?void 0:o.toLowerCase().startsWith(n.toLowerCase()))&&!t.permissions.some((t=>t.user.id===e.id))&&e.id!==(null===r||void 0===r?void 0:r.id)&&e.id!==t.author.id}))}({tome:n,members:g.me.org.members.map((e=>{let{user:t}=e;return t})),value:i,currentUser:C}));const P=Yl.G(i),w=P&&0===O.length,{data:j,loading:T}=(0,U.v7f)({skip:!w,variables:{email:i},fetchPolicy:"no-cache"});if(!T&&null!==j&&void 0!==j&&j.user&&O.push(j.user),0===O.length&&P&&null!==v&&void 0!==v&&v.externalSharing){const e={id:"pending",name:i,email:i,pending:!0,profileImage:null,__typename:"User"};O.push(e)}let E,I;if(r.current){const e=r.current;E=e.offsetTop+e.offsetHeight+6,I=e.offsetLeft}const S=!h&&i.length>0&&O.length>0&&!u&&!!r.current,k=(0,a.useCallback)((()=>{S?m(!0):r.current&&(r.current.value="")}),[S,m,r]),Z=e=>{!function(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=Pi()();e.mutate({mutation:Ol,variables:{id:i,tomeId:t.id,role:n,email:o.email},optimisticResponse:()=>({createPermissionWithUser:{__typename:"Permission",id:i,user:o,tome:t,role:n,isGuest:r}}),update(e,o){let{data:{createPermissionWithUser:n}}=o;Tl(n)||jl(e,n,t)}})}(f,n,e,s),r.current&&(r.current.value=""),m(!0)},D=O.map((e=>({text:e.name||"",image:e.profileImage&&(0,_.jsx)(Zl.Z,{user:e,size:20,delayMs:0,style:{marginRight:8}})||e.pending&&(0,_.jsx)(Rl,{style:{width:20,height:20,marginRight:8}})||void 0,action:()=>{Z(e)},id:e.id}))),{isIndexSelected:M,onKeyPress:R,setIndex:A}=Jl({items:D,isMenuOpen:S,onDismiss:k}),L=(0,a.useCallback)((e=>os(os({},e),{},{onMouseEnter:()=>{A(e.index)}})),[A]);const N={control:(e,t)=>os(os({},e),{},{width:t.selectProps.controlWidth,border:0,boxShadow:"none",fontSize:"13px",height:"28px",minHeight:"28px",lineHeight:"16px",paddingLeft:"4px",color:d.colors.secondaryUiText,cursor:"pointer","&:hover":{}}),singleValue:()=>({color:d.colors.secondaryUiText}),indicatorsContainer:()=>({stroke:d.colors.secondaryUiText}),dropdownIndicator:e=>{let{display:t}=e;return{display:t,padding:"8px 8px 8px 6px"}}};return(0,a.useEffect)((()=>()=>{(0,V.ii)(!1)}),[]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(es,{onSubmit:e=>{e.preventDefault()},children:[(0,_.jsx)(te.Z,{ref:r,placeholder:p("tome.sharingSheetInvite.enterEmailsOrNamesPlaceholderText"),onChange:e=>{l(e.target.value),m(!1),A(0)},onKeyDown:R,onFocus:()=>{(0,V.ii)(!0)},onBlur:()=>{(0,V.ii)(!1)}}),(0,_.jsx)(je,{onChange:c,onFocus:function(){m(!0)},onBlur:function(){m(!1)},styles:N,currentValue:s,options:Sl})]}),S&&(0,_.jsx)(Ql,{$left:I,$top:E,children:(0,_.jsx)(Xl.ZP,{items:D,width:316,isIndexSelected:M,getItemProps:L})})]})},rs=o(39225),is=o(30362);function as(e){let{tome:t,sameOrg:o}=e;const{apolloClient:n,clientId:r}=(0,H.bp)(),i=t.org;if(!i)return null;const{canManage:a}=t.currentUserPermission,l=!a||!o,s=(0,_.jsx)(Wl,{children:(0,_.jsx)(is.Z,{})});return(0,_.jsx)(zl,{heading:i.name,currentValue:t.orgScope,icon:s,disabled:l,handler:e=>{const o={};o.orgScope="NONE"===e?null:e,(0,rs.W8)(t.id,o,n,r)},options:_l})}var ls=e=>{let{owner:t}=e;const{t:o}=(0,y.$G)();return(0,_.jsxs)(Al,{children:[(0,_.jsx)(Ll,{children:(0,_.jsx)(Zl.Z,{user:t,size:20})}),(0,_.jsx)(Nl,{children:(0,_.jsx)(Hl,{title:o("tome.ownerRow.OwnerLabel"),children:t.name??o("tome.ownerRow.unknownOwnerName")})}),(0,_.jsx)($l,{children:o("tome.ownerRow.OwnerLabel")})]})},ss=o(80308);var cs=e=>{let{tome:t,publicSharing:o}=e;const{t:n}=(0,y.$G)(),{canManage:r}=t.currentUserPermission,{apolloClient:i,clientId:a}=(0,H.bp)();return(0,_.jsx)(zl,{icon:(0,_.jsx)(Wl,{children:(0,_.jsx)(ss.Z,{})}),handler:e=>{const o={};o.publicScope="NONE"===e?null:e,(0,rs.W8)(t.id,o,i,a)},options:kl,heading:n("tome.shareSheetPublic.anyoneWithTheLinkCanViewTomeLabel"),disabled:!r||!o,currentValue:t.publicScope})};function ds(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ps(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ds(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ds(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var us=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,ps(ps({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0209 16.0209C12.0209 13.8118 13.8117 12.0209 16.0209 12.0209H20.0209C22.23 12.0209 24.0209 13.8118 24.0209 16.0209V20.0209C24.0209 22.23 22.23 24.0209 20.0209 24.0209H16.0209H16.0209C13.8117 24.0209 12.0209 22.23 12.0209 20.0209V16.0209ZM16.0209 19.0209C16.0209 19.5732 16.4686 20.0209 17.0209 20.0209H19.0209C19.5732 20.0209 20.0209 19.5732 20.0209 19.0209V17.0209C20.0209 16.4686 19.5732 16.0209 19.0209 16.0209H17.0209C16.4686 16.0209 16.0209 16.4686 16.0209 17.0209V19.0209ZM14.0209 32.0209H15.5209C15.797 32.0209 16.0209 31.797 16.0209 31.5209V30.0209C16.0209 28.9163 16.9163 28.0209 18.0209 28.0209C19.1254 28.0209 20.0209 28.9163 20.0209 30.0209V31.5209C20.0209 31.797 20.2447 32.0209 20.5209 32.0209H22.0209C23.1254 32.0209 24.0209 32.9163 24.0209 34.0209C24.0209 35.1255 23.1254 36.0209 22.0209 36.0209H14.0209C12.9163 36.0209 12.0209 35.1255 12.0209 34.0209C12.0209 32.9163 12.9163 32.0209 14.0209 32.0209ZM12.0209 44.0209C12.0209 41.8118 13.8117 40.0209 16.0209 40.0209H20.0209C22.23 40.0209 24.0209 41.8118 24.0209 44.0209V48.0209C24.0209 50.23 22.23 52.0209 20.0209 52.0209H16.0209H16.0209C13.8117 52.0209 12.0209 50.23 12.0209 48.0209V44.0209ZM16.0209 47.0209C16.0209 47.5732 16.4686 48.0209 17.0209 48.0209H19.0209C19.5732 48.0209 20.0209 47.5732 20.0209 47.0209V45.0209C20.0209 44.4686 19.5732 44.0209 19.0209 44.0209H17.0209C16.4686 44.0209 16.0209 44.4686 16.0209 45.0209V47.0209ZM50.0209 52.0209H46.0209C44.9163 52.0209 44.0209 51.1255 44.0209 50.0209C44.0209 48.9163 44.9163 48.0209 46.0209 48.0209H50.0209C51.1254 48.0209 52.0209 48.9163 52.0209 50.0209C52.0209 51.1255 51.1254 52.0209 50.0209 52.0209ZM52.0209 38.0209C52.0209 39.1255 51.1254 40.0209 50.0209 40.0209H48.5209C48.2447 40.0209 48.0209 40.2448 48.0209 40.5209V42.0209C48.0209 43.1255 47.1254 44.0209 46.0209 44.0209C44.9163 44.0209 44.0209 43.1255 44.0209 42.0209V38.0209C44.0209 36.9163 44.9163 36.0209 46.0209 36.0209H47.5209C47.797 36.0209 48.0209 35.797 48.0209 35.5209V32.5209C48.0209 32.2448 47.797 32.0209 47.5209 32.0209H46.0209C44.9163 32.0209 44.0209 31.1255 44.0209 30.0209C44.0209 28.9163 44.9163 28.0209 46.0209 28.0209H50.0209C51.1254 28.0209 52.0209 28.9163 52.0209 30.0209V38.0209ZM44.0209 12.0209H48.0209C50.23 12.0209 52.0209 13.8118 52.0209 16.0209V20.0209C52.0209 22.23 50.23 24.0209 48.0209 24.0209H44.0209C41.8117 24.0209 40.0209 22.23 40.0209 20.0209V16.0209V16.0208C40.0209 13.8117 41.8117 12.0208 44.0209 12.0208V12.0209ZM44.0209 19.0209C44.0209 19.5732 44.4686 20.0209 45.0209 20.0209H47.0209C47.5732 20.0209 48.0209 19.5732 48.0209 19.0209V17.0209C48.0209 16.4686 47.5732 16.0209 47.0209 16.0209H45.0209C44.4686 16.0209 44.0209 16.4686 44.0209 17.0209V19.0209ZM30.0209 16.0209C28.9163 16.0209 28.0209 15.1255 28.0209 14.0209C28.0209 12.9163 28.9163 12.0209 30.0209 12.0209H34.0209C35.1254 12.0209 36.0209 12.9163 36.0209 14.0209V23.5209C36.0209 23.797 36.2447 24.0209 36.5209 24.0209H38.0209C39.1254 24.0209 40.0209 24.9163 40.0209 26.0209C40.0209 27.1255 39.1254 28.0209 38.0209 28.0209H34.0209C32.9163 28.0209 32.0209 27.1255 32.0209 26.0209V24.5209C32.0209 24.2448 31.797 24.0209 31.5209 24.0209H30.0209C28.9163 24.0209 28.0209 23.1255 28.0209 22.0209C28.0209 20.9163 28.9163 20.0209 30.0209 20.0209H31.5209C31.797 20.0209 32.0209 19.797 32.0209 19.5209V16.0209H30.0209ZM28.0209 32.5209C28.0209 32.2448 27.797 32.0209 27.5209 32.0209H26.0209C24.9163 32.0209 24.0209 31.1255 24.0209 30.0209C24.0209 28.9163 24.9163 28.0209 26.0209 28.0209H30.0209C31.1254 28.0209 32.0209 28.9163 32.0209 30.0209V34.0209C32.0209 35.1255 31.1254 36.0209 30.0209 36.0209C28.9163 36.0209 28.0209 35.1255 28.0209 34.0209V32.5209ZM30.0209 40.0209H31.5209C31.797 40.0209 32.0209 39.797 32.0209 39.5209V38.0209C32.0209 36.9163 32.9163 36.0209 34.0209 36.0209H35.5209C35.797 36.0209 36.0209 35.797 36.0209 35.5209V34.0209C36.0209 32.9163 36.9163 32.0209 38.0209 32.0209C39.1254 32.0209 40.0209 32.9163 40.0209 34.0209V38.0209C40.0209 39.1255 39.1254 40.0209 38.0209 40.0209H36.5209C36.2447 40.0209 36.0209 40.2448 36.0209 40.5209V42.0209C36.0209 43.1255 35.1254 44.0209 34.0209 44.0209H30.0209C28.9163 44.0209 28.0209 43.1255 28.0209 42.0209C28.0209 40.9163 28.9163 40.0209 30.0209 40.0209ZM38.0209 44.0209C39.1254 44.0209 40.0209 44.9163 40.0209 46.0209V50.0209C40.0209 51.1255 39.1254 52.0209 38.0209 52.0209H30.0209C28.9163 52.0209 28.0209 51.1255 28.0209 50.0209C28.0209 48.9163 28.9163 48.0209 30.0209 48.0209H35.5209C35.797 48.0209 36.0209 47.797 36.0209 47.5209V46.0209C36.0209 44.9164 36.9162 44.021 38.0208 44.0209H38.0209Z"})}))));const ms="page";var gs=function(e,t){let o=e;t&&(o=`${o}?${function(e){const t=new URLSearchParams;return t.set(ms,e),t.toString()}(t)}`),navigator.clipboard.writeText(o)},hs=o(35247);const fs=b.ZP.div.withConfig({displayName:"SharingSheetCopyLink__CopyLinkRowWrapper",componentId:"pnc4wa-0"})(["width:100%;height:28px;margin-top:6px;display:flex;flex-direction:row;"]),bs=b.ZP.div.withConfig({displayName:"SharingSheetCopyLink__CurrentPageCheckboxWrapper",componentId:"pnc4wa-1"})(["width:100%;height:16px;margin-left:3.125px;margin-top:6px;display:flex;flex-direction:row;"]),ys=b.ZP.div.withConfig({displayName:"SharingSheetCopyLink__CopyLinkText",componentId:"pnc4wa-2"})(["font-size:",";color:",";padding-left:10px;cursor:pointer;"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),Cs=(0,b.ZP)(Ve.Z).withConfig({displayName:"SharingSheetCopyLink__SharingButton",componentId:"pnc4wa-3"})(["margin-left:8px;width:90px;min-width:90px;"]),vs=(0,b.ZP)(Cs).withConfig({displayName:"SharingSheetCopyLink__QrCodeButton",componentId:"pnc4wa-4"})(["margin-left:auto;width:36px;min-width:36px;padding:0;"]);var xs=e=>{let{sharingSheetOpen:t,activePageId:o,toggleQrCode:n,showQrCode:r,canonicalUrl:i}=e;const{0:l,1:s}=(0,a.useState)(!1),{0:c,1:d}=(0,a.useState)(!1),{t:p}=(0,y.$G)();(0,a.useEffect)((()=>{s(!1)}),[t]);return(0,_.jsxs)(fs,{children:[(0,_.jsxs)(bs,{children:[(0,_.jsx)(hs.Z,{height:13.75,width:13.75,checked:c,onClick:()=>d((e=>!e))}),(0,_.jsx)(ys,{onClick:()=>d((e=>!e)),children:p("tome.sharingSheetCopyLink.linkToCurrentPageCheckboxText")})]}),(0,_.jsx)(vs,{onClick:n,selected:r,"aria-label":p("tome.sharingSheetCopyLink.ToggleQRCodeButtonLabel"),children:(0,_.jsx)(us,{style:{width:20,height:20}})}),(0,_.jsx)(Cs,{onClick:()=>(gs(i,c&&o?o:void 0),void s(!0)),children:p(l?"tome.sharingSheetCopyLink.copiedLinkButtonLabel":"tome.sharingSheetCopyLink.copyLinkButtonLabel")})]})};const Os=b.ZP.div.withConfig({displayName:"SharingSheet__QRCodeWrapper",componentId:"sc-18a3uq1-0"})(["width:100%;margin-top:6px;padding:8px 12px 0 12px;"]),Ps=b.ZP.div.withConfig({displayName:"SharingSheet__QRCodeStyles",componentId:"sc-18a3uq1-1"})(["background-color:",";width:100%;height:100%;padding:16px;margin:auto;"],(e=>{let{theme:t}=e;return t.colors.sheetBg}));var ws=e=>{let{sharingSheetOpen:t,setSharingSheetOpen:o,tome:n,shareButtonRef:r,activePageId:i}=e;const l=(0,b.Fg)(),s=(0,a.useRef)(null),{0:c,1:d}=(0,a.useState)(!1),p=(0,a.useCallback)((()=>{d((e=>!e))}),[]),u=(0,a.useCallback)((()=>{o(!1)}),[o]);(0,vl.Z)({handleClose:u,enabled:t});const{user:m,flags:g,loading:h,activeMembership:f}=(0,a.useContext)(xr.Z);if(h||!m)return null;const{canManage:y}=n.currentUserPermission,{publicSharing:C}=g||{};let v=!1;var x;null!==f&&void 0!==f&&f.org&&n.author.org&&(v=n.author.org.id===f.org.id||(null===(x=n.org)||void 0===x?void 0:x.id)===f.org.id);return(0,_.jsx)(Ul,{children:t&&(0,_.jsxs)(Cr.Z,{exemptContainerRefs:[r,s],onClick:()=>o(!1),children:[y&&(0,_.jsx)(ns,{tome:n}),(0,_.jsx)(ls,{owner:n.author}),f&&(0,_.jsx)(as,{tome:n,sameOrg:v}),(0,_.jsx)(Kl,{tome:n}),(0,_.jsx)(ql,{}),(0,_.jsx)(cs,{tome:n,publicSharing:C}),(0,_.jsx)(xs,{sharingSheetOpen:t,activePageId:i,showQrCode:c,toggleQrCode:p,canonicalUrl:n.canonicalUrl}),c&&(0,_.jsx)(Os,{"data-testid":"qr_code",children:(0,_.jsx)(Ps,{children:(0,_.jsx)(Cl.Z,{value:window.location.href,size:278,bgColor:l.colors.sheetBg,fgColor:l.colors.contrast})})})]})})},js=o(55245);var Ts=()=>{const[e,t]=(0,l.FV)(V.Fc);return(0,a.useEffect)((()=>{const e=()=>{void 0!==window.document.webkitIsFullScreen?t(window.document.webkitIsFullScreen):t(!!window.document.fullscreenElement)};window.document.onfullscreenchange=e,window.document.onwebkitfullscreenchange=e}),[t]),e};var Es=e=>{let{timeout:t,disabled:o}=e;const n=(0,a.useRef)(),{0:r,1:i}=(0,a.useState)(!1),l=(0,a.useCallback)((()=>{i(!1)}),[i]),s=(0,a.useCallback)((()=>{i(!0)}),[i]);return(0,a.useEffect)((()=>{const e=()=>{n.current&&clearTimeout(n.current),n.current=setTimeout((()=>{o||i(!0)}),t),i(!1)};return o?(n.current&&clearTimeout(n.current),window.removeEventListener("mousemove",e)):(e(),window.addEventListener("mousemove",e)),()=>window.removeEventListener("mousemove",e)}),[n,t,o]),(0,a.useEffect)((()=>{o&&(n.current&&clearTimeout(n.current),i(!1))}),[o]),(0,a.useEffect)((()=>{r?document.documentElement.classList.add("hideCursor"):document.documentElement.classList.remove("hideCursor")}),[r]),{showCursor:l,hideCursor:s}};function Is(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ss(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Is(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Is(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const _s=(e,t)=>(0,_.jsx)(Te.Z,Ss(Ss({ref:t,width:"6",height:"6",viewBox:"0 0 6 6",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),{},{children:(0,_.jsx)("circle",{cx:"3",cy:"3",r:"2.5",fill:"#ED00EB"})}));var ks=(0,a.forwardRef)(_s),Zs=o(95911);const Ds=m()((()=>Promise.all([o.e(2432),o.e(5453),o.e(8080),o.e(7443),o.e(5218),o.e(3489)]).then(o.bind(o,13489))),{loading:e=>{let{error:t}=e;return(0,_.jsx)(Zs.ex,{error:t})},loadableGenerated:{webpack:()=>[13489]}}),Ms=m()((()=>Promise.all([o.e(2432),o.e(5453),o.e(8080),o.e(7443),o.e(5218),o.e(8546)]).then(o.bind(o,58546))),{loading:e=>{let{error:t}=e;return(0,_.jsx)(Zs.ex,{error:t})},loadableGenerated:{webpack:()=>[58546]}}),Rs=b.ZP.div.withConfig({displayName:"CommentsSheet__CommentsSheetWrapper",componentId:"sc-1k8z3r9-0"})(["cursor:default;position:absolute;top:","px;right:12px;pointer-events:auto;> div{box-shadow:",";background:",";width:","px;border-radius:18px;padding:12px 0 12px 0;}z-index:",";"],(e=>e.theme.headerHeight),(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow}),(e=>e.theme.colors.sheetBg),340,T.Ue),As=(0,b.ZP)(Fe).withConfig({displayName:"CommentsSheet__StyledSegmentedControls",componentId:"sc-1k8z3r9-1"})(["display:flex;& button{flex:1;text-transform:capitalize;}"]),Ls=b.ZP.div.withConfig({displayName:"CommentsSheet__SheetStyles",componentId:"sc-1k8z3r9-2"})([""]),Ns=b.ZP.div.withConfig({displayName:"CommentsSheet__ToggleContainerStyles",componentId:"sc-1k8z3r9-3"})(["padding:0 16px 0 16px;z-index:",";"],T.tF),Hs=b.ZP.div.withConfig({displayName:"CommentsSheet__ContentStyles",componentId:"sc-1k8z3r9-4"})(["margin-top:0px;"]);var Vs=e=>{let{commentsSheetOpen:t,tome:o}=e;const{t:n}=(0,y.$G)(),r=(0,l.sJ)(V.Vx),{0:i,1:s}=(0,a.useState)(n("components.commentsSheet.showCommentsFromCurrentTomePageOnly")),{user:c}=(0,a.useContext)(xr.Z),d=(0,a.useCallback)((()=>{(0,V.k$)(!1)}),[]);(0,vl.Z)({handleClose:d,enabled:t}),(0,a.useEffect)((()=>{s(n("components.commentsSheet.showCommentsFromCurrentTomePageOnly"))}),[t,n]);const{commentsSheetRef:p}=(0,H.TR)(),u=(0,Pa.Ti)(o),m=(0,B.yW)(o.pages,r);return(0,_.jsx)(Rs,{ref:p,children:c&&t&&(0,_.jsxs)(Ls,{"data-testid":"comments_sheet",children:[(0,_.jsx)(Ns,{children:(0,_.jsx)(As,{role:"listbox",children:n("components.commentsSheet.sectionsOfTomeToShowCommentsFrom",{returnObjects:!0}).map((e=>(0,_.jsx)(Ve.Z,{"aria-selected":i===e,onClick:()=>s(e),value:e,isSegment:!0,selected:i===e,iconOpacity:1,endIcon:e===n("components.commentsSheet.showCommentsFromEntireTome")&&u?(0,_.jsx)(ks,{style:{width:5,height:5,opacity:1}}):null,children:e},e)))})}),(0,_.jsx)(Hs,{children:(0,_.jsx)(_.Fragment,{children:i===n("components.commentsSheet.showCommentsFromCurrentTomePageOnly")?(0,_.jsx)(Ds,{tome:o,page:m}):(0,_.jsx)(Ms,{tome:o,setPageView:s})})})]})})};function Bs(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function $s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Bs(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Bs(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Fs=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,$s($s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M41.3065 8.52829C40.478 7.79872 39.2149 7.87896 38.4853 8.7075L27.7047 20.7804C27.3471 21.1497 27.2971 21.6497 27.7047 22.0497L41.3766 35.7763C41.7471 36.1496 42.4471 36.1596 42.8123 35.7763L47.4818 30.3496C47.8026 29.9849 47.9797 29.5159 47.98 29.0301C47.9807 27.9256 47.0859 27.0295 45.9813 27.0288H35.857L41.8609 10.7202C42.1468 9.94519 41.9264 9.07418 41.3065 8.52829ZM22.6906 55.5213C23.5191 56.2508 24.7822 56.1706 25.5118 55.3421L36.2924 43.2691C36.65 42.8999 36.7 42.3999 36.2924 41.9999L22.6205 28.2733C22.25 27.8999 21.55 27.8899 21.1847 28.2733L16.5153 33.7C16.1945 34.0647 16.0174 34.5337 16.0171 35.0194C16.0164 36.124 16.9112 37.02 18.0158 37.0208H28.1401L22.1362 53.3294C21.8503 54.1044 22.0706 54.9754 22.6906 55.5213ZM13.4204 10.5506L53.4318 50.5857C54.2136 51.3669 54.2141 52.6339 53.433 53.4157C52.6518 54.1975 51.3847 54.1981 50.6029 53.4169L10.591 13.3818C9.8092 12.6004 9.8088 11.3333 10.5901 10.5515C11.3714 9.76965 12.6386 9.76925 13.4204 10.5506Z",fill:"#D05B41"})})))),Gs=o(82326),zs=o(37887);var Us=o(50456).ZP`
  query tomePresence($id: String!) {
    tome(id: $id) {
      ...TomeViewsFragment
    }
  }
  ${U.CIe}
`,Ws=o(21025);var qs=e=>{var t,o,n,r;let{tomeId:i}=e;const{width:l}=(0,F.Z)(),{t:s}=(0,y.$G)(),c=(0,a.useMemo)((()=>(0,Ws.tQ)(l??0)),[l]),{data:d}=(0,U.sn6)({variables:{tomeId:i},fetchPolicy:"network-only",nextFetchPolicy:"cache-first"}),p=(0,zs.a)(Us,{variables:{id:i},nextFetchPolicy:"cache-only"});if(p.error)throw p.error;if(p.loading||void 0===p.data)return{seenHeadViewModels:[],overflowViewModels:[],anonymousViewers:0,userOrgName:""};const u=(null===(t=p.data)||void 0===t||null===(o=t.tome)||void 0===o?void 0:o.views)||[],m=p.data.tome.anonymousViews,g=(0,Ws.K3)(u).map(Ws.Pr);return m&&m>0&&g.push({label:`${m.toLocaleString()}${s("controllers.tomePresenceViewModel.viewers_with_count",{count:m})}`,isActive:!1,activityId:"anonymousCountRow"}),{seenHeadViewModels:(0,Ws.UO)(u).map(Ws.Pr).splice(0,c),overflowViewModels:g,anonymousViewers:m??0,userOrgName:(null===d||void 0===d||null===(n=d.tome)||void 0===n||null===(r=n.org)||void 0===r?void 0:r.name)??""}},Ks=o(30934);var Ys=e=>{let{tomeId:t,navigateToPage:o}=e;const{seenHeadViewModels:n,overflowViewModels:r,anonymousViewers:i,userOrgName:a}=qs({tomeId:t});return(0,_.jsx)(Ks.Z,{seenHeadsViewModels:n,overflowViewModels:r,avatarSize:20,animated:!0,navigateToPage:o,anonymousViewers:i,userOrgName:a})};var Js=function(e){return e.canView&&!e.canEdit&&!e.canComment&&!e.canManage};var Xs=()=>{const{titleEditableLabelRef:e}=(0,H.TR)(),t=(0,a.useCallback)((()=>{e.current&&e.current.focus()}),[e]);return{titleEditableLabelRef:e,focusOnTitle:t}},Qs=o(49335),ec=o(57509);const tc=b.ZP.div.withConfig({displayName:"HeaderPermissionsIndicator__StyledIndicator",componentId:"sc-4gqf27-0"})(["font-size:13px;line-height:16px;color:",";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;@media ","{display:none;}"],(e=>e.theme.colors.contrast40),ec.Hb.tablet);var oc=e=>{let{permissions:t}=e;const{t:o}=(0,y.$G)(),n=(0,c.l)(V.Ad),r=(0,a.useCallback)((()=>n.length>0?o("tome.header.headerPermissionsIndicator.readOnlyPermissionIndicatorLabel"):t.isAuthor||t.canEdit?null:t.canComment?o("tome.header.headerPermissionsIndicator.commentOnlyPermissionIndicatorLabel"):t.canView?o("tome.header.headerPermissionsIndicator.viewOnlyPermissionIndicatorLabel"):null),[t,n,o])();return r?(0,_.jsx)(tc,{children:r}):null};const nc=["style"];function rc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ic(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?rc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):rc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ac=(e,t)=>{const{style:o}=e,n=(0,i.Z)(e,nc);return(0,_.jsx)(Te.Z,ic(ic({ref:t,style:ic({},o),viewBox:"0 0 64 64"},n),{},{children:(0,_.jsx)("path",{d:"M20 46.6906V17.3094C20 14.643 22.8944 12.9835 25.1956 14.3305L50.292 29.021C52.5693 30.3541 52.5693 33.6459 50.292 34.979L25.1956 49.6695C22.8944 51.0165 20 49.357 20 46.6906Z"})}))};var lc=(0,a.forwardRef)(ac),sc=o(40312);const cc=["visible","children","as"];function dc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function pc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?dc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):dc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const uc=e=>{let{visible:t,children:o,as:n}=e,r=(0,i.Z)(e,cc);const a=n||d.E.div;return(0,_.jsx)(p.M,{children:t&&(0,_.jsx)(a,pc(pc({},r),{},{transition:E.Oo,initial:{opacity:0},animate:{opacity:t?1:0},exit:{opacity:0},children:o}))})},mc=e=>{let{enterPresentMode:t}=e;const{t:o}=(0,y.$G)();return(0,_.jsx)(ln.Z,{content:o("tome.header.control.togglePresentMode.enterPresentMode"),shortcuts:[(0,sc.C6)(),"P"],placement:"bottom",perpendicularOffset:-20,children:(0,_.jsx)(nl,{onClick:t,"aria-label":o("tome.header.control.togglePresentMode.playAriaLabel"),onZ0:!0,icon:(0,_.jsx)(lc,{style:{width:28,height:28}})})})},gc=e=>{let{permission:t,exitPresentMode:o}=e;const{workspaceUrl:n}=(0,H.bp)(),r=(0,l.sJ)(V.SM),{t:i}=(0,y.$G)();if(t.canEdit||t.canComment)return(0,_.jsx)(ln.Z,{content:i("tome.header.control.togglePresentMode.exitPresentMode"),shortcuts:["esc"],placement:"bottom",perpendicularOffset:-10,children:(0,_.jsx)(nl,{onClick:o,"aria-label":i("tome.header.control.togglePresentMode.exitPlayAriaLabel"),icon:(0,_.jsx)(Zt.Z,{style:{width:28,height:28}})})});const a=(0,_.jsx)(nl,{"aria-label":i("tome.header.control.togglePresentMode.exitPlayAriaLabel"),icon:(0,_.jsx)(Zt.Z,{style:{width:28,height:28}})});return(0,_.jsx)(ln.Z,{content:i("tome.header.control.togglePresentMode.exitPresentMode"),shortcuts:["esc"],placement:"bottom",perpendicularOffset:-10,children:(0,_.jsx)("div",{children:r?(0,_.jsx)("a",{href:n,target:"_blank",children:a}):(0,_.jsx)(La(),{href:n,children:a})})})};var hc=e=>{let{permission:t,presentMode:o,exitPresentMode:n,enterPresentMode:r}=e;return(0,_.jsxs)(tl,{style:{marginLeft:8,width:40},children:[(0,_.jsx)(uc,{visible:!o,as:rl,children:(0,_.jsx)(tl,{children:(0,_.jsx)(mc,{enterPresentMode:r})})}),(0,_.jsx)(uc,{visible:o,as:rl,initial:!1,children:(0,_.jsx)(tl,{children:(0,_.jsx)(gc,{permission:t,exitPresentMode:n})})})]})},fc=o(92010),bc=o(65653),yc=o(14773);const Cc=(0,b.ZP)(d.E.div).withConfig({displayName:"Attribution__TitleRow",componentId:"sc-19y4g0p-0"})(["display:flex;transform-origin:0% 0% 0px;"]),vc=(0,b.ZP)(d.E.div).withConfig({displayName:"Attribution__Title",componentId:"sc-19y4g0p-1"})(["font-weight:500;font-size:15px;line-height:20px;white-space:nowrap;overflow:hidden;color:",";"],(e=>{let{$presentMode:t,theme:o}=e;return t?o.colors.attributionTitle:o.colors.attributionTitlePresentMode})),xc=b.ZP.div.withConfig({displayName:"Attribution__TitleOverflow",componentId:"sc-19y4g0p-2"})(["",""],si.wR),Oc=(0,b.ZP)(Ve.Z).withConfig({displayName:"Attribution__UpgradeButton",componentId:"sc-19y4g0p-3"})(["height:22px;padding:0 6px;min-width:0;margin-left:8px;"]),Pc=(0,b.ZP)(d.E.div).withConfig({displayName:"Attribution__AttributionContent",componentId:"sc-19y4g0p-4"})(["pointer-events:none !important;*{pointer-events:all;}"]),wc={notPresentMode:{x:40,transitionStart:{overflow:"visible"},width:"100%"},presentMode:{x:10,transitionEnd:{overflow:"hidden"}},mobile:{x:0,transitionEnd:{overflow:"hidden"},width:"100%"}};var jc=e=>{let{title:t,presentMode:o,renameTome:n=(()=>null),titleEditableLabelRef:r,isEditor:i=!1,isMobile:l,showUpgradeButton:s=!1}=e;const{t:c}=(0,y.$G)(),{openSettings:d}=(0,bc.r)(),{apolloClient:p}=(0,H.bp)(),u=(0,a.useRef)(null),m=[];l?m.push("mobile"):o?m.push("presentMode"):m.push("notPresentMode");const g=(0,a.useCallback)((()=>{We.ZP.reportPaymentEvent({apolloClient:p,trackEventType:We.nM.CLICK_TOME_UPGRADE_BUTTON}),d(yc.u.PLANS)}),[p,d]);return(0,_.jsx)(Pc,{ref:u,transition:E.Oo,initial:!1,variants:wc,animate:m,children:(0,_.jsxs)(Cc,{id:"HeaderTitle",transition:E.Oo,initial:!1,animate:{y:14,x:0},style:{position:o?"unset":"fixed"},children:[(0,_.jsx)(vc,{$presentMode:o,children:o?(0,_.jsx)(xc,{children:t}):(0,_.jsx)(fc.Z,{labelId:"tome-attribution",dataTestId:"tome_title",ref:r,plainContent:t,disabled:!i||o,onContentChange:n,maxCharacterLimit:128,selectAllOnFocus:!0,shouldSetGlobalState:!0,style:{zIndex:1}})}),s&&(0,_.jsx)(Oc,{"aria-label":c("upgradeButton.ariaLabel"),"data-testid":"tome_upgrade",onClick:g,children:c("upgradeButton.label")})]})})},Tc=o(19148),Ec=o(39346);const Ic=["tome","toggleCommentsPanel"],Sc=b.ZP.div.withConfig({displayName:"CommentsButtonWrapper__ContentStyles",componentId:"sc-1bkk4b6-0"})(["cursor:pointer;display:flex;"]);var _c=e=>{let{tome:t,toggleCommentsPanel:o}=e,n=(0,i.Z)(e,Ic);const{t:r}=(0,y.$G)();return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(ln.Z,{content:r("components.commentsButtonWrapper.commentsButtonTooltipLabel"),shortcuts:[(0,sc.C6)(),"M"],placement:"bottom",children:(0,_.jsx)(Sc,{onClick:o,children:n.children()})})})},kc=o(46295);var Zc=(0,a.forwardRef)(((e,t)=>{let{visible:o,tome:n,toggleCommentsPanel:r,unreadBadge:i,commentsCount:a}=e;return(0,_.jsx)(uc,{visible:o,children:(0,_.jsx)(ol,{ref:t,children:(0,_.jsx)(_c,{tome:n,toggleCommentsPanel:r,children:()=>(0,_.jsx)(nl,{onZ0:!0,"aria-label":Tc.ZP.t("tome.header.control.comments.commentsButtonLabel"),startIcon:(0,_.jsx)(Ec.Z,{$visible:i,children:(0,_.jsx)(kc.Z,{style:{height:28,width:28}})}),iconStyles:{margin:2,marginLeft:-2,marginRight:a>0?4:0},style:{padding:"0 6px"},children:a>0&&a})})})})})),Dc=o(50319),Mc=o(47314),Rc=o(37308),Ac=o(77759),Lc=o(64972),Nc=o(56793);const Hc=()=>{const e=window.document.documentElement;try{e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}catch(t){}};var Vc=o(78724),Bc=o(98382),$c=o.n(Bc);let Fc,Gc;!function(e){e[e.ALWAYS=0]="ALWAYS",e[e.DIRTY=1]="DIRTY",e[e.EMPTY=2]="EMPTY"}(Fc||(Fc={})),function(e){e[e.NONE=0]="NONE",e[e.TITLE=1]="TITLE",e[e.KEYWORD=2]="KEYWORD"}(Gc||(Gc={}));class zc{constructor(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Fc.ALWAYS,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0;this.id=e,this.title=t,this.placeholder=o,this.component=n,this.hasFallbackMode=r,this.contentDependency=i,this.keywords=a,this.featureFlag=l,this.userContextFilter=s}score(e){const t=e.toLowerCase(),o=$c()(this.title.toLowerCase(),t);if(o>.1)return{score:o,type:Gc.TITLE};const n=Math.max(...this.keywords.map((e=>$c()(e.toLowerCase(),t))),0);return{score:n,type:n>.1?Gc.KEYWORD:Gc.NONE}}}let Uc;function Wc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function qc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}!function(e){e.ADD_AIRTABLE_TILE="ADD_AIRTABLE_TILE",e.ADD_FIGMA_TILE="ADD_FIGMA_TILE",e.ADD_FRAMER_TILE="ADD_FRAMER_TILE",e.ADD_GIPHY_TILE="ADD_GIPHY_TILE",e.ADD_IMAGE_GENERATIVE_TILE="ADD_IMAGE_GENERATIVE_TILE",e.ADD_IMAGE_TILE="ADD_IMAGE_TILE",e.ADD_LOOKER_TILE="ADD_LOOKER_TILE",e.ADD_MIRO_TILE="ADD_MIRO_TILE",e.ADD_TABLE_TILE="ADD_TABLE_TILE",e.ADD_TEXT_TILE="ADD_TEXT_TILE",e.ADD_TWITTER_TILE="ADD_TWITTER_TILE",e.ADD_VIDEO_TILE="ADD_VIDEO_TILE",e.ADD_WEB_TILE="ADD_WEB_TILE",e.AUTOTOME="AUTOTOME",e.AUTOTOME_V2="AUTOTOME_V2",e.CHAT="CHAT",e.COPY_LINK="COPY_LINK",e.CREATE_IMAGE="CREATE_IMAGE",e.CREATE_PAGE="CREATE_PAGE",e.DOC_TO_TOME="DOC_TO_TOME",e.EXPORT_TO_PDF="EXPORT_TO_PDF",e.GETTING_STARTED_LINK="GETTING_STARTED_LINK",e.NEW_PAGE="NEW_PAGE",e.OPEN_CUSTOMIZE_PANEL="OPEN_CUSTOMIZE_PANEL",e.OPEN_RECORD_PANEL="OPEN_RECORD_PANEL",e.PROMPT_TIPS_LINK="PROMPT_TIPS_LINK",e.RENAME_TOME="RENAME_TOME",e.SHARE="SHARE",e.UPLOAD_IMAGE="UPLOAD_IMAGE",e.VOTE_IMAGE_LEFT="VOTE_IMAGE_LEFT",e.VOTE_IMAGE_RIGHT="VOTE_IMAGE_RIGHT",e.YOUTUBE_TO_TOME="YOUTUBE_TO_TOME"}(Uc||(Uc={}));var Kc=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,qc(qc({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M30 20C30 18.8954 30.8954 18 32 18C33.1046 18 34 18.8954 34 20V30H44C45.1046 30 46 30.8954 46 32C46 33.1046 45.1046 34 44 34H34V44C34 45.1046 33.1046 46 32 46C30.8954 46 30 45.1046 30 44V34H20C18.8954 34 18 33.1046 18 32C18 30.8954 18.8954 30 20 30H30V20Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 18C10 13.5817 13.5817 10 18 10H46C50.4183 10 54 13.5817 54 18V46C54 50.4183 50.4183 54 46 54H18C13.5817 54 10 50.4183 10 46V18ZM14 18C14 15.7909 15.7909 14 18 14H46C48.2091 14 50 15.7909 50 18V46C50 48.2091 48.2091 50 46 50H18C15.7909 50 14 48.2091 14 46V18Z"})]}))));function Yc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Jc(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Yc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Yc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Xc=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,Jc(Jc({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.6917 41.7479C48.2942 42.0905 47.6999 42.0689 47.3284 41.6984L42.5471 36.9153C42.2705 36.638 42.1817 36.2246 42.32 35.8581V35.8581C44.4445 30.1735 41.5586 23.843 35.874 21.7184C33.3946 20.7918 30.6641 20.7912 28.1844 21.7169C27.8179 21.8551 27.4045 21.7661 27.1273 21.4895L23.9328 18.2937C23.6882 18.0499 23.6876 17.6541 23.9313 17.4095C24.0002 17.3404 24.0844 17.2884 24.177 17.2576H24.177C26.7041 16.4337 29.3463 16.0176 32.0044 16.0249C46.6744 16.0249 53.9603 27.6936 55.7744 31.098V31.098C56.0823 31.6741 56.0823 32.3658 55.7744 32.9419C53.9586 36.2768 51.5597 39.2593 48.6917 41.7479L48.6917 41.7479ZM13.4332 10.6159L53.4256 50.6281C54.2068 51.409 54.2072 52.6753 53.4263 53.4566C52.6455 54.2378 51.3791 54.2382 50.5979 53.4573L10.6055 13.4452C9.82419 12.6644 9.82383 11.398 10.6047 10.6167C11.3855 9.83543 12.6519 9.83507 13.4332 10.6159ZM16.6773 22.344L21.4812 27.15C21.757 27.4267 21.8461 27.8389 21.7092 28.2048C19.5983 33.8955 22.5002 40.22 28.1909 42.3309C30.6555 43.2451 33.3661 43.2457 35.831 42.3325C36.1969 42.1956 36.609 42.2849 36.8856 42.5608L40.0709 45.7476C40.3154 45.9914 40.316 46.3872 40.0723 46.6318C40.0034 46.7009 39.9192 46.7529 39.8266 46.7837C37.301 47.6065 34.6606 48.0221 32.0044 48.0148C17.3344 48.0148 10.0485 36.3462 8.23438 32.9419C7.92627 32.3659 7.92627 31.674 8.23438 31.098L8.23438 31.098C10.0491 27.7642 12.4467 24.7826 15.3134 22.2946C15.711 21.9518 16.3055 21.9734 16.6773 22.344V22.344Z"})}))));function Qc(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ed(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Qc(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Qc(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var td=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,ed(ed({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M14 21C14 19.8954 14.8954 19 16 19H24C25.1046 19 26 18.1046 26 17C26 15.8954 25.1046 15 24 15H16C12.6863 15 10 17.6863 10 21V27C10 28.1046 10.8954 29 12 29C13.1046 29 14 28.1046 14 27V21Z"}),(0,_.jsx)("path",{d:"M50 21C50 19.8954 49.1046 19 48 19H40C38.8954 19 38 18.1046 38 17C38 15.8954 38.8954 15 40 15H48C51.3137 15 54 17.6863 54 21V27C54 28.1046 53.1046 29 52 29C50.8954 29 50 28.1046 50 27V21Z"}),(0,_.jsx)("path",{d:"M16 45C14.8954 45 14 44.1046 14 43V37C14 35.8954 13.1046 35 12 35C10.8954 35 10 35.8954 10 37V43C10 46.3137 12.6863 49 16 49H24C25.1046 49 26 48.1046 26 47C26 45.8954 25.1046 45 24 45H16Z"}),(0,_.jsx)("path",{d:"M50 43C50 44.1046 49.1046 45 48 45H40C38.8954 45 38 45.8954 38 47C38 48.1046 38.8954 49 40 49H48C51.3137 49 54 46.3137 54 43V37C54 35.8954 53.1046 35 52 35C50.8954 35 50 35.8954 50 37V43Z"})]}))));function od(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function nd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?od(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):od(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var rd=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,nd(nd({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M41.9899 31.9792C41.9899 37.5021 37.5146 41.9792 31.9941 41.9792C26.4736 41.9792 21.9984 37.5021 21.9984 31.9792C21.9984 26.4564 26.4736 21.9792 31.9941 21.9792C37.5146 21.9792 41.9899 26.4564 41.9899 31.9792ZM37.9916 31.9792C37.9916 35.293 35.3064 37.9792 31.9941 37.9792C28.6818 37.9792 25.9967 35.293 25.9967 31.9792C25.9967 28.6655 28.6818 25.9792 31.9941 25.9792C35.3064 25.9792 37.9916 28.6655 37.9916 31.9792Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M31.9999 14C16.1413 14 8.34537 26.6083 6.46618 30.1363C5.84479 31.3006 5.84461 32.6982 6.46564 33.8627C8.34386 37.3892 16.1398 50 31.9999 50C47.8586 50 55.6545 37.3917 57.5337 33.8637C58.1553 32.6994 58.1554 31.3017 57.5342 30.1373C55.656 26.6108 47.8601 14 31.9999 14ZM31.9999 46C18.5454 46 11.7686 35.3057 10.0041 32C11.7686 28.6943 18.5454 18 31.9999 18C45.4545 18 52.2312 28.6943 53.9958 32C52.2312 35.3057 45.4545 46 31.9999 46Z"})]}))));function id(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ad(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?id(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):id(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var ld=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,ad(ad({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 12C16 10.8954 15.1046 10 14 10C12.8954 10 12 10.8954 12 12V22C12 23.1046 12.8954 24 14 24H24C25.1046 24 26 23.1046 26 22C26 20.8954 25.1046 20 24 20H18.5836C20.7681 17.5575 23.5854 15.7502 26.7373 14.7865C30.3725 13.6751 34.2661 13.7431 37.8603 14.9807C41.4544 16.2182 44.5645 18.5618 46.7448 21.6756C48.9251 24.7894 50.0636 28.5135 49.9973 32.3142C49.9309 36.1148 48.6631 39.7969 46.3755 42.8327C44.0878 45.8685 40.8978 48.1021 37.2627 49.2135C33.6276 50.3249 29.7339 50.2569 26.1398 49.0193C23.1785 47.9997 20.5458 46.2292 18.491 43.8957C17.7611 43.0667 16.5218 42.838 15.617 43.4715C14.7122 44.1051 14.4856 45.3591 15.1987 46.2027C17.7503 49.2212 21.0771 51.5066 24.8375 52.8014C29.2303 54.314 33.9892 54.397 38.4322 53.0387C42.8751 51.6804 46.774 48.9504 49.57 45.2399C52.366 41.5295 53.9156 37.0292 53.9967 32.384C54.0778 27.7387 52.6862 23.1871 50.0214 19.3813C47.3566 15.5756 43.5554 12.7112 39.1625 11.1986C34.7697 9.68602 30.0108 9.60295 25.5678 10.9613C21.9042 12.0814 18.6104 14.1342 16 16.9003V12ZM16 19.9431V20H16.0755L16 19.9431Z"})})))),sd=o(30466);function cd(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function dd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):cd(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var pd=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,dd(dd({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M39 10C38.4477 10 38 10.4477 38 11C38 11.5523 38.4477 12 39 12H44V52H39C38.4477 52 38 52.4477 38 53C38 53.5523 38.4477 54 39 54H51C51.5523 54 52 53.5523 52 53C52 52.4477 51.5523 52 51 52H46V12H51C51.5523 12 52 11.5523 52 11C52 10.4477 51.5523 10 51 10H39Z"}),(0,_.jsx)("path",{d:"M12 19C12 17.8954 12.8954 17 14 17H34C35.1046 17 36 17.8954 36 19C36 20.1046 35.1046 21 34 21H26V45C26 46.1046 25.1046 47 24 47C22.8954 47 22 46.1046 22 45V21H14C12.8954 21 12 20.1046 12 19Z"})]}))));function ud(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function md(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ud(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ud(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var gd=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,md(md({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 19.2171V11C24 7.68629 26.6863 5 30 5H36.4006C38.0591 5 39.6435 5.68645 40.7778 6.89635L52.3772 19.269C52.5923 19.4985 52.7877 19.743 52.9624 20H53V20.056C53.6481 21.0331 54 22.1856 54 23.3727V39C54 42.3137 51.3137 45 48 45H40V53C40 56.3137 37.3137 59 34 59H16C12.6863 59 10 56.3137 10 53V25C10 21.6863 12.6863 19 16 19H22.4006C22.9462 19 23.4838 19.0743 24 19.2171ZM50 39C50 40.1046 49.1046 41 48 41H40V37.3727C40 36.1856 39.6481 35.0331 39 34.056V34H38.9624C38.7877 33.743 38.5923 33.4985 38.3772 33.269L28 22.2V11C28 9.89543 28.8954 9 30 9H35V18C35 21.3137 37.6863 24 41 24H50V39ZM47.5796 20H41C39.8954 20 39 19.1046 39 18V10.8485L47.5796 20ZM34 55C35.1046 55 36 54.1046 36 53V38H27C23.6863 38 21 35.3137 21 32V23H16C14.8954 23 14 23.8954 14 25V53C14 54.1046 14.8954 55 16 55H34ZM27 34H33.5796L25 24.8485V32C25 33.1046 25.8954 34 27 34Z"})}))));function hd(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function fd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?hd(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):hd(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var bd=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,fd(fd({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M48.0049 52H30.0156C26.7046 51.9961 24.0216 49.3119 24.0186 46V39.9717C24.0264 38.8675 24.9276 37.9787 26.0315 37.9865C27.1354 37.9943 28.024 38.8958 28.0162 40V46C28.0175 47.104 28.9119 47.9987 30.0156 48H48.005C49.1085 47.9985 50.0027 47.1039 50.0038 46V18C50.0029 16.896 49.1086 16.0012 48.005 16H30.0159C28.9121 16.001 28.0175 16.8958 28.0165 18V24.0283C28.0087 25.1325 27.1074 26.0213 26.0035 26.0135C24.8996 26.0057 24.0111 25.1042 24.0189 24V18C24.0219 14.6882 26.7047 12.004 30.0156 12H48.005C51.3158 12.0042 53.9983 14.6883 54.0014 18V46C53.9983 49.3117 51.3157 51.9959 48.0049 52Z"}),(0,_.jsx)("path",{d:"M32.5857 24.5858C33.3667 23.8047 34.633 23.8047 35.4141 24.5858L41.4141 30.5858C42.1951 31.3668 42.1951 32.6332 41.4141 33.4142L35.4141 39.4142C34.633 40.1953 33.3667 40.1953 32.5857 39.4142C31.8046 38.6332 31.8046 37.3668 32.5857 36.5858L35.1715 34H11.9999C10.8953 34 9.99988 33.1046 9.99988 32C9.99988 30.8954 10.8953 30 11.9999 30H35.1715L32.5857 27.4142C31.8046 26.6332 31.8046 25.3668 32.5857 24.5858Z"})]})))),yd=o(2685);function Cd(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function vd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Cd(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Cd(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var xd=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,vd(vd({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M34 12C34 10.8954 33.1046 10 32 10C30.8954 10 30 10.8954 30 12V35.1716L23.4142 28.5858C22.6332 27.8047 21.3668 27.8047 20.5858 28.5858C19.8047 29.3668 19.8047 30.6332 20.5858 31.4142L30.5858 41.4142C31.3668 42.1953 32.6332 42.1953 33.4142 41.4142L43.4142 31.4142C44.1953 30.6332 44.1953 29.3668 43.4142 28.5858C42.6332 27.8047 41.3668 27.8047 40.5858 28.5858L34 35.1716V12Z"}),(0,_.jsx)("path",{d:"M14 50C12.8954 50 12 50.8954 12 52C12 53.1046 12.8954 54 14 54H50C51.1046 54 52 53.1046 52 52C52 50.8954 51.1046 50 50 50H14Z"})]}))));let Od;!function(e){e[e.DELETE_TOME=0]="DELETE_TOME",e[e.RESTORE_TOME=1]="RESTORE_TOME",e[e.SIGN_IN=2]="SIGN_IN",e[e.TOGGLE_ANNOTATIONS_OVERLAYS=3]="TOGGLE_ANNOTATIONS_OVERLAYS",e[e.ENTER_FULLSCREEN=4]="ENTER_FULLSCREEN",e[e.ADD_LOGO=5]="ADD_LOGO",e[e.SHOW_LOGO=6]="SHOW_LOGO",e[e.HIDE_LOGO=7]="HIDE_LOGO",e[e.RENAME_TOME=8]="RENAME_TOME",e[e.DUPLICATE_TOME=9]="DUPLICATE_TOME",e[e.CREATE_PDF=10]="CREATE_PDF",e[e.OPEN_SETTINGS_PLANS=11]="OPEN_SETTINGS_PLANS"}(Od||(Od={}));const Pd=Tc.ZP.t("tome.header.tomeMenuBuilding.addLogoMenuItemLabel"),wd=Tc.ZP.t("tome.header.tomeMenuBuilding.exportToPDFMenuItemLabel");var jd=e=>{var t,o;let{deleted:n,userIsEditor:r,isLoggedIn:i,presentMode:c,redirectToLogin:d,userCanManage:p,usersOrgId:u,tomeThemeId:m,orgLogoAvailable:h,shouldShowLogo:f,closeOtherPanels:b}=e;const C=(0,g.useRouter)(),{tomeId:v}=(0,a.useContext)(Mi.z),{workspaceUrl:x,setWorkspaceUrl:O}=(0,H.bp)(),P=(0,a.useRef)(null),[w,T]=(0,l.FV)($n.tF),{openSettings:E}=(0,bc.r)(),[I]=(0,Dc.D)(Ac.Z,{update(e,t){let{data:{deleteTome:o}}=t;(0,rs.h6)(e,o)},optimisticResponse:{__typename:"Mutation",deleteTome:{__typename:"Tome",id:v}}}),{t:S}=(0,y.$G)(),{clientId:k,apolloClient:Z}=(0,H.bp)(),D=r&&!c,M=(0,l.sJ)(j.wo),R=(0,$.ye)($.TT.PDF_GENERATION),{priceType:A,remainingTomeCreationsForOrg:L}=(0,Qs.Z)(),N=null!==A,B=R&&r,F=N&&B,G=!N&&B,z=0!==L,{controlCommandPrompt:W}=(0,Vc.br)(),{data:q}=(0,U.CHH)({variables:{tomeId:v},fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",skip:!D}),K=(null===q||void 0===q||null===(t=q.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.themes)??[],Y=(0,a.useCallback)((()=>{C.push(x,void 0,{shallow:!0}),I({variables:{tomeId:v}}),(0,V.Sd)({message:S("tome.header.tomeMenu.tomeDeletedToastMessage")})}),[C,I,v,x,S]),[J]=(0,Dc.D)(Lc.Z,{update(e,t){let{data:{restoreTome:o}}=t;o&&(0,Rc.W)(e,o)}}),X=(0,a.useCallback)((()=>{J({variables:{tomeId:v}}).then((e=>{let{data:t}=e;if(null!==t&&void 0!==t&&t.restoreTome){const e=new URL(x,"http://tome/");e.searchParams.set("tab","recent"),O(`${e.pathname}${e.search}`),(0,V.ak)({message:S("tome.header.tomeMenu.tomeRestoredToastMessage")})}else(0,V.ak)({message:S("tome.header.tomeMenu.noPermissionToRestoreTomeToastMessage")})})).catch((e=>{(0,V.ak)({message:S("tome.header.tomeMenu.errorOccurredRestoringTomeToastMessage")}),console.error("Error restoring Tome:",e),e.message=`Error restoring Tome: ${e.message}`,s.v.addError(e,{tomeId:v})}))}),[J,O,v,x,S]),Q=(0,Nc.Z)(),ee=(0,a.useCallback)((()=>{u&&Q({tomeId:v,orgId:u,onDuplicateComplete:(e,t)=>{window.Cypress||window.open(t,"_blank")},onDuplicateError:()=>{(0,V.ak)({message:S("tome.header.tomeMenu.permissionDeniedToastMessage")})}})}),[u,Q,v,S]),te=(0,a.useCallback)((()=>{d(!1)}),[d]),{focusOnTitle:oe}=Xs(),ne=(0,a.useCallback)((()=>{c&&T((e=>!e))}),[c,T]),re=(0,a.useCallback)((()=>{b()}),[b]),ie=(0,a.useCallback)((()=>{C.push(x,void 0,{shallow:!0}),E(yc.u.ORGANIZATION)}),[E,C,x]),ae=(0,a.useCallback)((()=>{const e={showLogo:!0};(0,rs.W8)(v,e,Z,k),(0,V.ak)({message:S("tome.header.tomeMenu.logoAppearanceInPlayModeToastMessage")})}),[Z,k,v,S]),le=(0,a.useCallback)((()=>{const e={showLogo:!1};(0,rs.W8)(v,e,Z,k),(0,V.ak)({message:S("tome.header.tomeMenu.logoWillBeHiddenInPlayModeToastMessage")})}),[Z,k,v,S]),se=[],ce=(e=>{let{userIsEditor:t,presentMode:o,shouldShowLogo:n,orgLogoAvailable:r,desiredRecordingState:i,displayAnnotationsOverlays:a,isLoggedIn:l,userCanManage:s,userCanCreatePdf:c,userCanAddLogo:d,userCanUpgradeToCreatePdf:p,userCanUpgradeToAddLogo:u,userCanDuplicateTome:m,deleted:g,commandFn:h}=e;const f=[],b={width:16,height:16,marginRight:8};if(m&&f.push({text:Tc.ZP.t("tome.header.tomeMenuBuilding.duplicateTomeMenuItemLabel"),action:()=>{h(Od.DUPLICATE_TOME)},image:(0,_.jsx)(gd,{style:b})}),t&&!o&&f.push({text:Tc.ZP.t("tome.header.tomeMenuBuilding.renameTomeMenuItemLabel"),action:()=>{h(Od.RENAME_TOME)},image:(0,_.jsx)(pd,{style:b})}),c?f.push({id:"export-to-pdf",text:wd,action:()=>{h(Od.CREATE_PDF)},image:(0,_.jsx)(xd,{style:b})}):p&&f.push({text:wd,action:()=>{h(Od.OPEN_SETTINGS_PLANS)},image:(0,_.jsx)(xd,{style:b}),tag:yd.O.PRO}),t&&!o&&(r?n?f.push({text:Tc.ZP.t("tome.header.tomeMenuBuilding.hideLogoMenuItemLabel"),action:()=>{h(Od.HIDE_LOGO)},image:(0,_.jsx)(Xc,{style:b})}):f.push({text:Tc.ZP.t("tome.header.tomeMenuBuilding.showLogoMenuItemLabel"),action:()=>{h(Od.SHOW_LOGO)},image:(0,_.jsx)(rd,{style:b})}):d?f.push({text:Pd,action:()=>{h(Od.ADD_LOGO)},image:(0,_.jsx)(Kc,{style:b})}):u&&f.push({text:Pd,action:()=>{h(Od.OPEN_SETTINGS_PLANS)},image:(0,_.jsx)(Kc,{style:b}),tag:yd.O.PRO})),o&&!i&&f.push({image:(0,_.jsx)(td,{style:b}),text:Tc.ZP.t("tome.header.tomeMenuBuilding.viewFullscreenMenuItemLabel"),action:()=>{h(Od.ENTER_FULLSCREEN)}}),o){let e=(0,_.jsx)(Xc,{style:b}),t=`${Tc.ZP.t("tome.header.tomeMenuBuilding.hideOverlaysMenuItemLabel")}`;a||(e=(0,_.jsx)(rd,{style:b}),t=`${Tc.ZP.t("tome.header.tomeMenuBuilding.showOverlaysMenuItemLabel")}`),f.push({image:e,text:t,action:()=>{h(Od.TOGGLE_ANNOTATIONS_OVERLAYS)}})}return!l&&o&&(f.push({type:"separator"}),f.push({image:(0,_.jsx)(bd,{style:b}),text:Tc.ZP.t("tome.header.tomeMenuBuilding.signInMenuItemLabel"),action:()=>{h(Od.SIGN_IN)}})),s&&!o&&(f.push({type:"separator"}),g?f.push({type:"option",text:Tc.ZP.t("tome.header.tomeMenuBuilding.restoreMenuItemLabel"),action:()=>{h(Od.RESTORE_TOME)},image:(0,_.jsx)(ld,{style:b})}):f.push({text:Tc.ZP.t("tome.header.tomeMenuBuilding.deleteMenuItemLabel"),action:()=>{h(Od.DELETE_TOME)},variant:"destructive",image:(0,_.jsx)(sd.Z,{style:b})})),f})({deleted:n,userCanManage:p,userCanCreatePdf:F,userCanAddLogo:N,userCanUpgradeToCreatePdf:G,userCanUpgradeToAddLogo:!N,userCanDuplicateTome:z,presentMode:c,isLoggedIn:i,displayAnnotationsOverlays:w,desiredRecordingState:M,shouldShowLogo:f,orgLogoAvailable:h,userIsEditor:r,commandFn:e=>{(e=>{switch(e){case Od.DELETE_TOME:Y();break;case Od.RESTORE_TOME:X();break;case Od.SIGN_IN:te();break;case Od.TOGGLE_ANNOTATIONS_OVERLAYS:ne();break;case Od.ENTER_FULLSCREEN:Hc();break;case Od.ADD_LOGO:ie();break;case Od.SHOW_LOGO:ae();break;case Od.HIDE_LOGO:le();break;case Od.RENAME_TOME:oe();break;case Od.DUPLICATE_TOME:i?ee():te();break;case Od.CREATE_PDF:W({action:Vc.$C.INVOKE_COMMAND,commandId:Uc.EXPORT_TO_PDF});break;case Od.OPEN_SETTINGS_PLANS:E(yc.u.PLANS)}})(e)}});return se.push(...ce),se.length<1?null:(0,_.jsx)(ii.Z,{menuWidth:220,menuPosition:"below",menuAlign:"right",itemsOrFn:se,styles:{display:"flex"},onOpenDropdown:re,exemptContainerClickRefs:[P],rebuildMenuTrigger:K.map((e=>e.id)).join("-").concat(`-active-${m}`),children:(0,_.jsx)(tl,{style:{marginLeft:8,width:40},children:(0,_.jsx)(nl,{"aria-label":S("tome.header.tomeMenu.ariaLabelSettingsButtonText"),variant:"text",style:{padding:"0 6px"},onZ0:!c,icon:(0,_.jsx)(Mc.Z,{style:{width:28,height:28}})})})})};const Td=b.ZP.span.withConfig({displayName:"TryTomeButton__ButtonInner",componentId:"sc-1erbku7-0"})(["display:flex;align-items:center;"]);var Ed=e=>{let{tomeId:t}=e;const{apolloClient:o}=(0,H.bp)(),n=(0,l.sJ)(V.SM),r=(0,l.sJ)(V.Vx),{t:i}=(0,y.$G)(),s=(0,a.useCallback)((()=>{We.ZP.reportTryTomeClickEvent({apolloClient:o,tomeId:t,pageId:r})}),[o,t,r]),c=(0,_.jsx)(tl,{style:{marginLeft:8},children:(0,_.jsxs)(nl,{variant:"text",style:{width:"unset",padding:"0 6px"},onClick:s,children:[(0,_.jsx)(Na.Z,{style:{height:18,width:18}}),(0,_.jsxs)(Td,{children:["\xa0",i("tome.header.tryTomeButton.tryTomeButtonLabel")]})]})}),d=(0,Va.iR)(void 0,"/signup",{utmMedium:"referral",utmSource:n?"public_tome_embedded":"public_tome",utmCampaign:t,utmContent:"public_tome_logo"});return n?(0,_.jsx)("a",{href:d,target:"_blank",children:c}):(0,_.jsx)(La(),{href:d,children:c})};function Id(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Sd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Id(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Id(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var _d=e=>{var t,o,n,r,i;let{tome:s,presentMode:d,expandMode:u,enterPresentMode:m,exitPresentMode:h}=e;const[f,b]=(0,l.FV)(V.Vx),C=(0,g.useRouter)(),{apolloClient:v,clientId:O,workspaceUrl:P,setWorkspaceUrl:w}=(0,H.bp)(),T=(0,I.t2)(),{t:S}=(0,y.$G)(),k=(0,qa.I)(null===s||void 0===s||null===(t=s.org)||void 0===t?void 0:t.logo),Z=(0,l.sJ)(V.SM),D=Ts(),M=(0,l.sJ)(V.GP),R=(0,l.sJ)(j.wo),A=(0,a.useCallback)((e=>e.clientY<108),[]),{isHidden:L,show:N}=_a({visibilityBasedOnMouseEvent:A,timeout:3e3,disabled:!d}),{showCursor:$}=Es({timeout:3e3,disabled:!D}),F=(0,ml.Z)(),[G,z]=(0,l.FV)(V.B8),W=(0,a.useRef)(null),q=(0,c.l)(V.k$),K=(0,a.useRef)(null),{loading:Y,user:J,flags:X,activeMembership:Q}=(0,a.useContext)(xr.Z),ee=!M&&(null===X||void 0===X?void 0:X.offlineReadOnly);(0,a.useEffect)((()=>{ee&&(0,V.ak)({message:S("tome.header.tomeHeader.offlineConnectivityMessage")})}),[ee,S]),(0,a.useEffect)((()=>{d&&q&&(0,V.k$)(!1)}),[d,q]);const te=!(!J||!J.id),{titleEditableLabelRef:oe}=Xs(),ne=(0,a.useCallback)((e=>e===s.title?null:e&&0!==e.length?((0,rs.W8)(s.id,{title:e},v,O),null):s.title),[v,O,s.id,s.title]),re=(0,B.yW)(s.pages,f),{0:ie,1:ae}=(0,a.useState)((0,Pa.zh)(re)),le=re&&(null===(o=re.comments)||void 0===o?void 0:o.length)||0;(0,a.useEffect)((()=>{ae((0,Pa.zh)((0,B.yW)(s.pages,f)))}),[f,s.pages]);const se=(0,a.useCallback)((e=>{(0,js.rf)(C,{pageId:f,showComments:e,openInNewTab:Z})}),[f,C,Z]),ce=(0,a.useCallback)((e=>{e!==f&&"string"===typeof e&&b(e)}),[f,b]);(0,a.useEffect)((()=>{var e;const t=new URL(P,"http://tome/");null!==Q&&void 0!==Q&&Q.org&&(t.pathname=null===(e=Q.org)||void 0===e?void 0:e.slug),w(`${t.pathname}${t.search}`)}),[w,Q,P]);const de=s.currentUserPermission.isAuthor||s.currentUserPermission.canEdit,pe=(0,a.useCallback)((()=>te?((0,V.k$)(!q),T.closePropertyPanel(),q?null:ae(!1)):(se(!0),null)),[q,te,T,se]),ue=(0,a.useCallback)((()=>{te||se(!1),z(!G),T.closePropertyPanel(),q&&(0,V.k$)(!1)}),[q,te,T,se,G,z]),me=(0,a.useCallback)((()=>{(0,V.k$)(!1),z(!1),T.closePropertyPanel()}),[z,T]);(0,a.useEffect)((()=>{d||(N(),$())}),[d,N,$]);const ge=window.innerWidth,he=(0,ul.ZP)("(max-width: 1024px)")?32:48,fe=(ge-2*he)/3,be=L||D||R,ye=(0,a.useMemo)((()=>({animate:{opacity:be?0:1},transition:E.Z2,initial:{opacity:1},exit:{opacity:0}})),[be]),Ce=(0,l.sJ)(V.$s),ve=(0,x.s)(),xe=(0,l._8)((e=>{let{snapshot:t}=e;return()=>{t.getLoadable(Ge.z1).getValue().size>0||(0,Gs.r)()?ve.open():(T.closePropertyPanel(),(0,V.k$)(!1),C.push(P,void 0,{shallow:!0}))}}),[ve,T,C,P]),Oe=(0,_.jsx)(ol,{ref:W,children:(0,_.jsx)(nl,{variant:"text",onClick:ue,style:{width:"unset",padding:"0 6px"},onZ0:!d,children:S("tome.header.tomeHeader.headerShareButtonLabel")})}),Pe=(0,_.jsx)(ol,{children:(0,_.jsx)(nl,{variant:"text",onClick:()=>{gs(s.canonicalUrl),(0,V.ak)({message:S("tome.header.tomeHeader.linkCopiedToastMessage")})},style:{width:"unset",padding:"0 6px"},onZ0:!d,children:S("tome.header.tomeHeader.copyTomeLinkButtonLabel")})}),we=(()=>{var e,t,o;if(s.currentUserPermission.how!==U.TSR.Public&&!Js(s.currentUserPermission))return Oe;if(!0===Y||"undefined"===typeof J||"undefined"===typeof Q)return F?Pe:null;return(null===Q||void 0===Q||null===(e=Q.org)||void 0===e?void 0:e.id)===(null===s||void 0===s||null===(t=s.author)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.id)?Oe:F?Pe:null})(),je=(null===(n=s.org)||void 0===n?void 0:n.showTomeBranding)??!0,{priceType:Te}=(0,Qs.Z)();return(0,_.jsx)(Qa,{$showScrim:!D&&Ce,$presentMode:d,children:(0,_.jsxs)(el,{"data-testid":"tome_header",$pointerEventsEnabled:!R||!d,children:[(0,_.jsx)(p.M,{children:!u&&!D&&(0,_.jsxs)(Ya,Sd(Sd({$gap:he},ye),{},{children:[!d&&te&&(0,_.jsxs)(tl,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:E.Oo,style:{position:"absolute",left:10,zIndex:1},"data-testid":"tome_header_workspace_button",children:[(0,_.jsx)(nl,{"aria-label":S("tome.header.tomeHeader.navigateToWorkspaceButtonLabel"),"data-testid":"navigate_to_workspace",onClick:xe,style:{padding:"2px 6px",width:"32px",minWidth:"32px"},onZ0:!0,icon:(0,_.jsx)(Et.Z,{style:{width:28,height:28}})}),(0,_.jsx)(x.Z,{ref:ve.ref,title:S("tome.header.tomeHeader.leaveThisTomeConfirmationModalTitle"),subtitle:S("tome.header.tomeHeader.ChangesMayNotBeSavedMessageConfirmationModalSubtitle"),dismissible:!0,buttonColor:"default",cancelButtonText:S("tome.header.tomeHeader.leavingTomeCancelButtonLabel"),cancelButtonAction:()=>ve.close(),primaryButtonContent:S("tome.header.tomeHeader.leavingTomeOkButtonLabel"),primaryButtonAction:()=>{T.closePropertyPanel(),(0,V.k$)(!1),C.push(P)}})]},"header_component_for_buttons"),!d&&(0,_.jsx)(jc,{title:s.title,presentMode:d,isEditor:de,renameTome:ne,titleEditableLabelRef:oe,showUpgradeButton:de&&null===Te},"attribution"),k&&d&&(0,_.jsx)(tl,{style:{marginLeft:6},children:(0,_.jsx)(qa.Z,{show:s.showLogo,logo:null===(r=s.org)||void 0===r?void 0:r.logo,theme:re.theme})}),!d&&(0,_.jsx)(tl,{style:{marginLeft:8},children:(0,_.jsx)(oc,{permissions:s.currentUserPermission})}),ee&&(0,_.jsx)(tl,{style:{marginLeft:8},children:(0,_.jsx)(yl,{icon:(0,_.jsx)(Fs,{}),color:"destructive",toolTipContent:S("tome.header.tomeHeader.tooltipReadOnlyMessage"),children:S("tome.header.tomeHeader.offlineConnectivityBadgeLabel")})})]}))}),(0,_.jsx)(p.M,{children:!D&&(0,_.jsx)(Ja,{$presentMode:d,$gap:he,children:d&&!u&&s.pages.length>1&&(0,_.jsx)(tl,{style:{width:"100%"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:E.Oo,children:(0,_.jsx)(Wa,{pageIds:s.pages.map((e=>e.id)),maxComponentWidthPx:fe,activePageId:f,onSegmentClick:b,isMobile:!1,numPages:s.numPages})})})}),(0,_.jsx)(p.M,{children:!u&&!D&&(0,_.jsxs)(Xa,Sd(Sd({$presentMode:d},ye),{},{children:[(0,_.jsx)(uc,{visible:!d,as:ol,children:(0,_.jsx)(Ys,{tomeId:s.id,navigateToPage:ce})}),(0,_.jsx)(Zc,{ref:K,visible:!d,tome:s,toggleCommentsPanel:pe,unreadBadge:ie,commentsCount:le}),we,(0,_.jsx)(jd,{deleted:s.deleted,userIsEditor:de,isLoggedIn:te,presentMode:d,redirectToLogin:se,userCanManage:s.currentUserPermission.canManage,usersOrgId:null===Q||void 0===Q||null===(i=Q.org)||void 0===i?void 0:i.id,tomeThemeId:s.theme.id,orgLogoAvailable:k,shouldShowLogo:s.showLogo,closeOtherPanels:me}),te&&(0,_.jsx)(hc,{presentMode:d,exitPresentMode:h,enterPresentMode:m,permission:s.currentUserPermission}),!te&&je&&(0,_.jsx)(Ed,{tomeId:s.id})]}))}),(0,_.jsx)(ws,{sharingSheetOpen:G,setSharingSheetOpen:z,tome:s,shareButtonRef:W,activePageId:f}),(0,_.jsx)(Vs,{commentsSheetOpen:q,tome:s})]})})},kd=o(9008),Zd=o.n(kd),Dd=o(95636);function Md(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Rd(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Md(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Md(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Ad=e=>{let{tome:t}=e;const o=t.canonicalUrl,n=t.published&&t.description||`by ${t.author.name}`,r=Rd(Rd(Rd(Rd(Rd({"@context":"https://schema.org","@type":"CreativeWork",name:t.title},t.author.name?{author:{name:t.author.name}}:{}),t.author.org?{publisher:{name:t.author.org.name}}:{}),t.published&&t.description?{abstract:t.description}:{}),t.previewImageUrl?{thumbnailUrl:t.previewImageUrl}:{}),{},{url:o});return(0,_.jsxs)(Zd(),{children:[(0,_.jsx)("title",{children:t.title}),!t.published&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("meta",{name:"robots",content:"nofollow, noindex"})}),(0,_.jsx)("meta",{name:"description",content:n}),t.author.name&&(0,_.jsx)("meta",{name:"author",content:t.author.name}),(0,_.jsx)("meta",{property:"og:site_name",content:"Tome"}),(0,_.jsx)("meta",{property:"og:title",content:t.title}),(0,_.jsx)("meta",{property:"og:description",content:n}),(0,_.jsx)("meta",{property:"og:url",content:o}),(0,_.jsx)("link",{rel:"canonical",href:o}),(0,_.jsx)("link",{rel:"preconnect",href:Dd.z}),(0,_.jsx)("link",{rel:"preconnect",href:"https://rum.browser-intake-datadoghq.com/"}),(0,_.jsx)("link",{rel:"preconnect",href:"https://api.segment.io"}),(0,_.jsx)("link",{rel:"preconnect",href:"https://cdn.segment.com"}),(0,_.jsx)("link",{rel:"preconnect",href:Dd.n}),(0,_.jsx)("link",{rel:"preconnect",href:"https://vitals.vercel-insights.com/v1/vitals"}),(0,_.jsx)("link",{rel:"dns-prefetch",href:Dd.z}),(0,_.jsx)("link",{rel:"dns-prefetch",href:"https://rum.browser-intake-datadoghq.com/"}),(0,_.jsx)("link",{rel:"dns-prefetch",href:"https://api.segment.io"}),(0,_.jsx)("link",{rel:"dns-prefetch",href:"https://cdn.segment.com"}),(0,_.jsx)("link",{rel:"dns-prefetch",href:Dd.n}),(0,_.jsx)("link",{rel:"dns-prefetch",href:"https://vitals.vercel-insights.com/v1/vitals"}),(0,_.jsx)("link",{rel:"dns-prefetch",href:"https://media.giphy.com"}),t.previewImageUrl&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("meta",{property:"og:image",content:t.previewImageUrl}),(0,_.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,_.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(r)}})]})};var Ld=e=>{var t,o;let{pages:n,presentMode:r,isMobile:i}=e;const{loading:l,user:s}=(0,a.useContext)(xr.Z),{t:c}=(0,y.$G)(),d=(0,a.useRef)(!1),p=(null===(t=n[0])||void 0===t||null===(o=t.overlay)||void 0===o?void 0:o.videoStatus)===U.Kwn.Ready;(0,a.useLayoutEffect)((()=>{l||r&&!s&&!d.current&&n.length>1&&!p&&(i?(0,V.ak)({message:c("tome.usePageBasedTriggers.tapToLeftAndRightToNavigateToastMessage"),duration:3e3,delay:1e3}):(0,V.ak)({message:c("tome.usePageBasedTriggers.useArrowKeysToNavigateToastMessage"),duration:3e3,delay:1e3}),d.current=!0)}),[r,i,l,s,n.length,p,c])};const Nd="ACTIVE_PAGE:";var Hd=e=>{const t=(0,a.useRef)();(0,a.useEffect)((()=>{t.current=t=>{const o=null===e||void 0===e?void 0:e(t);return"string"===typeof o?(t.returnValue=o,o):t.defaultPrevented?(t.returnValue="",""):o}}),[e]),(0,a.useEffect)((()=>{const e=e=>t.current(e);return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[])};var Vd=function(e){let{id:t,tome:o}=e;const[n,r]=(0,l.FV)(V.Vx),i=(0,l.Zl)(V.pt),s=o.numPages>0?o.pages[0].id:null,c=(0,a.useRef)("");(0,a.useEffect)((()=>{var e;const t=null===(e=o.pages[0])||void 0===e?void 0:e.id;n&&t&&!o.pages.some((e=>e.id===n))&&r(t)}),[o.pages.length]),(0,a.useEffect)((()=>{if(c.current===t)return;const e=(o=window.location.search,new URLSearchParams(o).get(ms));var o;if(null!==e)r(e),c.current=t;else{const e=function(e){const t=Nd+e;let o=localStorage.getItem(t);if(o){localStorage.removeItem(t);try{o=JSON.parse(o)}catch{o={}}o=o.expiry>=(new Date).getTime()?o.pageId:""}else o="";return o}(t);e?(r(e),c.current=t):s&&(r(s),c.current=t)}new URLSearchParams(window.location.search).has("showComments")&&(0,V.k$)(!0),function(e){const t=window.location,o=new URLSearchParams(t.search);let n=!1;if(e.forEach((e=>{o.has(e)&&(o.delete(e),n=!0)})),n){const e=[`${t.origin}${t.pathname}`,o.toString()].filter(Boolean).join("?");h().replace(e,void 0,{shallow:!0})}}(["page","showComments"])}),[t,s,c,r]),(0,a.useEffect)((()=>()=>{r("")}),[r]);const d=(0,a.useCallback)((()=>{!function(e,t){const o=Nd+e,n={pageId:t,expiry:(new Date).getTime()+1e4};localStorage.setItem(o,JSON.stringify(n))}(t,n)}),[n,t]);(0,a.useEffect)((()=>{i([])}),[i]);const p=(0,l._8)((e=>{let{snapshot:t}=e;return e=>{t.getLoadable(Ge.z1).getValue().size>0&&e.preventDefault(),(0,Gs.r)()&&e.preventDefault(),d()}}),[d]);return Hd(p),(0,_.jsx)(_.Fragment,{})},Bd=o(24656),$d=o(36947),Fd=o(87987);var Gd=()=>{const e=(0,c.l)(V.Dm),t=(0,l.rb)(V.uz);return(0,a.useEffect)((()=>{null===e&&t()}),[e,t]),null};function zd(e,t){if(e<Math.ceil(t/2))return[0,t];const o=Math.floor(t/2);return[e-o+1,e+o+1]}var Ud=e=>{let{activePageIndex:t,windowSize:o,data:n,itemSize:r,renderItem:i}=e;const[a,l]=zd(t,o),s=[];for(let c=a;c<Math.min(l,n.length);c++)s.push(i(n[c],c,c*r));return(0,_.jsx)(_.Fragment,{children:s})},Wd=o(86062),qd=o(55204),Kd=o(98982),Yd=o(76166),Jd=o(31678),Xd=o(12329);var Qd=e=>{const{colorScheme:t,annotationContent:o}=e;return(0,_.jsx)(Xd.pT,{"data-testid":"annotation_label_cluster_item",$colorScheme:t,children:(0,_.jsx)(Xd.__,{$colorScheme:t,scale:1,children:(0,_.jsx)("div",{style:{maxWidth:"254px"},children:o})})})};const ep=b.ZP.div.withConfig({displayName:"AnnotationLabelCluster__LabelClusterStyles",componentId:"sc-13ofvmt-0"})(["display:flex;gap:12px;align-items:",";overflow-x:scroll;",""],(e=>e.$topAlign?"flex-start":"flex-end"),ha.Z),tp=b.ZP.div.withConfig({displayName:"AnnotationLabelCluster__ClusterLabelContainer",componentId:"sc-13ofvmt-1"})(["min-width:fit-content;"]);var op=e=>{const{annotations:t,topAlign:o}=e;return(0,_.jsx)(ep,{$topAlign:o,children:t.map((e=>(0,_.jsx)(tp,{children:(0,_.jsx)(Qd,{colorScheme:e.style.colorScheme,annotationContent:e.content})},e.id)))})};const np=(0,a.forwardRef)(((e,t)=>{let{annotations:o,dotSize:n,solidDots:r,onClick:i}=e;const a=Math.floor(n+5)/2;return(0,_.jsx)(Xd.dQ,{ref:t,onClick:i,children:o.slice(0).reverse().map(((e,t)=>(0,_.jsxs)(Xd.bd,{"data-testid":"annotation_dot_cluster_item",$left:(n+5-10)*(o.length-1-t),$size:n+5,children:[(0,_.jsx)(Xd.ni,{r:a-1}),(0,_.jsx)(Xd.HR,{"data-testid":"annotation_dot_cluster_contents",$solid:r,$colorScheme:e.style.colorScheme,r:a-4,"data-tome-bypass-tap-navigation":"AnnotationDotCluster__ClusterDot"})]},e.id)))})}));var rp=np;var ip;!function(e){e.CLOSED="closed",e.ABOVE="above",e.BELOW="below"}(ip||(ip={}));const ap=b.ZP.div.withConfig({displayName:"AnnotationCluster__AnnotationClusterStyles",componentId:"o6k68e-0"})(["height:","px;"],18),lp=b.ZP.div.withConfig({displayName:"AnnotationCluster__LabelPositioner",componentId:"o6k68e-1"})(["position:absolute;z-index:",";padding:",";width:100%;",""],T.Ue,"18px 0 12px",(e=>e.$location===ip.ABOVE?"bottom: 0px;":e.$location===ip.BELOW?"top: 18px;":""));var sp=e=>{const{annotations:t,onActivePage:o}=e,{0:n,1:r}=(0,a.useState)(ip.CLOSED),i=(0,a.useRef)(null);(0,a.useEffect)((()=>{o||r(ip.CLOSED)}),[o]);const l=(0,a.useCallback)((e=>{e.stopPropagation(),r((e=>{var t;if(e!==ip.CLOSED)return ip.CLOSED;const o=(null===(t=i.current)||void 0===t?void 0:t.getBoundingClientRect().top)??0;return window.innerHeight-o>100?ip.BELOW:ip.ABOVE}))}),[]),s=n!==ip.CLOSED;return(0,_.jsxs)(ap,{children:[(0,_.jsx)(rp,{ref:i,annotations:t,dotSize:18,solidDots:!s,onClick:l}),s&&(0,_.jsx)("div",{style:{position:"relative"},children:(0,_.jsx)(lp,{$location:n,children:(0,_.jsx)(op,{annotations:t,topAlign:n===ip.BELOW})})})]})},cp=o(83887),dp=o(67156),pp=o(90370),up=o(27453),mp=o(71652);function gp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function hp(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?gp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):gp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const fp=b.ZP.div.withConfig({displayName:"MobilePage__MobilePageContainerScroller",componentId:"sc-2trv23-0"})(["flex-grow:1;overflow:",";width:100%;","{height:auto;}"],(e=>{let{$isInExpandMode:t}=e;return t?"hidden":"auto"}),mp.f),bp=b.ZP.div.withConfig({displayName:"MobilePage__StackedPage",componentId:"sc-2trv23-1"})(["position:relative;height:fit-content;width:100%;overflow-y:scroll;"]),yp=b.ZP.div.withConfig({displayName:"MobilePage__StackedPageGradient",componentId:"sc-2trv23-2"})(["background-image:",";height:","px;pointer-events:none;position:fixed;top:0;width:100%;z-index:",";"],(e=>{let{theme:t}=e;return t.gradients.headerGradientPresent}),160,T.bf),Cp=b.ZP.div.withConfig({displayName:"MobilePage__PageStyles",componentId:"sc-2trv23-3"})(["height:100%;"," overflow:auto;width:100%;padding-top:","px;padding-bottom:160px;",";"],(e=>{let{$isInExpandMode:t}=e;return t&&(0,b.iv)(["min-height:100vh;"])}),(e=>{let{$globalTomeOverlay:t}=e;return t?110:62}),(e=>{let{$isSingleTextTilePage:t,$isSingleMediaTilePage:o}=e;return(o||t)&&(0,b.iv)(["padding-top:","px;min-height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;"],62)})),vp=b.ZP.div.withConfig({displayName:"MobilePage__Wrapper",componentId:"sc-2trv23-4"})(["margin:",";padding:",";width:100%;"],(e=>`${e.$padding}px 0`),(e=>`0 ${e.$padding}px`)),xp=b.ZP.div.withConfig({displayName:"MobilePage__AnnotationWrapper",componentId:"sc-2trv23-5"})(["margin-bottom:32px;padding:",";width:100%;"],(e=>`0 ${e.$padding}px`)),Op=(e,t)=>{var o,n;let{page:r,preview:i,active:s,isBot:c=!1,isInExpandMode:d,canEdit:p,tomeId:u,sizes:m,isFirstPage:g,pageKind:h}=e;const{apolloClient:f,clientId:b}=(0,H.bp)();(0,Jd.L)(r.theme),(0,a.useEffect)((()=>{!i&&s&&wa.z.reportViewPresence(f,b,u,r.id)}),[s,i,f,b,u,r.id]);const y=(0,up.Z)({tomeId:u,pageId:r.id,pageKind:h,layout:r.layout,tiles:r.tiles,pixelsPerHeightUnit:m.rowSizes.unitRowHeight,rowPadding:m.pageSizes.padding,persistToBackend:!i}),{frontendPageLayout:C}=y,v=1===(null===r||void 0===r||null===(o=r.tiles)||void 0===o?void 0:o.length)&&(null===r||void 0===r?void 0:r.tiles[0].type)===U.YUT.Text,x=1===(null===r||void 0===r||null===(n=r.tiles)||void 0===n?void 0:n.length)&&[U.YUT.Image,U.YUT.Video,U.YUT.Giphy].includes(null===r||void 0===r?void 0:r.tiles[0].type),O=(0,l.Zl)(Ha.R),P=(0,a.useRef)(0),w=(0,a.useRef)(null),j=(0,l.sJ)((0,qd.J)(u)),T=(0,Kd.Z)(m.pageSizes.height);(0,a.useEffect)((()=>{P.current=0,w.current&&(w.current.scrollTop=0)}),[s]);let E=null;if(w.current){const e=w.current.getBoundingClientRect().height,t=w.current.scrollHeight;E=t-e}const I=(0,a.useCallback)((e=>{const t=e.currentTarget,o=null===t||void 0===t?void 0:t.scrollTop;null!==E&&o<=E&&o>=0&&(o>=P.current?O(!1):O(!0),P.current=o)}),[E,O]);(0,a.useEffect)((()=>{const e=w.current;return null===e||void 0===e||e.addEventListener("scroll",I,{passive:!0}),()=>{null===e||void 0===e||e.removeEventListener("scroll",I,{passive:!0})}}),[I,w]);const S=(0,a.useMemo)((()=>(0,Wd.Z)(r.theme.id,r.theme.colors)),[r.theme.id,r.theme.colors]);return(0,_.jsx)(fp,hp(hp({},s?{"data-testid":"active_page"}:{}),{},{$isInExpandMode:d,ref:w,style:{backgroundColor:S.colors.page},children:(0,_.jsxs)(mp.Z,{theme:r.theme,loadFonts:!0,children:[s&&!j&&(0,_.jsx)(cp.Z,{overlayData:r.overlay,pageId:r.id,canEdit:p,tomeId:u,display:!0,pageHeight:m.pageSizes.height,pageWidth:m.pageSizes.width,isMobile:!0,playMode:!1}),(0,_.jsxs)(bp,{ref:t,children:[(0,_.jsx)(yp,{}),(0,_.jsx)(Cp,{$isInExpandMode:d,$isSingleMediaTilePage:v,$isSingleTextTilePage:x,$globalTomeOverlay:j,style:{transition:"opacity 0.5s cubic-bezier(0.33, 1, 0.68, 1)",opacity:c||T?1:0},children:C.tiles.map(((e,t)=>{var o;const{tileId:n}=e,l=null===(o=r.tiles)||void 0===o?void 0:o.find((e=>e.id===n));if(!l)return null;const c=C.rowByTileId(n);if(!c)return null;const d=K.Zp.includes(l.type);let f;f=d?dp.bS:c.row.relativeHeight?c.row.relativeHeight:1;const b=f*dp.Cj*m.rowSizes.unitRowHeight,y=c.isSingleTile()||d?b:2*b;return(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(vp,{style:{height:(0,pp.g)(l.type)!==pp.Y.FIXED?y:"auto"},$padding:m.pageSizes.padding,children:(0,_.jsx)(Yd.n,{canEdit:p,isMobile:!0,isSingle:!0,preview:i,tile:l,tomeId:u,sizes:m,page:r,activeDragInProgress:!1,index:t,isFirstPage:g,isPageActive:s,disableAnnotations:!1,disableExpand:!1,isTileEndpoint:!1,rowIndex:t,tileIndex:0,rowHeight:y,pageKind:h})}),l.annotations&&l.annotations.length>0&&(0,_.jsx)(xp,{$padding:m.pageSizes.padding,children:(0,_.jsx)(sp,{onActivePage:s,annotations:l.annotations})})]},l.id)}))})]})]})}))};var Pp=(0,a.memo)((0,a.forwardRef)(Op)),wp=o(70131);var jp=e=>{let{children:t,shouldObserve:o,threshold:n,onChange:r}=e;return o?(0,_.jsx)(wp.df,{as:"div",threshold:n,onChange:e=>r(e),children:t}):(0,_.jsx)(_.Fragment,{children:t})};var Tp=(e,t)=>{const{prevPage:o,nextPage:n,hasPrevPage:r,hasNextPage:i}=Sa(e),{scrollingPageRef:l}=(0,a.useContext)(M.Z),{currentPageRef:s}=(0,H.TR)();(0,a.useEffect)((()=>{!t&&null!==l&&void 0!==l&&l.current&&(l.current.style.cursor="initial")}),[t,l]);const c=(0,a.useCallback)((e=>{var t;const r=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect();e.clientX<(null===r||void 0===r?void 0:r.left)&&o(),e.clientX>(null===r||void 0===r?void 0:r.right)&&n(),null!==l&&void 0!==l&&l.current&&(l.current.style.cursor="initial")}),[s,n,o,l]),d=(0,a.useCallback)((e=>{var t;const o=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect();null!==l&&void 0!==l&&l.current&&(e.clientX<(null===o||void 0===o?void 0:o.left)&&r?l.current.style.cursor="w-resize":e.clientX>(null===o||void 0===o?void 0:o.right)&&i?l.current.style.cursor="e-resize":l.current.style.cursor="initial")}),[s,i,r,l]),p=(0,a.useCallback)((()=>{null!==l&&void 0!==l&&l.current&&(l.current.style.cursor="initial")}),[l]);return(0,a.useMemo)((()=>({handlePageContainerClick:c,handlePageContainerMouseMove:d,handlePageContainerMouseLeave:p})),[c,p,d])};function Ep(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ip(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ep(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ep(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Sp=b.ZP.div.withConfig({displayName:"TomeSlider__MobileSliderContainer",componentId:"sc-9hehdy-0"})(["display:flex;outline:none;overflow-x:scroll;overflow-y:hidden;scroll-snap-type:x mandatory;::-webkit-scrollbar:horizontal{display:none;}"]),_p=(0,b.ZP)(d.E.div).withConfig({displayName:"TomeSlider__SliderContainer",componentId:"sc-9hehdy-1"})(["outline:none;display:grid;position:absolute;"]),kp=(0,b.iv)(["display:flex;align-items:center;overflow-y:",";"],(e=>{let{$isInExpandMode:t}=e;return t?"hidden":"scroll"})),Zp=b.ZP.div.withConfig({displayName:"TomeSlider__MobilePageContainer",componentId:"sc-9hehdy-2"})([""," display:flex;flex-direction:column;height:100vh;min-width:100vw;overflow-y:hidden;scroll-snap-align:start;scroll-snap-stop:always;width:100vw;"],kp),Dp=b.ZP.div.withConfig({displayName:"TomeSlider__DesktopPageContainer",componentId:"sc-9hehdy-3"})([""," flex-direction:column;position:absolute;display:",";justify-content:center;height:100vh;top:0;bottom:0;"],kp,(e=>e.$active?"inherit":"none")),Mp=a.forwardRef(((e,t)=>{let{tome:o,canEdit:n,useEditablePage:r,presentMode:i,isBot:s,isMobile:d,isInExpandMode:p,width:u,pageVerticalMargin:m,pageContainerWidth:g,pageContainerHeight:h,fullscreenMode:f}=e;const[y,C]=(0,l.FV)(V.Vx),v=(0,l.sJ)(j.wo),x=(0,l.Zl)(V.$s),O=(0,c.l)(V.k6),P=(0,a.useRef)(0),w=(0,B.xh)(o.pages,y)??P.current;P.current=w;const T=u,E=(0,a.useMemo)((()=>Ka._C.fromPageAndWindowDimension(g,h,d)),[g,h,d]),I=(0,a.useRef)(null),S=(0,b.Fg)(),k=(0,a.useRef)(null),Z=(0,G.Z)(y);(0,a.useEffect)((()=>{if(d&&I.current){const e=w*T-I.current.scrollLeft;if(Math.abs(e)<T/2)return;I.current.scrollLeft=w*T,Z!==y&&(k.current=y)}}),[I,d,y,w,T,Z]);let D=-1;if(d&&I.current){const e=I.current.scrollLeft,t=Math.round(e/T);Math.abs(t*T-e)<.1*T&&(D=t)}const R=(0,a.useCallback)((e=>d?{}:{style:{width:"100vw",height:"100vh",transformOrigin:"top",transform:`translate3d(${e}px, 0px, 0px)`,padding:`${m}px 0`}}),[d,m]),A=d?Zp:Dp,L=d?Pp:Fd.ZP,{currentPageRef:N}=(0,H.TR)(),{0:$,1:F}=(0,a.useState)(d?{height:"100%",width:"100%"}:{alignItems:"center",flexDirection:"row",height:"100vh",width:"100vw"});(0,a.useEffect)((()=>{if(d)F({height:"100%",width:"100%"});else{F({alignItems:"center",flexDirection:"row",height:"100vh",transform:`translate3d(${-w*T-T/2}px, -${S.headerHeight}px, 0px)`})}}),[S.headerHeight,d,w,T]);const z=(0,a.useRef)(new Map),U=(0,Oo.Z)(((e,t)=>o=>{null!==o?z.current.set(e,o):z.current.delete(e),t&&!N.current&&(N.current=o)}),[N]);(0,a.useEffect)((()=>{N.current=z.current.get(y)}),[y,N]);const{setScrollingPageRef:W}=(0,a.useContext)(M.Z),q=d?Sp:_p,K=(0,a.useCallback)((e=>{e.target.scrollTop>=m*O-S.headerHeight?x(!0):x(!1)}),[x,m,O,S.headerHeight]);(0,a.useEffect)((()=>{x(!1)}),[y,x]);const{handlePageContainerClick:Y,handlePageContainerMouseMove:J,handlePageContainerMouseLeave:X}=Tp(o.pages,i),Q=i&&!p&&!f&&!d&&!v,ee=zd(w,10);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(q,{"data-testid":"slider_container",style:$,ref:(0,$d.l)([t,I]),children:(0,_.jsx)(Ud,{activePageIndex:w,windowSize:d?Number.MAX_SAFE_INTEGER:10,data:o.pages,itemSize:T,renderItem:(e,t,i)=>{return(0,_.jsx)(jp,{shouldObserve:d,threshold:[.6],onChange:o=>{o&&t!==D&&(k.current===e.id?k.current=null:k.current||C(e.id))},children:(0,_.jsx)(A,Ip(Ip({"data-testid":"page_container",$active:t===w,$isInExpandMode:p,ref:t!==w||d?void 0:W,onClick:Q?Y:void 0,onMouseMove:Q?J:void 0,onMouseEnter:Q?J:void 0,onMouseLeave:Q?X:void 0},R(i)),{},{onScroll:d?void 0:K,children:!d||(a=t,a>=ee[0]&&a<ee[1])?(0,_.jsx)(L,{active:t===w,isBot:s,isVisible:!!d||t===w,isInExpandMode:p,ref:U(e.id,t===w),page:e,canEdit:!d&&n,useEditablePage:!d&&r,tomeId:o.id,sizes:E,isFirstPage:0===t,preview:!1,pageVerticalMargin:m,pageKind:Bd.s.MAIN}):null}),e.id)},e.id);var a}})}),(0,_.jsx)(Gd,{})]})}));var Rp,Ap=Mp,Lp=o(33504);function Np(){return Np=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Np.apply(this,arguments)}var Hp,Vp,Bp=function(e){return a.createElement("svg",Np({width:28,height:28,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Rp||(Rp=a.createElement("path",{d:"M15.094 6.125a1.094 1.094 0 00-2.188 0v6.781H6.125a1.094 1.094 0 000 2.188h6.781v6.781a1.094 1.094 0 102.188 0v-6.781h6.781a1.094 1.094 0 100-2.188h-6.781V6.125z",fill:"#fff"})))};function $p(){return $p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},$p.apply(this,arguments)}var Fp,Gp=function(e){return a.createElement("svg",$p({width:28,height:28,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Hp||(Hp=a.createElement("path",{d:"M14 18.375a4.375 4.375 0 100-8.75 4.375 4.375 0 000 8.75z",fill:"#fff"})),Vp||(Vp=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.5 14c0 5.799-4.701 10.5-10.5 10.5S3.5 19.799 3.5 14 8.201 3.5 14 3.5 24.5 8.201 24.5 14zm-1.75 0a8.75 8.75 0 11-17.5 0 8.75 8.75 0 0117.5 0z",fill:"#fff"})))};function zp(){return zp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},zp.apply(this,arguments)}var Up=function(e){return a.createElement("svg",zp({width:28,height:28,viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Fp||(Fp=a.createElement("path",{d:"M32 8c13.255 0 24 10.745 24 24 0 6.617-5.98 11-13 11h-5c-1.768 0-4 .323-4 3 0 2.627 2 4.28 2 7 0 1.616-1.273 3-4 3C18.745 56 8 45.255 8 32S18.745 8 32 8zm13.5 27a4.5 4.5 0 10-4.5-4.5 4.5 4.5 0 004.5 4.5zm-7-11a4.5 4.5 0 10-4.5-4.5 4.5 4.5 0 004.5 4.5zm-13 0a4.5 4.5 0 10-4.5-4.5 4.5 4.5 0 004.5 4.5zM14 30.5a4.5 4.5 0 109.003.002 4.5 4.5 0 00-9.004-.003l.002.001z",fill:"#fff"})))};function Wp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function qp(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Kp=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,qp(qp({ref:t,style:{width:"1em",height:"1em"},viewBox:"0 0 28 28"},e),{},{children:[(0,_.jsx)("path",{d:"M5.25 8.75C5.25 6.817 6.817 5.25 8.75 5.25H19.25C21.183 5.25 22.75 6.817 22.75 8.75V12.9062C22.75 13.0271 22.6521 13.125 22.5312 13.125H16.625C14.692 13.125 13.125 14.692 13.125 16.625V22.5312C13.125 22.6521 13.0271 22.75 12.9062 22.75H8.75C6.817 22.75 5.25 21.183 5.25 19.25V8.75Z"}),(0,_.jsx)("path",{d:"M20.9094 14.875H16.625C15.6585 14.875 14.875 15.6585 14.875 16.625V20.9094C14.875 21.1043 15.1106 21.2019 15.2484 21.0641L21.0641 15.2484C21.2019 15.1106 21.1043 14.875 20.9094 14.875Z"})]}))));const Yp=["children","selected","Component"];function Jp(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Xp(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Jp(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Jp(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Qp=b.ZP.div.withConfig({displayName:"Toolbarstyles__ToolbarStyles",componentId:"sc-1hfd498-0"})(["margin-right:","px;width:","px;overflow:hidden;z-index:",";position:absolute;top:","px;right:0;display:flex;justify-content:center;pointer-events:none;"],(e=>e.theme.panelSpacing),(e=>e.$width),T.Mf,(e=>-e.theme.headerHeight)),eu=b.ZP.div.withConfig({displayName:"Toolbarstyles__ToolbarInner",componentId:"sc-1hfd498-1"})(["display:flex;flex-direction:column;justify-content:center;"]),tu=b.ZP.div.withConfig({displayName:"Toolbarstyles__IconStyleActiveArea",componentId:"sc-1hfd498-2"})(["padding:6px;display:flex;align-self:center;background:",";border-radius:6px;cursor:pointer;svg{height:28px;width:28px;}svg path{opacity:",";}svg path:not(.ignore-fill){fill:",";}"],(e=>{let{selected:t,theme:o}=e;return t?o.colors.iconSelectedBg:"transparent"}),(e=>{let{selected:t}=e;return t?1:.5}),(e=>e.selected?e.theme.colors.iconSelected:e.theme.colors.icon)),ou=b.ZP.button.attrs((()=>({type:"button"}))).withConfig({displayName:"Toolbarstyles__IconStyleContainer",componentId:"sc-1hfd498-3"})(["border:none;background-color:transparent;padding:4px 0;&:hover{","{background:",";}}"],tu,(e=>{let{selected:t,theme:o}=e;return t?o.colors.iconHoverSeletedBg:o.colors.iconHoverBg})),nu=e=>{let{children:t,selected:o,Component:n=ou}=e,r=(0,i.Z)(e,Yp);return(0,_.jsx)(n,Xp(Xp({selected:o},r),{},{children:(0,_.jsx)(tu,{selected:o,children:t})}))},ru=(0,b.ZP)(ou).withConfig({displayName:"Toolbarstyles__TileIconStyles",componentId:"sc-1hfd498-4"})(["svg path:not(.ignore-fill){fill:",";}&:hover{","{background:",";}}"],(e=>e.selected?e.theme.colors.contentAccent:e.theme.colors.icon),tu,(e=>!e.selected&&e.theme.colors.iconHoverBg));var iu=e=>{let{width:t,height:o}=e;const n=(0,I.t2)(),r=(0,I.f3)(),i=(0,I.xs)(),s=(0,l.Zl)($n.Hl),d=(0,a.useCallback)((e=>{r===e?((0,V.PS)(!1),s(!1),n.closePropertyPanel()):(e===S.Z.ANNOTATION&&s(!0),n.setPropertyPanel(e))}),[r,n,s]),{t:p}=(0,y.$G)(),{toolbarRef:u}=(0,H.TR)(),m=(0,c.l)(V.Dm),{data:g}=(0,zs.a)(Lp.Z,{variables:{id:m},skip:null==m}),h=(0,$.ye)($.TT.ANNOTATIONS),f=g?g.tile:null,[b]=f?(0,K.An)(f.type):[null],C=(0,l.sJ)(V.uz),v=(0,a.useCallback)((()=>{d(S.Z.TILE),C()}),[d,C]),x=f&&b&&(0,_.jsx)(nu,{"data-testid":`${b.label.toLowerCase()}_tile_icon_button`,selected:i(S.Z.TILE),onClick:v,renderTooltip:()=>p("components.toolbar.tileTypeTooltipLabel",{tileTypeLabel:`${null===b||void 0===b?void 0:b.label}`}),disableTooltip:!!r,Component:ru,role:"tab","aria-label":p("components.toolbar.tileTypeLabelText",{tileTypeLabel:`${b.label}`}),"aria-selected":r===S.Z.TILE,children:(0,_.jsx)(b.icon,{style:{width:28,height:28}})},b.label.toLowerCase()),O=(0,_.jsx)(nu,{selected:r===S.Z.ANNOTATION,onClick:()=>{d(S.Z.ANNOTATION),(0,V.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.annotateIconTooltipLabel"),tooltipShortcuts:[(0,sc.C6)(),"A"],role:"tab","aria-selected":r===S.Z.ANNOTATION,children:(0,_.jsx)(Kp,{"data-testid":"annotation_toolbar_icon",style:{height:28,width:28}})},"annotation");return(0,_.jsx)(Qp,{$width:t,"data-testid":"toolbar",style:"number"===typeof o?{height:o}:{},children:(0,_.jsx)(eu,{ref:u,role:"tablist",children:(0,_.jsxs)(ln.Z,{offset:9,placement:"left",style:{pointerEvents:"all"},children:[x,(0,_.jsx)(nu,{selected:r===S.Z.ADD_TILE,onClick:()=>{d(S.Z.ADD_TILE),(0,V.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.addTileTooltipLabel"),tooltipShortcuts:[(0,sc.C6)(),"T"],role:"tab","aria-selected":r===S.Z.ADD_TILE,children:(0,_.jsx)(Bp,{"data-testid":"add_tile_toolbar_icon"})},"add_tile"),(0,_.jsx)(nu,{selected:r===S.Z.RECORD,onClick:()=>{d(S.Z.RECORD),(0,V.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.recordNarrationTooltipLabel"),tooltipShortcuts:[(0,sc.C6)(),"R"],role:"tab","aria-selected":r===S.Z.RECORD,children:(0,_.jsx)(Gp,{"data-testid":"record_toolbar_icon"})},"record"),h&&O,(0,_.jsx)(nu,{selected:r===S.Z.CUSTOMIZE,onClick:()=>{d(S.Z.CUSTOMIZE),(0,V.Dm)(null)},disableTooltip:!!r,renderTooltip:()=>p("components.toolbar.setThemeTooltipLabel"),tooltipShortcuts:[(0,sc.C6)(),"O"],role:"tab","aria-selected":r===S.Z.CUSTOMIZE,children:(0,_.jsx)(Up,{"data-testid":"color_palette_icon"})},"customize")]})})})},au=o(30383),lu=o(43002);const su=e=>{var t;return!!(null===(t=e.target.closest("[data-tome-bypass-tap-navigation]"))||void 0===t?void 0:t.getAttribute("data-tome-bypass-tap-navigation"))};var cu=e=>{let{enabled:t=!1,pages:o}=e;const n=(0,a.useRef)(null),r=(0,l.sJ)(V.Vx),{0:i,1:s}=(0,a.useState)(!1),{0:c,1:d}=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(window.Cypress)return s(!0),()=>{};s(!1),d(!1);const e=setTimeout((()=>{s(!0)}),300);return()=>{clearTimeout(e)}}),[r]);const p=(0,a.useCallback)((e=>{const t=e/window.innerWidth*100;return{leftTap:t<40,rightTap:t>=40}}),[]),u=(0,a.useCallback)((e=>{if(i||(e.preventDefault(),e.stopPropagation()),su(e)&&i)return;e.stopPropagation();const{leftTap:t,rightTap:a}=p(e.pageX);if(t){var l;const e=(0,B.xh)(o,r)||0;null===(l=n.current)||void 0===l||l.scroll({left:window.innerWidth*(e-1)})}if(a){var s;const e=(0,B.xh)(o,r)||0;null===(s=n.current)||void 0===s||s.scroll({left:window.innerWidth*(e+1)})}}),[i,p,o,r]),m=(0,a.useCallback)((e=>{if(su(e))return;const{leftTap:t}=p(e.pageX),n=(0,B.xh)(o,r)||0;d(t&&n>0)}),[p,o,r]),g=(0,a.useCallback)((()=>{d(!1)}),[]);return t?{handleTap:u,handlePointerDown:m,handlePointerUp:g,isHoldingLeft:c,sliderRef:n}:{handleTap:void 0,handlePointerDown:void 0,handlePointerUp:void 0,isHoldingLeft:!1,sliderRef:n}},du=o(15487),pu=o(46253),uu=o(71048),mu=o(93870),gu=o(73199);function hu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}const fu=e=>{let t=Object.assign({},e);return(0,_.jsx)(gu.fC,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?hu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):hu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},t))},bu=gu.xz;function yu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}const Cu=(0,b.ZP)(gu.ck).withConfig({displayName:"Item__StyledItem",componentId:"vw004e-0"})(["display:flex;align-items:center;font-size:",";line-height:","px;font-weight:400;padding:","px 8px;border-radius:","px;transition:background-color 0.075s ease-in-out,color 0.075s ease-in-out;color:",";","{fill:currentColor;}","{color:",";}",""],(e=>e.theme.fontSizes.sm),gn.xW,gn.CN,gn.aX,(e=>(0,gn.Lq)({$disabled:!!e.disabled,theme:e.theme})),Te.K,gn.z9,(e=>(0,gn.zJ)({$disabled:!!e.disabled,theme:e.theme})),(e=>(0,b.iv)(["&[data-highlighted]{outline:none;color:",";background-color:",";}"],(0,gn.VQ)({$disabled:!!e.disabled,theme:e.theme}),(0,gn.jR)({$disabled:!!e.disabled,theme:e.theme})))),vu=(0,a.forwardRef)(((e,t)=>{let o=Object.assign({},e);return(0,_.jsx)(Cu,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?yu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):yu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({ref:t},o))}));var xu=o(53682);const Ou=["portalProps"];function Pu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wu(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Pu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Pu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ju=(0,b.ZP)(gu.VY).withConfig({displayName:"Content__StyledContent",componentId:"sc-1fryxo5-0"})(["",""],xu.D),Tu=(0,a.forwardRef)(((e,t)=>{let o=Object.assign({},e);const{portalProps:n}=o,r=(0,i.Z)(o,Ou);return(0,_.jsx)(gu.Uv,wu(wu({},n),{},{children:(0,_.jsx)(ju,wu({ref:t},r))}))}));var Eu=o(41822),Iu=o(6355);const Su=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__ScrimOverlay",componentId:"avkij0-0"})(["position:fixed;pointer-events:none;inset:0;background-color:",";width:100vw;height:100vh;"],(e=>{let{theme:t}=e;return t.colors.onboardingAutotomeScrim})),_u=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__SpecialModalContent",componentId:"avkij0-1"})(["position:fixed;width:100%;height:100%;overflow:hidden;"]),ku=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__DialogBackground",componentId:"avkij0-2"})(["position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:340px;box-shadow:",";background:",";border-radius:12px;padding:24px;"],(e=>{let{theme:t}=e;return t.colors.panelBoxShadow}),(e=>{let{theme:t}=e;return t.colors.dialogBackground})),Zu=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__HStack",componentId:"avkij0-3"})(["display:flex;flex-direction:row;height:24px;align-items:end;justify-content:space-between;margin-bottom:6px;margin-right:-12px;"]),Du=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__TextAndButtonsContainer",componentId:"avkij0-4"})(["flex-direction:column;display:flex;"]),Mu=b.ZP.h3.withConfig({displayName:"OnboardingAutotomeModalContent__Heading",componentId:"avkij0-5"})(["font-family:",";font-weight:700;font-size:20px;line-height:24px;color:",";margin-block-end:8px;margin-top:0px;margin-bottom:3px;"],(e=>{let{theme:t}=e;return t.fonts.ui}),(e=>{let{theme:t}=e;return t.colors.primaryUiText})),Ru=b.ZP.p.withConfig({displayName:"OnboardingAutotomeModalContent__Text",componentId:"avkij0-6"})(["font-family:",";font-size:16px;margin-top:0px;line-height:130%;margin-block-end:12px;margin-bottom:12px;text-align:left;color:",";"],(e=>{let{theme:t}=e;return t.fonts.ui}),(e=>{let{theme:t}=e;return t.colors.confirmationModalSubtitle})),Au=b.ZP.div.withConfig({displayName:"OnboardingAutotomeModalContent__TextContainer",componentId:"avkij0-7"})(["margin-bottom:12px;"]);var Lu=e=>{let{close:t}=e;const{t:o}=(0,y.$G)();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Su,{}),(0,_.jsx)(_u,{"data-testid":"autotome_onboarding_modal",children:(0,_.jsx)(ku,{children:(0,_.jsxs)(Du,{children:[(0,_.jsxs)(Zu,{children:[(0,_.jsx)(Mu,{children:o("components.onboardingAutotomeModalContent.welcomeModalTitle")}),(0,_.jsx)(nl,{"aria-label":o("components.onboardingAutotomeModalContent.closeButtonLabel"),onClick:t,icon:(0,_.jsx)(Zt.Z,{style:{width:28,height:28,opacity:.4}})})]}),(0,_.jsxs)(Au,{children:[(0,_.jsx)(Ru,{children:o("components.onboardingAutotomeModalContent.toolsAndGeneratingAIContentGuideText")}),(0,_.jsx)(Ru,{children:o("components.onboardingAutotomeModalContent.toCheckoutYourWorkspaceGuideText")})]}),(0,_.jsx)(Ve.Z,{"data-testid":"nux_start_button",size:"large",color:"primary",variant:"contained",onClick:t,children:o("components.onboardingAutotomeModalContent.letsGoButtonLabel")})]})})})]})};function Nu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Hu(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Nu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Nu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Vu=(0,b.ZP)(Iu.fC).withConfig({displayName:"OnboardingAutotomeModal__DialogPortal",componentId:"f4rp31-0"})(["width:100%;height:100%;display:flex;justify-content:center;padding:72px;align-items:flex-end;"]),Bu=(e,t)=>{const[o]=(0,U.H8S)(),{user:n}=(0,a.useContext)(xr.Z),[r,i]=(0,l.FV)(V.e7),{0:s,1:c}=(0,a.useState)(!1),d=(0,a.useCallback)((()=>{c(!0),n&&n.id&&o({variables:{userId:n.id,newUserOnboardingTaskProgress:U.lnN.End},update(e,t){let{data:o}=t;null!==o&&void 0!==o&&o.updateUserAttributes&&e.modify({id:e.identify(n),fields:{attributes(e){var t;return Hu(Hu({},e),null===o||void 0===o||null===(t=o.updateUserAttributes)||void 0===t?void 0:t.attributes)}}})}})}),[o,n]);(0,a.useEffect)((()=>{r||d()}),[r,d]);const p=(0,a.useCallback)((async()=>{c(!1),i(!0)}),[i]);return s?(0,_.jsx)(Vu,{style:{zIndex:T.IT-1},ref:t,children:(0,_.jsx)(Lu,{close:p})}):(0,_.jsx)(_.Fragment,{})};var $u=(0,a.forwardRef)(Bu);const Fu=b.ZP.div.withConfig({displayName:"TapToNavigateFeedbackstyles__TapToNavigateFeedback",componentId:"p2f1x1-0"})(["position:fixed;left:0;top:0;bottom:0;right:0;z-index:",";pointer-events:none;height:100vh;width:40%;opacity:",";transition:opacity 0.2s ease;background:radial-gradient( 86.92% 43.15% at 0% 50%,rgba(0,0,0,1) 0%,rgba(0,0,0,0) 100% );"],T.y$,(e=>{let{visible:t,theme:o}=e;return t?o.colors.tapToNavigateBackOpacity:0}));var Gu=o(37865);var zu=e=>{let{tomeId:t}=e;const o=(0,x.s)(),[n,r]=(0,l.FV)((0,Gu.$)(t));return(0,a.useEffect)((()=>{n&&o.open()}),[n,o]),(0,_.jsx)(x.Z,{ref:o.ref,title:n?n.title:"",subtitle:n?n.subtitle:"",primaryButtonContent:"OK",primaryButtonAction:()=>{r(null),o.close()},buttonColor:"primary",dismissible:!1})},Uu=o(31709);var Wu=e=>{let{triggerTomeRefetch:t}=e;const o=(0,l.sJ)(V.GP),n=(0,G.Z)(o),{documentVisibility:r}=(0,Uu.Z)();return(0,a.useEffect)((()=>{o&&r&&!n&&void 0!==n&&(t(),s.v.addAction("networkReconnectTomeRefetch"))}),[o,n,t,r]),(0,_.jsx)(_.Fragment,{})},qu=o(82175),Ku=o(41100);function Yu(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ju(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Yu(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Yu(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const Xu=(0,b.ZP)(d.E.div).withConfig({displayName:"TomePlaybackOverlay__OverlayWrapper",componentId:"sc-1vcdxeo-0"})(["z-index:",";position:absolute;top:",";right:",";cursor:pointer;"],T.y$,(e=>{let{$isMobile:t}=e;return t?"62px":"24px"}),(e=>{let{$isMobile:t}=e;return t?"12px":"56px"}));function Qu(e){if(!e)return e;const t=new URL(e);return t.search="",t.href}var em=e=>{let{overlayData:t,isMobile:o,pages:n,tomeId:r,sliderRef:i}=e;const[s,c]=(0,l.FV)(V.Vx),d=(0,a.useRef)(null),{0:p,1:u}=(0,a.useState)([]),{0:m,1:g}=(0,a.useState)(!1),h=(0,a.useRef)(),f=(0,a.useRef)();(0,a.useEffect)((()=>{const e=(0,B.xh)(n,s);if(p&&null!==e){var t;const n=p.find((t=>t.pageIndex===e));if(!n)return;const r=n.from/1e3;var o;if(d.current&&Math.abs((null===(t=d.current)||void 0===t?void 0:t.currentTime())-r)>1)m&&(d.current.toggleVideo(),g(!1)),null===(o=d.current)||void 0===o||o.setCurrentTime(r),(m||h.current&&f.current!==e)&&(h.current&&clearTimeout(h.current),f.current=e,h.current=setTimeout((()=>{var e;null===(e=d.current)||void 0===e||e.toggleVideo(),h.current=void 0,f.current=void 0}),500))}}),[s,m,n,p]),(0,a.useEffect)((()=>{fetch("/assets/ymrtyt.vtt").then((e=>e.text())).then((e=>{const t=(0,qu.Q)(e).entries.map(((e,t)=>Ju(Ju({},e),{},{pageIndex:t+1})));u(t)})).catch((e=>{console.error(e)}))}),[]);const b={onTimeUpdate:(0,a.useCallback)((e=>{var t;const r=null===(t=e.target)||void 0===t?void 0:t.currentTime;if(!m)return;const a=null===p||void 0===p?void 0:p.find((e=>{const t=e.from/1e3,o=e.to/1e3;return r>=t&&r<=o}));if(a){const e=(0,B.Bb)(n,a.pageIndex);var l;if(e&&e!==s)if(o)null===(l=i.current)||void 0===l||l.scroll({left:window.innerWidth*a.pageIndex});else c(e)}}),[m,n,p,c,i,o,s])},C=(0,a.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.toggleVideo()}),[]),v=(0,a.useCallback)((e=>{g(e)}),[g]),x=(0,a.useMemo)((()=>function(e){return Ju(Ju({},e),{},{videoThumbnailUrl:Qu(e.videoThumbnailUrl)})}(t)),[t]),{t:O}=(0,y.$G)();return(0,_.jsx)(Xu,{$isMobile:o,onTap:C,children:(0,_.jsx)(Ku.Z,{ref:d,overlayData:x,setPlaybackPlaying:v,isMobile:o,isInRecordMode:!1,shouldBeVisible:!0,shouldAnimateIn:!0,tooltipCopy:O(o?"tome.tomePlaybackOverlay.tapToAutoPlayWithAudioTooltip":"tome.tomePlaybackOverlay.clickToAutoplayWithAudioTooltip"),shouldScaleTooltip:!1,videoProps:b,size:o?Ku.f.SMALL:Ku.f.NORMAL,tomeId:r,forceLoad:o})})},tm=o(111),om=o(50427),nm=o(83809);var rm=()=>{const{getActiveController:e}=(0,a.useContext)(Q.Z),t=(0,c.l)(V.Dm);(0,a.useEffect)((()=>{null===t&&(0,V.WC)(null)}),[t]);return{navigateTileByDirection:(0,l._8)((o=>{let{set:n}=o;return o=>{const r=e();if(t&&r){const e=(0,V.WC)(),{tileId:i,lastIntentionalColumnIdx:a}=r.tileNeighborByDirection(t,o,e);i&&((0,V.Dm)(i),n((0,V.Eq)(i),!0)),(0,V.WC)(a)}}}),[e,t])}},im=o(44566),am=o(12064);function lm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function sm(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?lm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):lm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var cm=()=>{const{scrollingPageRef:e,setPageScrollTopAnimatedToRef:t,setPageScrollAnimationStopRef:o}=(0,a.useContext)(M.Z);return(0,a.useCallback)((n=>{const r=e.current.scrollTop,i=(0,am.j)(r,n,sm(sm({},E.yh),{},{onUpdate:t=>{e.current&&(e.current.scrollTop=t)},onComplete:()=>{t(null),o(null)}}));t(n),o(i.stop)}),[e,t,o])},dm=o(63553);var pm=e=>{let{isInExpandMode:t,enterPresentMode:o,exitPresentMode:n,exitExpandMode:r,tome:i,canEdit:s,presentMode:d,setShowLayoutSelection:p}=e;const{apolloClient:u,clientId:m}=(0,H.bp)(),g=(0,$.ye)($.TT.ANNOTATIONS),[h,f]=(0,l.FV)(V.Vx),[b,C]=(0,l.FV)(V.pt),v=(0,l.rb)($n.Qf),x=(0,l.Zl)($n.Hl),O=(0,l.Zl)($n.tF),{t:P}=(0,y.$G)(),w=(0,I.t2)(),T=(0,I.f3)(),E=(0,c.l)(V.Dm),k=(0,c.l)(V.k$),Z=(0,l.sJ)(j.wo),[D,R]=(0,l.FV)(Le.cm),[A,L]=(0,l.FV)(Le.s5),N=(0,c.l)(V.pm),{controlCommandPrompt:F}=(0,Vc.br)(),{getActiveController:G}=(0,a.useContext)(Q.Z),{navigateTileByDirection:z}=rm(),{scrollingPageRef:U,pageScrollTopAnimatedToRef:W,pageScrollAnimationStopRef:q}=(0,a.useContext)(M.Z),K=cm(),J=(0,a.useCallback)(((e,o)=>{if(t)return;const n=(0,B.xh)(i.pages,h);if(n-1>=0){const e=(0,B.Bb)(i.pages,n-1);f(e),C(o?[n-1]:[])}e.preventDefault()}),[h,t,f,i.pages,C]),X=(0,a.useCallback)(((e,o)=>{var n;if(t)return;const r=(0,B.xh)(i.pages,h);if(r+1<((null===(n=i.pages)||void 0===n?void 0:n.length)||0)){const e=(0,B.Bb)(i.pages,r+1);f(e),C(o?[r+1]:[])}e.preventDefault()}),[h,t,f,i.pages,C]),ee=(0,a.useCallback)((()=>{const e=G();if(E&&e){const t=(0,B.yW)(i.pages,h);(0,nm.A)(E,t,e,w,i.id,u,m)}else b.length>0&&(0,B.sc)(i,b,u,m,C,f)}),[G,E,b,i,h,w,u,m,C,f]),te=(0,a.useCallback)((()=>{(0,B.tv)(i,b,u,m,C,f)}),[i,u,m,b,C,f]),oe=(0,a.useCallback)((e=>{b.length>0&&(e.preventDefault(),(0,B.Y1)(i,b,u,m))}),[b,i,u,m]),ne=(0,a.useCallback)((e=>{b.length>0&&(e.preventDefault(),(0,B.ZB)(i,b,u,m))}),[b,i,u,m]),re=(0,a.useCallback)((e=>{e.preventDefault(),D||A||(n(),r(),null!==T&&w.closePropertyPanel(),null!==E&&(0,V.Dm)(null),C((e=>e.length>0?[]:e)),v())}),[D,A,n,r,T,E,C,v,w]),ie=(0,a.useCallback)((e=>{const t=(0,V.fz)();if(!t)return;const{type:o}=t;switch(o){case"TILE":break;case"PAGE":e.preventDefault(),(0,B.Qy)(i,b,h,u,m,C,f)}}),[i,h,u,m,b,C,f]),ae=(0,a.useMemo)((()=>(0,tm.Z)((()=>{(0,V.ak)({message:P("throttledToastMessage.workSaved")})}),2e3)),[P]),le=(0,a.useCallback)((e=>{e.preventDefault(),ae()}),[ae]),se=(0,l._8)((e=>{let{snapshot:t}=e;return e=>{if(E){var o;const a=null===(o=i.pages)||void 0===o?void 0:o.flatMap((e=>e.tiles)).find((e=>(null===e||void 0===e?void 0:e.id)===E));if(D||!a||"IMAGE"!==a.type&&"GIPHY"!==a.type)if(!A&&a&&"VIDEO"===a.type){var n;const o=t.getLoadable((0,Qe.M)({tileId:E,url:(null===a||void 0===a||null===(n=a.videoTileData)||void 0===n?void 0:n.url)||""})).getValue();(0,Xe.M)(null===a||void 0===a?void 0:a.mediaTileData,o)||L(!0),e.preventDefault()}else a&&"BLANK"===a.type&&(w.setPropertyPanel(S.Z.ADD_TILE),e.preventDefault());else{var r;(0,Y.Gj)(null===a||void 0===a?void 0:a.imageAttributes,null===a||void 0===a||null===(r=a.mediaTileData)||void 0===r?void 0:r.mediaStatus)||R(!0),e.preventDefault()}}}}),[E,i.pages,D,A,R,L,w]),ce=(0,a.useCallback)((e=>{if(e.preventDefault(),!(Z||N||t))if(E)z(dm.y.DOWN);else if(b.length>0)X(e,!0);else if(U.current){var o;null===(o=q.current)||void 0===o||o.call(q);const t=U.current.scrollTop;let n;n=null!=W.current&&W.current>t?W.current:t;const r=(0,V.k6)(),i=U.current.getBoundingClientRect().height,a=Math.floor(U.current.scrollHeight-i/r),l=.5*window.innerHeight/r,s=Math.floor(Math.min(n+l,a));n>=a||t>=s?X(e,!1):K(s)}}),[E,Z,N,t,b.length,U,z,X,q,W,K]),de=(0,a.useCallback)((e=>{if(!(Z||N||t))if(e.preventDefault(),E)z(dm.y.UP);else if(b.length>0)J(e,!0);else if(U.current){var o;null===(o=q.current)||void 0===o||o.call(q);const t=U.current.scrollTop;let n;n=null!=W.current&&W.current<t?W.current:t;const r=(0,V.k6)(),i=.5*window.innerHeight/r,a=Math.floor(Math.max(n-i,0));0===n||t<=a?J(e,!1):K(a)}}),[E,Z,N,t,b.length,U,z,J,q,W,K]),pe=(0,a.useCallback)((e=>{if(!Z&&!N)if(e.preventDefault(),E)z(dm.y.RIGHT);else if(T!==S.Z.ADD_TILE){if(E)return;X(e,!1)}}),[T,Z,N,X,z,E]),ue=(0,a.useCallback)((e=>{if(!Z&&!N)if(e.preventDefault(),E)z(dm.y.LEFT);else if(T!==S.Z.ADD_TILE){if(E)return;e.preventDefault(),J(e,!1)}}),[T,Z,N,J,z,E]),me=(0,a.useCallback)((e=>{e.preventDefault(),C((e=>{var t;const o=Math.min(...e),n=Math.max(...e);if(n<0)return e;const r=[...e];return o<(0,B.xh)(i.pages,h)?r.splice(r.indexOf(o),1):n+1<((null===(t=i.pages)||void 0===t?void 0:t.length)||0)&&r.push(n+1),r.concat()}))}),[h,C,i.pages]),ge=(0,a.useCallback)((e=>{e.preventDefault(),C((e=>{const t=Math.min(...e),o=Math.max(...e);if(t<0||0===o)return e;const n=[...e];return o>(0,B.xh)(i.pages,h)?n.splice(n.indexOf(o),1):n.splice(n.indexOf(t),0,t-1),n.concat()}))}),[h,C,i.pages]),he=(0,a.useCallback)((e=>{e.preventDefault(),F({action:Vc.$C.TOGGLE_IF_AVAILABLE})}),[F]),fe=(0,a.useCallback)((()=>{!s||d||t||(w.setPropertyPanel((e=>e===S.Z.ANNOTATION?null:S.Z.ANNOTATION)),x(T!==S.Z.ANNOTATION))}),[s,d,t,w,x,T]),be=(0,a.useCallback)((()=>{d&&O((e=>!e))}),[d,O]),ye=(0,a.useCallback)((()=>{d||t||(0,V.k$)(!k)}),[k,d,t]),Ce=(0,a.useCallback)((()=>{p(!0)}),[p]),ve=(0,a.useCallback)((()=>{d&&Hc()}),[d]),xe=(0,a.useCallback)((()=>{!s||d||t||w.setPropertyPanel((e=>e===S.Z.RECORD?null:S.Z.RECORD))}),[s,t,d,w]),Oe=(0,a.useCallback)((()=>{!s||d||t||w.setPropertyPanel((e=>e===S.Z.CUSTOMIZE?null:S.Z.CUSTOMIZE))}),[s,t,d,w]),Pe=(0,a.useCallback)((e=>{!s||d||t||(e.preventDefault(),T===S.Z.ADD_TILE?w.closePropertyPanel():(w.setPropertyPanel(S.Z.ADD_TILE),(0,V.Dm)(null)))}),[s,d,t,T,w]),we=(0,a.useMemo)((()=>{const e=new Map;return e.set("down",{callback:ce,enableKeybindingInEditableElements:!1}),e.set("up",{callback:de,enableKeybindingInEditableElements:!1}),e.set("right",{callback:pe,enableKeybindingInEditableElements:!1}),e.set("left",{callback:ue,enableKeybindingInEditableElements:!1}),e.set("esc",{callback:re,enableKeybindingInEditableElements:!1}),s&&(e.set(["backspace","del"],{callback:ee,enableKeybindingInEditableElements:!1}),e.set("mod+k",{callback:he,enableKeybindingInEditableElements:!0}),e.set("mod+c",{callback:oe,enableKeybindingInEditableElements:!1}),e.set("mod+x",{callback:ne,enableKeybindingInEditableElements:!1}),e.set("mod+v",{callback:ie,enableKeybindingInEditableElements:!1}),e.set("mod+d",{callback:e=>{e.preventDefault(),te()},enableKeybindingInEditableElements:!0}),e.set("mod+z",{callback:e=>{e.preventDefault(),(0,om.Y)(u,m)},enableKeybindingInEditableElements:!1}),e.set("shift+mod+z",{callback:e=>{e.preventDefault(),(0,om.K)(u,m)},enableKeybindingInEditableElements:!1}),e.set("mod+s",{callback:le,enableKeybindingInEditableElements:!0}),e.set("enter",{callback:se,enableKeybindingInEditableElements:!1}),e.set(["shift+down","shift+right"],{callback:me,enableKeybindingInEditableElements:!1}),e.set(["shift+up","shift+left"],{callback:ge,enableKeybindingInEditableElements:!1}),g&&e.set("alt+a",{callback:fe,enableKeybindingInEditableElements:!0}),e.set("alt+h",{callback:be,enableKeybindingInEditableElements:!0}),e.set("alt+m",{callback:ye,enableKeybindingInEditableElements:!0}),e.set("alt+n",{callback:Ce,enableKeybindingInEditableElements:!0}),e.set("alt+p",{callback:o,enableKeybindingInEditableElements:!0}),e.set("alt+f",{callback:ve,enableKeybindingInEditableElements:!0}),e.set("alt+r",{callback:xe,enableKeybindingInEditableElements:!0}),e.set("alt+t",{callback:Pe,enableKeybindingInEditableElements:!0}),e.set("alt+o",{callback:Oe,enableKeybindingInEditableElements:!0})),e}),[ce,de,pe,ue,re,s,ee,he,le,se,me,ge,g,fe,be,ye,Ce,o,ve,xe,Pe,Oe,oe,ne,ie,te,u,m]);return(0,_.jsx)(im.a,{bindings:we})},um=o(26072),mm=o(62090),gm=o(36902),hm=o(24978),fm=o(14961),bm=o(71179),ym=o(50591),Cm=o(11209),vm=o(8557),xm=o(57903),Om=o(26705),Pm=o(97297);function wm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function jm(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?wm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):wm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Tm=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,jm(jm({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32 8H32C45.2548 8 56 18.7452 56 32C56 38.6167 50.0207 43 43 43H38C36.2316 43 34 43.3231 34 46C34 48.6266 36 50.28 36 53C36 54.6164 34.7273 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8H32ZM45.5 35C47.9853 35 50 32.9853 50 30.5C50 28.0147 47.9853 26 45.5 26C43.0147 26 41 28.0147 41 30.5V30.4999C41 32.9849 43.0143 34.9995 45.4993 34.9999L45.5 35ZM38.5005 24C40.9858 24 43.0005 21.9853 43.0005 19.5C43.0005 17.0147 40.9858 15 38.5005 15C36.0152 15 34.0005 17.0147 34.0005 19.5V19.4999C34.0005 21.985 36.0149 23.9996 38.5 23.9999L38.5005 24ZM25.5005 24H25.5005C27.9858 24 30.0005 21.9853 30.0005 19.5C30.0005 17.0147 27.9858 15 25.5005 15C23.0152 15 21.0005 17.0147 21.0005 19.5V19.4999C21.0005 21.9849 23.0148 23.9995 25.4998 23.9999L25.5005 24ZM14.0005 30.5C14.0005 32.9853 16.0152 35 18.5005 35C20.9858 35 23.0005 32.9853 23.0005 30.5C23.0005 28.0147 20.9858 26 18.5005 26C16.0152 25.9994 14 28.0136 13.9994 30.4989C13.9994 30.4992 13.9994 30.4995 13.9994 30.4998L14.0005 30.5Z"})}))));function Em(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Im(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Em(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Em(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Sm=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,Im(Im({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsxs)("g",{children:[(0,_.jsx)("path",{d:"M32 42C37.5228 42 42 37.5228 42 32C42 26.4772 37.5228 22 32 22C26.4772 22 22 26.4772 22 32C22 37.5228 26.4772 42 32 42Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M56 32C56 45.2548 45.2548 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8C45.2548 8 56 18.7452 56 32ZM52 32C52 43.0457 43.0457 52 32 52C20.9543 52 12 43.0457 12 32C12 20.9543 20.9543 12 32 12C43.0457 12 52 20.9543 52 32Z"})]})})))),_m=o(30829),km=o(9576),Zm=o(4794);var Dm=e=>{let{onClick:t,debounceDurationMs:o=1e3*Zm.jy}=e;const n=(0,a.useRef)(!1);return()=>{n.current||(null===t||void 0===t||t(),n.current=!0,setTimeout((()=>{n.current=!1}),o))}};const Mm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandLayout__CommandLayoutContainer",componentId:"azm0su-0"})(["width:100%;height:100%;cursor:",";"],(e=>{let{$pointerCursor:t}=e;return t?"pointer":void 0})),Rm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandLayout__CommandLayoutInnerContainer",componentId:"azm0su-1"})(["display:flex;flex-direction:row;align-items:center;position:absolute;inset:2px 0;"]);var Am=e=>{let{onClick:t,children:o}=e;const n=Dm({onClick:t});return(0,_.jsx)(Mm,{$pointerCursor:!!t,onClick:t?n:void 0,children:(0,_.jsx)(Rm,{children:o})})};const Lm=24,Nm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__IconContainer",componentId:"sc-1sp1xrd-0"})(["flex-shrink:0;display:flex;align-items:center;justify-content:end;width:","px;"],38),Hm=(0,b.ZP)(Nm).withConfig({displayName:"CommandTitle__ActionIconContainer",componentId:"sc-1sp1xrd-1"})(["position:absolute;right:","px;opacity:",";"],10,(e=>{let{$viewAs:t,$isFocusedInRootMode:o}=e;return t!==zm.ROOT||o?1:0})),Vm=b.ZP.span.withConfig({displayName:"CommandTitle__FallbackText",componentId:"sc-1sp1xrd-2"})(["color:",";font-weight:500;"],(e=>{let{theme:t}=e;return t.colors.commandPromptControlTextFallback})),Bm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__CommandTitleContainer",componentId:"sc-1sp1xrd-3"})(["line-height:20px;display:flex;align-items:center;width:100%;height:100%;color:",";cursor:",";gap:","px;border-radius:",";background-color:",";&:hover{color:",";}& > "," > svg{width:","px;height:","px;fill:",";}&:hover > "," > svg{fill:",";}"],(e=>{let{theme:t}=e;return t.colors.commandPromptListCommandLabel}),(e=>{let{$viewAs:t}=e;return t!==zm.ROOT?"pointer":void 0}),12,(e=>{let{$viewAs:t,$isFocusedInRootMode:o,theme:n}=e;return t===zm.ROOT&&o?n.borderRadius.xs:0}),(e=>{let{$viewAs:t,$isFocusedInRootMode:o,theme:n}=e;return t===zm.ROOT&&o?n.colors.commandPromptFocusedListItem:"transparent"}),(e=>{let{theme:t,$viewAs:o}=e;return o!==zm.ROOT?t.colors.commandPromptListCommandLabelHover:t.colors.commandPromptListCommandLabel}),Nm,Lm,Lm,(e=>{let{theme:t}=e;return t.colors.commandPromptListCommandLabel}),Nm,(e=>{let{theme:t,$viewAs:o}=e;return o!==zm.ROOT?t.colors.commandPromptListCommandLabelHover:t.colors.commandPromptListCommandLabel})),$m=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__TitleContainer",componentId:"sc-1sp1xrd-4"})([""," font-size:","px;"],si.wR,15),Fm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandTitle__TitleAndTagContainer",componentId:"sc-1sp1xrd-5"})(["display:flex;gap:","px;align-items:center;max-width:calc( 100% - 2 * ","px - ","px - ","px );"],6,38,12,10);let Gm,zm;!function(e){e[e.NONE=0]="NONE",e[e.BETA=1]="BETA",e[e.PRO=2]="PRO"}(Gm||(Gm={})),function(e){e[e.ROOT=0]="ROOT",e[e.SCOPED=1]="SCOPED",e[e.OUTLINE_EDITOR=2]="OUTLINE_EDITOR"}(zm||(zm={}));var Um=e=>{let{Icon:t,ActionIcon:o,title:n,viewAs:r,isFocusedInRootMode:i,tag:l,disableTitleAnimations:s=!1,fallbackString:c="",showEllipsis:p=!1,onClick:u}=e;const m=(0,a.useMemo)((()=>(0,d.E)(t)),[t]),g=(0,a.useMemo)((()=>o?(0,d.E)(o):null),[o]),h=r===zm.ROOT,f=r===zm.SCOPED,b=r===zm.OUTLINE_EDITOR;let y="12px";f?y="8px":b&&(y="0px");const C={width:h?"24px":"20.808px",height:h?"24px":"20.808px"},v=h?"auto":"none",x={fontSize:h?"15px":"13.004999999999999px"},O={gap:h?"6px":"4px"},P={opacity:f?0:1,rotate:f?90:0,scale:f?.4166666666666667:1,x:f?6:0},w=p?"...":"",j=c&&h?(0,_.jsxs)(Vm,{children:[" ",c]}):null,T=(0,_.jsxs)(_.Fragment,{children:[n,j,w]}),E=Dm({onClick:u}),I=(e=>{switch(e){case Gm.BETA:return(0,_.jsx)(vt.Ur,{});case Gm.PRO:return(0,_.jsx)(vt.gQ,{});default:return null}})(l);return(0,_.jsxs)(Bm,{initial:!1,animate:{gap:y},transition:s?Zm.YB:Zm.TP,onClick:E||void 0,$viewAs:r,$isFocusedInRootMode:i,children:[(0,_.jsx)(Nm,{style:{pointerEvents:v},children:(0,_.jsx)(m,{transition:s?Zm.YB:Zm.TP,initial:!1,animate:C})}),(0,_.jsxs)(Fm,{initial:!1,animate:O,transition:s?Zm.YB:Zm.TP,children:[(0,_.jsx)($m,{transition:s?Zm.YB:Zm.TP,initial:!1,animate:x,children:T}),I]}),g&&(0,_.jsx)(Hm,{$isFocusedInRootMode:i,$viewAs:r,style:{pointerEvents:v},children:(0,_.jsx)(g,{transition:Zm.b4,initial:!1,animate:P})})]})},Wm=o(96160),qm=o(35062);const Km=2e3,Ym=(0,b.ZP)(d.E.span).withConfig({displayName:"CommandStatus__StatusWrapper",componentId:"sc-1f8dqqu-0"})(["white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin-right:48px;color:",";"],(e=>{let{theme:t}=e;return t.colors.commandPromptStatusText})),Jm=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandStatus__Background",componentId:"sc-1f8dqqu-1"})(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;min-width:320px;max-width:max-content;font-size:17px;line-height:26px;height:68px;padding:20px 24px;"]);var Xm=e=>{let{content:t,status:o,action:n}=e;const r=o===Wm.z.ACTION;return(0,_.jsxs)(Jm,{layout:!0,style:{paddingRight:r?12:24},transition:Zm.TP,children:[(0,_.jsx)(Ym,{layout:"position",children:t}),(o===Wm.z.COMPLETE||o===Wm.z.PROGRESS)&&(0,_.jsx)(qm.Z,{status:o}),r&&n]})};function Qm(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function eg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Qm(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Qm(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var tg=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,eg(eg({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32 12C32 10.8954 32.8954 10 34 10H46C50.4183 10 54 13.5817 54 18V31C54 35.4183 50.4183 39 46 39H16.8284L24.4142 46.5858C25.1953 47.3668 25.1953 48.6332 24.4142 49.4142C23.6332 50.1953 22.3668 50.1953 21.5858 49.4142L10.5858 38.4142C9.80474 37.6332 9.80474 36.3668 10.5858 35.5858L21.5858 24.5858C22.3668 23.8047 23.6332 23.8047 24.4142 24.5858C25.1953 25.3668 25.1953 26.6332 24.4142 27.4142L16.8284 35H46C48.2091 35 50 33.2091 50 31V18C50 15.7909 48.2091 14 46 14H34C32.8954 14 32 13.1046 32 12Z"})})))),og=o(23969);var ng=e=>{let{subscriptionId:t,onComplete:o,onError:n}=e;return(0,U.s9r)({variables:{subscriptionId:t},onData(e){var t;let{data:r}=e;const i=null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.pdfGenerationStatus;if(i)if("PdfGenerationProgress"===i.__typename){if(i.progressType===U.e1y.Complete)o(i)}else"PdfGenerationError"===i.__typename&&n()}}),(0,_.jsx)(_.Fragment,{})};const rg=(e,t)=>{let o;switch(e){case Wm.z.PROGRESS:o=Tc.ZP.t("commandPrompt.exportToPdf.generationProgress");break;case Wm.z.COMPLETE:o=Tc.ZP.t("commandPrompt.exportToPdf.generationComplete");break;case Wm.z.ACTION:case Wm.z.NONE:o=t?Tc.ZP.t("commandPrompt.exportToPdf.generationError"):""}return o};var ig={id:Uc.EXPORT_TO_PDF,title:Tc.ZP.t("commandPrompt.exportToPdf.commandTitle").toString(),Component:e=>{let{title:t,mode:o,changePromptMode:n,contributeCommandHandler:r,tomeId:i,isFocusedInRootMode:l,onComplete:s,setCommandState:c,generationStatus:d,errorHappened:p,subscriptionId:u,setBlockCommandPromptToggle:m}=e;const{apolloClient:g}=(0,H.bp)(),{priceType:h}=(0,Qs.Z)(),f=null===h,b=()=>{c({generationStatus:Wm.z.NONE,errorHappened:!0,subscriptionId:void 0}),setTimeout((()=>{s()}),Km)},y=e=>{(0,wi.L)(!!e,"No downloadUrl provided for create PDF",{tomeId:i}),e&&function(e){const t=document.createElement("a");t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}(e),c({generationStatus:Wm.z.COMPLETE,subscriptionId:void 0}),setTimeout((()=>{s()}),Km)},[C]=(0,U.Rv8)({onError:b}),{openSettings:v}=(0,bc.r)(),x=(0,a.useCallback)((e=>{let{wasDirectlyInvoked:t}=e;if(f)return v(yc.u.PLANS),s(),!0;We.ZP.reportPdfGeneration({apolloClient:g,initiator:t?We.RM.TOME_MENU:We.RM.COMMAND_PROMPT,tomeId:i}),m(!0);const o=Pi()();return c({generationStatus:Wm.z.PROGRESS,errorHappened:!1,subscriptionId:o}),C({variables:{subscriptionId:o,tomeId:i}}),n(og.q$.DELEGATE),!0}),[g,n,f,s,v,C,m,c,i]);(0,a.useEffect)((()=>{r(x)}),[r,x]);let O=null;switch(o){case og.q$.ROOT:O=(0,_.jsx)(Am,{onClick:()=>x({stringValue:"",jsonValue:um.yS,wasDirectlyInvoked:!1}),children:(0,_.jsx)(Um,{Icon:xd,ActionIcon:tg,title:t,viewAs:zm.ROOT,isFocusedInRootMode:l,tag:f?Gm.PRO:Gm.NONE})});break;case og.q$.SCOPED:O=null;break;case og.q$.DELEGATE:O=(0,_.jsxs)(_.Fragment,{children:[u&&(0,_.jsx)(ng,{onError:b,onComplete:e=>{const t=e.downloadUrl;y(t)},subscriptionId:u}),(0,_.jsx)(Xm,{content:rg(d??Wm.z.NONE,p??!1),status:d??Wm.z.NONE})]})}return O},featureFlag:$.TT.PDF_GENERATION};function ag(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function lg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ag(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ag(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var sg=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,lg(lg({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M30 24C30 22.8954 30.8954 22 32 22C33.1046 22 34 22.8954 34 24V30H40C41.1046 30 42 30.8954 42 32C42 33.1046 41.1046 34 40 34H34V40C34 41.1046 33.1046 42 32 42C30.8954 42 30 41.1046 30 40V34H24C22.8954 34 22 33.1046 22 32C22 30.8954 22.8954 30 24 30H30V24Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 22C8 17.5817 11.5817 14 16 14H48C52.4183 14 56 17.5817 56 22V42C56 46.4183 52.4183 50 48 50H16C11.5817 50 8 46.4183 8 42V22ZM12 22C12 19.7909 13.7909 18 16 18H48C50.2091 18 52 19.7909 52 22V42C52 44.2091 50.2091 46 48 46H16C13.7909 46 12 44.2091 12 42V22Z"})]}))));const cg=(0,a.createContext)(null);function dg(e){let{children:t,value:o}=e;return(0,_.jsx)(cg.Provider,{value:o,children:t})}function pg(){const e=(0,a.useContext)(cg);if(void 0===e)throw new Error("useCommandContext must be used within a CommandContextProvider");return e}const ug=e=>{switch(e){case og.q$.ROOT:return zm.ROOT;case og.q$.SCOPED:return zm.SCOPED;default:throw new Error("convertModeToCommandTitleViewAs should only \n        be used to convert ROOT and SCOPED modes to \n        their corresponding CommandTitleViewAs values. \n        Since each delegate mode can render arbitrary \n        content, callsites should specify the appropriate \n        CommandTitleViewAs type.")}};var mg=e=>{let{Icon:t,ActionIcon:o=tg,commandHandler:n}=e;const{contributeCommandHandler:r,isFocusedInRootMode:i,onComplete:l,title:s,mode:c}=pg(),d=(0,a.useCallback)((()=>(n(),l(),!0)),[n,l]);return(0,a.useEffect)((()=>{r(d)}),[r,d]),(0,_.jsx)(Am,{onClick:d,children:(0,_.jsx)(Um,{Icon:t,ActionIcon:o,title:s,viewAs:ug(c),isFocusedInRootMode:i,tag:Gm.NONE})})};var gg={id:Uc.NEW_PAGE,title:"New page",Component:()=>{const e=(0,l.Zl)(V.xi),t=(0,l.Zl)(V.RE),o=(0,a.useCallback)((()=>{e(!0),t(!0)}),[t,e]);return(0,_.jsx)(mg,{Icon:sg,commandHandler:o})},keywords:Tc.ZP.t("commandPrompt.addPage.keywords",{returnObjects:!0})},hg=o(8794);function fg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function bg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?fg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):fg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var yg=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,bg(bg({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 13C10.6863 13 8 15.6863 8 19V35C8 38.3137 10.6863 41 14 41H18V45C18 48.3137 20.6863 51 24 51H50C53.3137 51 56 48.3137 56 45V29C56 25.6863 53.3137 23 50 23H46V19C46 15.6863 43.3137 13 40 13H14ZM42 23V19C42 17.8954 41.1046 17 40 17H14C12.8954 17 12 17.8954 12 19V35C12 36.1046 12.8954 37 14 37H18V29C18 25.6863 20.6863 23 24 23H42ZM24 27C22.8954 27 22 27.8954 22 29V45C22 46.1046 22.8954 47 24 47H50C51.1046 47 52 46.1046 52 45V29C52 27.8954 51.1046 27 50 27H24Z"})})))),Cg=o(77493),vg=o(94430);var xg=function(){const{apolloClient:e}=(0,H.bp)();return(0,a.useCallback)((t=>e.readFragment({id:`Tome:${t}`,fragment:U.AKG,fragmentName:"TomeFragment",variables:{fetchFullPage:!0,prefetchPreviewImage:!1}})),[e])};function Og(e){let{onError:t,onSubscriptionStart:o}=e;const n=xg(),[r]=(0,U.xIX)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateSinglePage)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(U.EaV.ApiError)}});return(0,l._8)((e=>{let{snapshot:t}=e;return async e=>{var i;let{prompt:a,tomeId:l,imageStyle:s}=e;const c=n(l),d=t.getLoadable(V.Vx).getValue();if(!c)return;const p=(0,B.xh)(c.pages,d),u=null===p?(null===(i=c.pages)||void 0===i?void 0:i.length)||0:p+1,m=(0,du.pp)(u,c.pages),{tomeTitle:g,pageText:h,pageTitle:f}=function(e){var t,o;let n,r,{tomeTitle:i,page:a}=e;const l=null===a||void 0===a||null===(t=a.tiles)||void 0===t?void 0:t.filter((e=>"TEXT"===e.type))[0];if(l&&null!==(o=l.textTileData)&&void 0!==o&&o.content){const e=JSON.parse(l.textTileData.content),t=e.filter((e=>"heading"===e.type)).sort(((e,t)=>e.level-t.level))[0];try{n=Cg.NB.string(t)}catch(s){}try{const t=n||"";r=(0,vg.Q)(e).replace(t,"").slice(0,2e3)}catch(s){}}return{tomeTitle:i===rs.GW?void 0:i,pageText:r,pageTitle:n}}({tomeTitle:c.title,page:c.pages[p??0]}),b=(0,xi.Z)();o(b),r({variables:{requestId:b,tomeId:c.id,pageOrder:m,promptContext:{prompt:a,tomeTitle:g,prevPageText:h,prevPageTitle:f},imageStyle:s.getWireImageStyle()}})}}),[n,o,r])}var Pg=o(84562),wg=o(7289);const jg=(e,t)=>{const o=[{type:"label",text:Tc.ZP.t("commandPrompt.dropdownOptions.imageArtStyleMenuLabel"),paddingVertical:5,paddingHorizontal:8}];return wg.O.getValues().forEach((n=>{n!==wg.O.NONE&&o.push({type:"option",id:n.getWireImageStyle(),text:n.getMenuText(),action:()=>e(n),checked:t===n,noSelectedBackground:!0})})),o.push({type:"separator"}),o.push({type:"option",id:U.Hnc.None,text:wg.O.NONE.getMenuText(),action:()=>e(wg.O.NONE),checked:t===wg.O.NONE,noSelectedBackground:!0}),o};var Tg=o(12164);var Eg=e=>{let{text:t}=e;return(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{children:t}),(0,_.jsx)(Tg.Z,{})]})};const Ig=(0,b.ZP)(ue.Z).attrs({width:"10",height:"10",viewBox:"0 0 10 10"}).withConfig({displayName:"CommandControlDropdown__DropdownArrow",componentId:"maq4tm-0"})(["align-self:middle;display:inline-flex;stroke:currentColor;flex-shrink:0;"]),Sg=b.ZP.div.withConfig({displayName:"CommandControlDropdown__Row",componentId:"maq4tm-1"})(["display:flex;flex-direction:row;gap:6px;align-items:center;"]),_g=(0,b.ZP)(ii.Z).withConfig({displayName:"CommandControlDropdown__StyledDropdownMenu",componentId:"maq4tm-2"})(["cursor:pointer;background:",";color:",";border-radius:",";width:100%;flex:0;padding:6px 6px 6px 8px;transition:background 0.2s ease-out,color 0.2s ease-out;&:hover{background:",";color:",";}"],(e=>{let{theme:t}=e;return t.colors.commandPromptControlBackground}),(e=>{let{theme:t,opened:o}=e;return o?t.colors.commandPromptControlTextActive:t.colors.commandPromptControlText}),(e=>{let{theme:t}=e;return t.borderRadius.xs}),(e=>{let{theme:t}=e;return t.colors.commandPromptControlBackgroundHover}),(e=>{let{theme:t,opened:o}=e;return o?t.colors.commandPromptControlTextActive:t.colors.commandPromptControlTextHover})),kg=(0,b.ZP)(Iu.fC).withConfig({displayName:"CommandControlDropdown__DropdownClickBlockingOverlay",componentId:"maq4tm-3"})(["position:absolute;inset:0;pointer-events:auto;width:100%;height:100%;"]),Zg=b.ZP.div.withConfig({displayName:"CommandControlDropdown__Name",componentId:"maq4tm-4"})(["line-height:14px;font-size:",";text-transform:capitalize;white-space:nowrap;"],(e=>{let{theme:t}=e;return t.fontSizes.sm}));var Dg=e=>{let{items:t,activeText:o,width:n,dataTestId:r,focusInput:i}=e;const{0:l,1:s}=(0,a.useState)(!1),c=(0,a.useCallback)((()=>{s(!0)}),[s]),d=(0,a.useCallback)((()=>{s(!1),i()}),[s,i]);return(0,_.jsxs)(_.Fragment,{children:[l&&(0,_.jsx)(kg,{"data-testid":"dropdown_overlay",style:{zIndex:T.bf}}),(0,_.jsx)(_g,{opened:l,onCloseDropdown:d,onOpenDropdown:c,dataTestId:r,menuWidth:n,menuPosition:"above",menuAlign:"left",itemsOrFn:t,styles:{zIndex:T.m6},additionalSpacing:-8,children:(0,_.jsxs)(Sg,{children:[(0,_.jsx)(Zg,{children:o}),(0,_.jsx)(Ig,{})]})})]})};var Mg=e=>{let{pageGenerationSubscriptionId:t,setNumPagesGenerated:o,onComplete:n,onError:r,onProgress:i}=e;const a=(0,l.Zl)(V.Vx),s=(0,l.Zl)(V.pt);return(0,U.RlJ)({variables:{requestId:t},onData(e){var t;let{data:l}=e;const c=null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.tomeGenerationStatus;if(c)if("TomeGenerationProgress"===c.__typename)switch(c.progressType){case U.xGj.Started:o(0);break;case U.xGj.InProgress:null===i||void 0===i||i(c),null!==c.numPagesGenerated&&void 0!==c.numPagesGenerated&&o(c.numPagesGenerated),c.currentPageId&&(a(c.currentPageId),(0,V.Dm)(null),s((e=>e.length>0?[]:e)));break;case U.xGj.Complete:n()}else"TomeGenerationError"===c.__typename&&r(c.errorCode)}}),(0,_.jsx)(_.Fragment,{})};var Rg=e=>{let{action:t,completionState:o,getStatusContent:n,onError:r,onProgress:i,pageGenerationSubscriptionId:l,onDismiss:s,onGenerationComplete:c}=e;const{0:d,1:p}=(0,a.useState)(Wm.z.PROGRESS),{0:u,1:m}=(0,a.useState)(0);return(0,_.jsxs)(_.Fragment,{children:[l&&(0,_.jsx)(Mg,{pageGenerationSubscriptionId:l,setNumPagesGenerated:m,onComplete:()=>{c(),p(Wm.z.COMPLETE),setTimeout((()=>{m(0),p(o),o===Wm.z.NONE&&(null===s||void 0===s||s())}),Km)},onError:e=>{r(e,u)&&(m(0),p(Wm.z.ACTION))},onProgress:i}),(0,_.jsx)(Xm,{action:t,content:n({numPagesGenerated:u,status:d}),status:d})]})},Ag=o(91279);const Lg=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerationStatusRetry__ButtonGroup",componentId:"oclhcm-0"})(["display:flex;flex-direction:row;gap:12px;"]),Ng=(0,b.ZP)(Ve.Z).withConfig({displayName:"GenerationStatusRetry__Button",componentId:"oclhcm-1"})(["height:44px;width:104px;font-size:",";"],(e=>{let{theme:t}=e;return t.fontSizes.smmd}));var Hg=e=>{let{backgroundRef:t,onDismiss:o,onRetry:n,shouldEnableOutlineClicks:r}=e;const{outlineRef:i}=(0,H.TR)(),{t:l}=(0,y.$G)();(0,a.useEffect)((()=>{const e=e=>{"Escape"!==e.key&&"Enter"!==e.key||o()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[o]);const s=r?[i]:[];return(0,Ag.Z)(t,o,{exemptRefs:s}),(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(Lg,{initial:{opacity:0},animate:{opacity:1},transition:Zm.TP,children:[(0,_.jsx)(Ng,{onClick:n,children:l("commandPrompt.generationStatusRetry.tryAgainButtonLabel")}),(0,_.jsx)(Ng,{onClick:o,children:l("commandPrompt.generationStatusRetry.keepButtonLabel")})]})})};function Vg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Bg(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Vg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Vg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var $g=(0,a.forwardRef)(((e,t)=>(0,_.jsx)(Te.Z,Bg(Bg({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.4276 48.4568C27.6464 49.239 26.379 49.2398 25.5969 48.4585C24.8147 47.6773 24.814 46.41 25.5952 45.6278L39.2016 32.0378L25.5952 18.4478C24.814 17.6657 24.8147 16.3984 25.5969 15.6171C26.379 14.8359 27.6464 14.8367 28.4276 15.6188L43.45 30.6233C44.2312 31.403 44.2325 32.6683 43.4529 33.4495C43.4519 33.4505 43.451 33.4515 43.45 33.4524L28.4276 48.4568Z"})}))));const Fg=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandControls__CommandControlsGroup",componentId:"sc-1cd38sw-0"})(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:12px;padding-right:6px;"]);var Gg=e=>{let{children:t}=e;return(0,_.jsx)(Fg,{initial:{opacity:0},animate:{opacity:1},transition:Zm.TP,children:t})};var zg=e=>{let{Icon:t,scopedModeControls:o,commandHandler:n,confirmExitScoped:r=!1,isBetaCommand:i=!1}=e;const{contributeCommandHandler:l,changePromptMode:s,isFocusedInRootMode:c,clearInput:d,clearCommandState:p,inputJSON:u,inputString:m,disableTitleAnimations:g,title:h,mode:f,fallbackString:b}=pg(),C=null!=b&&b.length>0,v=m.length>0,O=(0,x.s)(),{t:P}=(0,y.$G)(),w=(0,a.useCallback)((()=>{switch(f){case og.q$.ROOT:d(),s(og.q$.SCOPED);break;case og.q$.SCOPED:r&&v?O.open():(p(),s(og.q$.ROOT))}}),[s,d,p,f,v,r,O]),j=(0,a.useCallback)((e=>{switch(f){case og.q$.ROOT:C?n(e):w();break;case og.q$.SCOPED:n(e)}return!0}),[n,C,f,w]);(0,a.useEffect)((()=>{l(j)}),[l,j]);const T=f===og.q$.ROOT,E=f===og.q$.SCOPED,I=C?tg:$g;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(Am,{onClick:T?()=>{j({stringValue:m,jsonValue:u,wasDirectlyInvoked:!1})}:void 0,children:[(0,_.jsx)(Um,{Icon:t,ActionIcon:I,title:h,viewAs:ug(f),isFocusedInRootMode:c,onClick:E?w:void 0,fallbackString:b,disableTitleAnimations:g,tag:i?Gm.BETA:Gm.NONE,showEllipsis:!0}),E&&(0,_.jsx)(Gg,{children:o})]}),r&&(0,_.jsx)(x.Z,{ref:O.ref,title:P("commandPrompt.confirmExitScopedModeModal.title"),subtitle:P("commandPrompt.confirmExitScopedModeModal.subtitle"),primaryButtonContent:P("commandPrompt.confirmExitScopedModeModal.confirmButton"),primaryButtonAction:()=>{p(),s(og.q$.ROOT),O.close()},cancelButtonText:P("cancel"),cancelButtonAction:()=>{O.close()},buttonColor:"destructive",dismissible:!0})]})};var Ug=e=>{let{Icon:t,onError:o,onProgress:n,onRetry:r,pageGenerationSubscriptionId:i,onGenerationComplete:a,commandHandler:l,scopedModeControls:s,getStatusContent:c,confirmExitScoped:d,isBetaCommand:p}=e;const{mode:u,promptBackgroundRef:m,onComplete:g}=pg();switch(u){case og.q$.DELEGATE:return(0,_.jsx)(Rg,{action:(0,_.jsx)(Hg,{onDismiss:g,onRetry:r,backgroundRef:m,shouldEnableOutlineClicks:!0}),completionState:Wm.z.ACTION,getStatusContent:c,onGenerationComplete:a,onError:o,onProgress:n,pageGenerationSubscriptionId:i,"data-testid":"generative_command_generation_status"});case og.q$.ROOT:case og.q$.SCOPED:default:return(0,_.jsx)(zg,{Icon:t,commandHandler:l,scopedModeControls:s,confirmExitScoped:d,isBetaCommand:p})}};function Wg(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}var qg=function(e){let{pageIdsToClearOnRetry:t,setCommandState:o,creditsOperation:n,clearTomeOptions:i}=e;const{changePromptMode:s,resetCommandPromptAfterClose:c,setErrorCode:d,setShowOverlayAndBlockKeys:p,tomeId:u}=pg(),{displayInsufficientCredits:m,attemptToPerformCreditsOperation:g}=(0,on.KW)(),h=(t??[]).length>0,f=(0,a.useCallback)((e=>{o({pageGenerationSubscriptionId:e})}),[o]),b=(0,a.useCallback)((e=>{o({pageIdsToClearOnRetry:e})}),[o]),y=(0,a.useCallback)((e=>{f(e),d(null)}),[f,d]),C=(0,a.useCallback)((e=>{if(f(void 0),e===U.EaV.InsufficientCredit)m();else{const t=(e=>{switch(e){case U.EaV.ModerationFlagged:return og.BO.OUT_OF_MODERATION_ERROR;case U.EaV.OpenAiOutage:case U.EaV.RateLimit:return og.BO.RATE_LIMIT_ERROR;case U.EaV.ApiError:default:return og.BO.GENERIC_ERROR}})(e);d(t)}return p(!1),s(og.q$.SCOPED),!0}),[f,d,p,s,m]),v=(0,a.useCallback)((e=>{const{currentPageId:o}=e;null!=o&&b([...t??[],o])}),[t,b]),x=function(){const{apolloClient:e,clientId:t}=(0,H.bp)(),o=xg(),n=(0,l.Zl)(V.Vx),r=(0,l.Zl)(V.pt);return(0,a.useCallback)(((i,a)=>{const l=o(i);l&&!(0,rs.$Q)(l)&&(0,B.Gi)(l,(null===a||void 0===a?void 0:a.pageIdsToDelete)??l.pages.map((e=>e.id)),e,t,r,n,!1,null===a||void 0===a?void 0:a.shouldDecrementSelectedPageIndex)}),[e,t,o,n,r])}(),O=(0,Oo.Z)((e=>o=>g(n,(()=>{h&&(x(u,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wg(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wg(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({pageIdsToDelete:t},i)),b([])),e(o)&&(p(!0),s(og.q$.DELEGATE))}))),[g,n,h,p,s,x,t,i,b,u]);return{onError:C,onProgress:v,onRetry:(0,a.useCallback)((()=>{f(void 0),s(og.q$.SCOPED)}),[s,f]),onSubscriptionStart:y,onGenerationComplete:(0,a.useCallback)((()=>{c(),p(!1)}),[c,p]),makeCommandHandler:O}};const Kg=500,Yg={id:Uc.AUTOTOME,title:Tc.ZP.t("commandPrompt.autotome.commandTitle"),placeholder:Tc.ZP.t("commandPrompt.autotome.commandPlaceholder"),contentDependency:Fc.EMPTY,Component:e=>{let{focusInput:t,tomeId:o,setCommandState:n,imageStyle:r,artifactType:i,pageGenerationSubscriptionId:l,pageIdsToClearOnRetry:s}=e;const{priceType:c}=(0,Qs.Z)(),d=(0,a.useCallback)((e=>{n({imageStyle:e})}),[n]),p=(0,a.useCallback)((e=>{n({artifactType:e})}),[n]),{onError:u,onProgress:m,onRetry:g,onSubscriptionStart:h,onGenerationComplete:f,makeCommandHandler:b}=qg({pageIdsToClearOnRetry:s,setCommandState:n,creditsOperation:on.Cw.AUTO_TOME}),y=(0,a.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<1)||u(e,t)}),[u]),C=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,U.glU)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateTomePages)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(U.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{artifactType:t,inputPrompt:r,imageStyle:i,tomeId:a}=e;const l=(0,xi.Z)();o(l),n({variables:{requestId:l,artifactType:t.getWireArtifactType(),inputPrompt:r,imageStyle:i.getWireImageStyle(),tomeId:a}})}),[n,o])}({onError:y,onSubscriptionStart:h}),v=b((0,a.useCallback)((e=>(C({artifactType:i,imageStyle:r,inputPrompt:e.stringValue,tomeId:o}),!0)),[o,C,i,r])),x=(0,a.useMemo)((()=>((e,t)=>{const o=[];return Pg.q.getValues().forEach((n=>o.push({type:"option",id:n.getWireArtifactType(),text:n.getTextTitleCase(),action:()=>e(n),checked:t===n,noSelectedBackground:!0}))),o})(p,i)),[p,i]),O=(0,a.useMemo)((()=>jg(d,r)),[d,r]),P=((e,t)=>o=>{let{numPagesGenerated:n,status:r}=o;switch(r){case Wm.z.PROGRESS:return n<2?Tc.ZP.t("commandPrompt.autotome.generationProgress",{artifactType:e.getText()}):Tc.ZP.t("commandPrompt.autotome.generationProgress",{pageIndex:n+1,context:"pageIndex"});case Wm.z.COMPLETE:case Wm.z.ACTION:{const o=Tc.ZP.t("commandPrompt.autotome.generationComplete",{artifactType:(0,hg.Z)(e.getText())});return t?(0,_.jsx)(Eg,{text:o}):o}default:return""}})(i,null===c);return(0,_.jsx)(Ug,{Icon:yg,getStatusContent:P,pageGenerationSubscriptionId:l,commandHandler:v,onError:y,onGenerationComplete:f,onProgress:m,onRetry:g,scopedModeControls:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Dg,{dataTestId:"artifact_type",items:x,activeText:i.getText(),width:130,focusInput:t}),(0,_.jsx)(Dg,{dataTestId:"image_style",items:O,activeText:r.getActiveText(),width:164,focusInput:t})]})})},hasFallbackMode(e){let{input:t}=e;return t.length<Kg},keywords:Tc.ZP.t("commandPrompt.autotome.keywords",{returnObjects:!0}),userContextFilter:e=>{var t;return!(null===(t=e.flags)||void 0===t?void 0:t[$.TT.AUTOTOME_V2])}};var Jg=Yg;var Xg=o(48058);const Qg={listStyle:"none",padding:0,margin:0},eh=.1+Zm.jy,th=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__Container",componentId:"c0gtwf-0"})(["width:","px;"],Zm.Wu),oh=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerativeOutlineEditor__EditorFields",componentId:"c0gtwf-1"})(["display:flex;flex-direction:column;width:100%;padding:","px;height:","px;overflow-y:auto;position:relative;"],12,408),nh=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerativeOutlineEditor__TitleWrapper",componentId:"c0gtwf-2"})(["box-sizing:content-box;background-color:",";border-radius:",";height:48px;padding:12px;margin-bottom:8px;"],(e=>{let{theme:t}=e;return t.colors.outlineEditorFieldBackgroundColor}),(e=>{let{theme:t}=e;return t.borderRadius.sm})),rh=b.ZP.textarea.withConfig({displayName:"GenerativeOutlineEditor__TitleInput",componentId:"c0gtwf-3"})(["appearance:none;border:none;box-shadow:none;outline:none;resize:none;caret-color:",";background-color:transparent;width:100%;font-size:19px;color:",";text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;&:focus{color:",";}::selection{background-color:",";}"],(e=>e.theme.colors.uiAccent),(e=>{let{theme:t}=e;return t.colors.outlineEditorTextColorBlurred}),(e=>{let{theme:t}=e;return t.colors.outlineEditorTextColorFocused}),(e=>e.theme.colors.textSelection)),ih=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__OutlineItemNumberLabel",componentId:"c0gtwf-4"})(["color:",";font-size:",";width:28px;text-align:center;"],(e=>{let{theme:t}=e;return t.colors.numberTextColor}),(e=>{let{theme:t}=e;return t.fontSizes.xxs})),ah=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerativeOutlineEditor__OutlineItem",componentId:"c0gtwf-5"})(["background-color:",";border-radius:",";display:flex;align-items:center;padding:2px 0;margin-bottom:8px;height:","px;z-index:",";box-shadow:",";transition:box-shadow 0.2s ease;&:hover button{opacity:",";}"],(e=>{let{theme:t}=e;return t.colors.outlineEditorFieldBackgroundColor}),(e=>{let{theme:t}=e;return t.borderRadius.sm}),44,(e=>{let{$isDragging:t}=e;return t?1:0}),(e=>{let{$isDragging:t,theme:o}=e;return t?o.colors.outlineEditorItemDraggingBoxShadow:o.colors.outlineEditorItemBoxShadow}),(e=>{let{$isDragging:t}=e;return t?0:1})),lh=(0,b.ZP)(d.E.input).withConfig({displayName:"GenerativeOutlineEditor__OutlineItemInput",componentId:"c0gtwf-6"})(["appearance:none;border:none;box-shadow:none;outline:none;caret-color:",";background-color:transparent;width:100%;font-size:",";color:",";text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;&:focus{color:",";}::selection{background-color:",";}"],(e=>e.theme.colors.uiAccent),(e=>{let{theme:t}=e;return t.fontSizes.smmd}),(e=>{let{theme:t}=e;return t.colors.outlineEditorTextColorBlurred}),(e=>{let{theme:t}=e;return t.colors.outlineEditorTextColorFocused}),(e=>e.theme.colors.textSelection)),sh=b.ZP.div.withConfig({displayName:"GenerativeOutlineEditor__BottomBar",componentId:"c0gtwf-7"})(["display:flex;justify-content:flex-end;align-items:center;width:100%;padding:","px 0;"],12),ch=(0,b.ZP)(Ve.Z).withConfig({displayName:"GenerativeOutlineEditor__SubmitButton",componentId:"c0gtwf-8"})(["margin-right:","px;"],12),dh=(0,b.ZP)((0,d.E)(Ze.Z)).withConfig({displayName:"GenerativeOutlineEditor__AddDeleteButton",componentId:"c0gtwf-9"})(["border-radius:",";display:flex;align-items:center;justify-content:center;width:","px;height:","px;opacity:0;transition:opacity 0.2s ease,background-color 0.2s ease;& > svg{fill:",";width:","px;height:","px;transition:fill 0.2s ease;}&:hover > svg{fill:",";}&:hover{background-color:",";}"],(e=>{let{theme:t}=e;return t.borderRadius.xs}),26,26,(e=>{let{theme:t}=e;return t.colors.outlineEditorAddDeleteSVGFill}),22,22,(e=>{let{theme:t}=e;return t.colors.outlineEditorAddDeleteSVGHoverFill}),(e=>{let{theme:t}=e;return t.colors.outlineEditorAddDeleteHoverBackground})),ph=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerativeOutlineEditor__OutlineDraggableHandleWrapper",componentId:"c0gtwf-10"})(["width:","px;height:","px;display:flex;justify-content:center;align-items:center;margin-left:auto;cursor:grab;"],38,38),uh=(0,b.ZP)(kt).withConfig({displayName:"GenerativeOutlineEditor__OutlineDraggableHandle",componentId:"c0gtwf-11"})(["width:","px;height:","px;fill:",";"],22,22,(e=>{let{theme:t}=e;return t.colors.outlineContentDraggableHandleColor})),mh=(0,b.ZP)(d.E.div).withConfig({displayName:"GenerativeOutlineEditor__UserControlsWrapper",componentId:"c0gtwf-12"})(["display:flex;align-items:center;margin-left:auto;"]);function gh(e){let{changePromptMode:t,isLoading:o,onSubmit:n,outlineContent:r,setOutlineContent:i,setTomeTitle:l,tomeTitle:s}=e;const{t:c}=(0,y.$G)(),d=null!=r&&r.some((e=>{let{pageTitle:t}=e;return t&&t.length>0})),p=null!=s&&s.length>0&&d,u=(0,a.useRef)(null),m=o?{opacity:.75}:{opacity:1},g={delay:o?Zm.jy:0};return(0,_.jsxs)(th,{children:[(0,_.jsxs)(oh,{layoutScroll:!0,children:[(0,_.jsx)(nh,{initial:{opacity:0},animate:m,transition:g,children:(0,_.jsx)(rh,{disabled:o,rows:2,onChange:e=>l(e.target.value),value:o?c("commandPrompt.outlineEditor.titlePlaceholder"):s})}),(0,_.jsx)("div",{ref:u,children:r&&(0,_.jsx)(Xg.t.Group,{as:"ol",axis:"y",onReorder:i,values:r,style:Qg,children:r.map(((e,t)=>(0,_.jsx)(hh,{value:e,index:t,dragConstraintsRef:u,setOutlineContent:i,outlineContent:r,isLoading:o},e.id)))})})]}),(0,_.jsx)(Zm.iz,{}),(0,_.jsxs)(sh,{children:[(0,_.jsx)(Um,{Icon:Et.Z,viewAs:zm.OUTLINE_EDITOR,title:c("commandPrompt.autotome.commandTitle"),isFocusedInRootMode:!1,tag:Gm.NONE,onClick:()=>{t(og.q$.SCOPED)}}),(0,_.jsx)(ch,{color:"primary",disabled:!p,onClick:n,children:c("commandPrompt.outlineEditor.submitButton")})]})]})}function hh(e){let{value:t,index:o,dragConstraintsRef:n,setOutlineContent:r,outlineContent:i,isLoading:l}=e;const s=(0,A.o)(),{0:c,1:d}=(0,a.useState)(!1),p=i.length>1,u=.1*o,m={duration:.2,delay:(l?eh:.2)+u},g={duration:.2,delay:(l?eh:.3)+u},h=l?{opacity:.75}:{opacity:1},f=l?{opacity:0}:{opacity:1};return(0,_.jsx)(Xg.t.Item,{value:t,dragListener:!1,dragControls:s,dragConstraints:n,dragElastic:.2,onDragStart:()=>{d(!0)},onDragEnd:()=>{d(!1)},style:{position:"relative"},whileDrag:{zIndex:1},children:(0,_.jsxs)(ah,{$isDragging:c,initial:{opacity:0},animate:h,transition:g,children:[(0,_.jsx)(ih,{children:o+1}),(0,_.jsx)(lh,{disabled:l,value:t.pageTitle,onChange:e=>{const t=[...i],n={id:t[o].id,pageGoal:t[o].pageGoal,pageTitle:e.target.value};t[o]=n,r(t)},initial:!1,animate:f,transition:m}),p&&(0,_.jsxs)(mh,{initial:!1,animate:f,transition:m,children:[(0,_.jsx)(dh,{onClick:()=>{const e=[...i];e.splice(o,1),r(e)},whileTap:{scale:.9},children:(0,_.jsx)(at,{})}),(0,_.jsxs)(ph,{onPointerDown:e=>s.start(e),children:[(0,_.jsx)(uh,{}),c&&(0,_.jsx)(Dt.Z,{})]})]})]})})}const fh=["id"],bh=["id"];function yh(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ch(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?yh(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):yh(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function vh(e,t){const o=e.filter((e=>e.pageTitle.trim().length>0)),n=new Map(t.map((e=>{let{id:t}=e;return[t,(0,i.Z)(e,bh)]})));return function(e){return e.map((e=>{let{id:t}=e;return(0,i.Z)(e,fh)}))}(o.map((e=>{var t;return e.pageTitle.trim()===(null===(t=n.get(e.id))||void 0===t?void 0:t.pageTitle)?e:{id:e.id,pageTitle:e.pageTitle,pageGoal:null}})))}const xh={id:Uc.AUTOTOME_V2,title:Tc.ZP.t("commandPrompt.autotome.commandTitle"),featureFlag:$.TT.AUTOTOME_V2,placeholder:Tc.ZP.t("commandPrompt.autotome.commandPlaceholder"),contentDependency:Fc.EMPTY,Component:e=>{let{tomeId:t,inputString:o,setCommandState:n,pageGenerationSubscriptionId:r,pageIdsToClearOnRetry:i,mode:l,promptBackgroundRef:s,onComplete:c,localOutlineContent:d,outlineResponse:p,tomeTitle:u,changePromptMode:m,isLoadingOutline:g}=e;const{priceType:h}=(0,Qs.Z)(),f=(0,a.useCallback)((e=>{n({localOutlineContent:e})}),[n]),b=(0,a.useCallback)((e=>{n({tomeTitle:e})}),[n]),{onError:y,onProgress:C,onRetry:v,onSubscriptionStart:x,onGenerationComplete:O,makeCommandHandler:P}=qg({pageIdsToClearOnRetry:i,setCommandState:n,creditsOperation:on.Cw.AUTO_TOME}),w=(0,a.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<1)||y(e,t)}),[y]),j=function(e){let{onError:t,onComplete:o}=e;const[n]=(0,U.HXg)({onCompleted:e=>{var n;switch(null===(n=e.generateOutline)||void 0===n?void 0:n.__typename){case"GenerateOutlineSuccessResponse":o(e.generateOutline);break;case"GenerateOutlineError":{const o=e.generateOutline.errorCode;t(o||U.EaV.ApiError);break}default:t(U.EaV.ApiError)}},onError:()=>{t(U.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{inputPrompt:t,tomeId:o}=e;return n({variables:{inputPrompt:t,tomeId:o}})}),[n])}({onError:w,onComplete:(0,a.useCallback)((e=>{const t=(o=d,e.outlineContent.map(((e,t)=>{var n;return Ch(Ch({},e),{},{id:(null===o||void 0===o||null===(n=o[t])||void 0===n?void 0:n.id)??(0,xi.Z)()})})));var o;n({localOutlineContent:t,outlineResponse:{desiredArtStyleType:e.detectedArtStyle,desiredLanguage:e.detectedLanguage,operationId:e.operationId,originalTomeTitle:e.tomeTitle,originalOutlineContent:t},tomeTitle:e.tomeTitle,isLoadingOutline:!1})}),[d,n])}),T=P((0,a.useCallback)((e=>{var o;return n({localOutlineContent:(o=6,Array.from(Array(o)).map((()=>({id:(0,xi.Z)(),pageTitle:""})))),isLoadingOutline:!0}),j({inputPrompt:e.stringValue,tomeId:t}),!0}),[n,j,t])),E=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,U.GdE)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateTomeFromOutline)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(U.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{operationId:t,tomeId:r,tomeTitle:i,inputPrompt:a,desiredLanguage:l,desiredArtStyleType:s,outlineContent:c}=e;const d=(0,xi.Z)();o(d),n({variables:{operationId:t,progressSubscriptionId:d,tomeId:r,tomeTitle:i,inputPrompt:a,desiredLanguage:l,desiredArtStyleType:s,outlineContent:c}})}),[n,o])}({onError:w,onSubscriptionStart:x}),I=(0,a.useCallback)((()=>{if(!p||!d||!u)return;const{desiredArtStyleType:e,desiredLanguage:n,operationId:r,originalOutlineContent:i}=p,a=vh(d,i);E({desiredArtStyleType:e,desiredLanguage:n,operationId:r,tomeId:t,tomeTitle:u,inputPrompt:o,outlineContent:a})}),[p,d,u,E,t,o]),S=(k=Pg.q.PRESENTATION,Z=null===h,e=>{let{numPagesGenerated:t,status:o}=e;switch(o){case Wm.z.PROGRESS:return t<2?Tc.ZP.t("commandPrompt.autotome.generationProgress",{artifactType:k.getText()}):Tc.ZP.t("commandPrompt.autotome.generationProgress",{pageIndex:t+1,context:"pageIndex"});case Wm.z.COMPLETE:case Wm.z.ACTION:{const e=Tc.ZP.t("commandPrompt.autotome.generationComplete",{artifactType:(0,hg.Z)(k.getText())});return Z?(0,_.jsx)(Eg,{text:e}):e}default:return""}});var k,Z;switch(l){case og.q$.DELEGATE:return r?(0,_.jsx)(Rg,{action:(0,_.jsx)(Hg,{onDismiss:c,onRetry:v,backgroundRef:s,shouldEnableOutlineClicks:!0}),completionState:Wm.z.ACTION,getStatusContent:S,onGenerationComplete:O,onError:w,onProgress:C,pageGenerationSubscriptionId:r,"data-testid":"generative_command_generation_status"}):(0,_.jsx)(gh,{changePromptMode:m,onSubmit:I,outlineContent:d,setOutlineContent:f,setTomeTitle:b,tomeTitle:u,isLoading:g??!0});case og.q$.ROOT:case og.q$.SCOPED:default:return(0,_.jsx)(zg,{Icon:yg,commandHandler:T})}},hasFallbackMode(e){let{input:t}=e;return t.length<Kg},keywords:Tc.ZP.t("commandPrompt.autotome.keywords",{returnObjects:!0})};var Oh=xh;function Ph(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function wh(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ph(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ph(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var jh=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,wh(wh({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M18 26C16.8954 26 16 26.8954 16 28C16 29.1046 16.8954 30 18 30H30C31.1046 30 32 29.1046 32 28C32 26.8954 31.1046 26 30 26H18Z"}),(0,_.jsx)("path",{d:"M16 36C16 34.8954 16.8954 34 18 34H26C27.1046 34 28 34.8954 28 36C28 37.1046 27.1046 38 26 38H18C16.8954 38 16 37.1046 16 36Z"}),(0,_.jsx)("path",{d:"M38 24C36.8954 24 36 24.8954 36 26V38C36 39.1046 36.8954 40 38 40H46C47.1046 40 48 39.1046 48 38V26C48 24.8954 47.1046 24 46 24H38Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 50C11.5817 50 8 46.4183 8 42V22C8 17.5817 11.5817 14 16 14H48C52.4183 14 56 17.5817 56 22V42C56 46.4183 52.4183 50 48 50H16ZM16 46C13.7909 46 12 44.2091 12 42V22C12 19.7909 13.7909 18 16 18H48C50.2091 18 52 19.7909 52 22V42C52 44.2091 50.2091 46 48 46H16Z"})]}))));var Th={id:Uc.CREATE_PAGE,title:Tc.ZP.t("commandPrompt.createPage.commandTitle"),placeholder:Tc.ZP.t("commandPrompt.createPage.commandPlaceholder"),contentDependency:Fc.ALWAYS,Component:e=>{let{tomeId:t,setCommandState:o,pageGenerationSubscriptionId:n,imageStyle:r,focusInput:i,pageIdsToClearOnRetry:l}=e;const{onError:s,onProgress:c,onRetry:d,onSubscriptionStart:p,onGenerationComplete:u,makeCommandHandler:m}=qg({pageIdsToClearOnRetry:l,setCommandState:o,creditsOperation:on.Cw.TOME_PAGE,clearTomeOptions:{shouldDecrementSelectedPageIndex:!0}}),{priceType:g}=(0,Qs.Z)(),h=Og({onSubscriptionStart:p,onError:s}),f=m((0,a.useCallback)((e=>{let{stringValue:o}=e;return h({prompt:o,tomeId:t,imageStyle:r}),!0}),[h,t,r])),b=(0,a.useCallback)((e=>{o({imageStyle:e})}),[o]),y=(0,a.useMemo)((()=>jg(b,r)),[b,r]),C=(e=>{let{shouldShowBalance:t}=e;return e=>{let{status:o}=e;switch(o){case Wm.z.PROGRESS:return Tc.ZP.t("commandPrompt.createPage.generationProgress");case Wm.z.COMPLETE:case Wm.z.ACTION:return t?(0,_.jsx)(Eg,{text:Tc.ZP.t("commandPrompt.createPage.generationComplete")}):Tc.ZP.t("commandPrompt.createPage.generationComplete");default:return""}}})({shouldShowBalance:null===g});return(0,_.jsx)(Ug,{Icon:jh,getStatusContent:C,pageIdsToClearOnRetry:l,pageGenerationSubscriptionId:n,commandHandler:f,onError:s,onGenerationComplete:u,onProgress:c,onRetry:d,scopedModeControls:(0,_.jsx)(Dg,{dataTestId:"image_style",items:y,activeText:r.getActiveText(),width:164,focusInput:i})})},hasFallbackMode(e){let{input:t}=e;return t.length<Kg},keywords:Tc.ZP.t("commandPrompt.createPage.keywords",{returnObjects:!0})};function Eh(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ih(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Eh(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Eh(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Sh=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,Ih(Ih({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M24 20C22.8954 20 22 20.8954 22 22C22 23.1046 22.8954 24 24 24H40C41.1046 24 42 23.1046 42 22C42 20.8954 41.1046 20 40 20H24Z"}),(0,_.jsx)("path",{d:"M22 30C22 28.8954 22.8954 28 24 28H40C41.1046 28 42 28.8954 42 30C42 31.1046 41.1046 32 40 32H24C22.8954 32 22 31.1046 22 30Z"}),(0,_.jsx)("path",{d:"M24 36C22.8954 36 22 36.8954 22 38C22 39.1046 22.8954 40 24 40H32C33.1046 40 34 39.1046 34 38C34 36.8954 33.1046 36 32 36H24Z"}),(0,_.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22 8C17.5817 8 14 11.5817 14 16V48C14 52.4183 17.5817 56 22 56H42C46.4183 56 50 52.4183 50 48V16C50 11.5817 46.4183 8 42 8H22ZM22 12C19.7909 12 18 13.7909 18 16V48C18 50.2091 19.7909 52 22 52H42C44.2091 52 46 50.2091 46 48V16C46 13.7909 44.2091 12 42 12H22Z"})]}))));var _h=e=>{let{dataTestId:t,onClick:o,children:n,disabled:r}=e;return(0,_.jsx)(Ve.Z,{"data-testid":t,onClick:o,color:"primary",size:"small",disabled:r,children:n})};var kh=e=>{let{children:t,disabled:o}=e;const{t:n}=(0,y.$G)();return(0,_.jsx)(ln.Z,{content:n("commandPrompt.docToTome.characterLimitNotReached",{min_chars_limit:Kg}),placement:"top",delay:0,tooltipDisabled:o,children:(0,_.jsx)("div",{children:t})})};var Zh={id:Uc.DOC_TO_TOME,title:Tc.ZP.t("commandPrompt.docToTome.commandTitle"),placeholder:Tc.ZP.t("commandPrompt.docToTome.commandPlaceholder"),Component:e=>{let{changePromptMode:t,tomeId:o,imageStyle:n,artifactType:r,pageGenerationSubscriptionId:i,setCommandState:l,pageIdsToClearOnRetry:s,inputString:c,inputJSON:d}=e;const{onError:p,onProgress:u,onRetry:m,onSubscriptionStart:g,onGenerationComplete:h,makeCommandHandler:f}=qg({pageIdsToClearOnRetry:s,setCommandState:l,creditsOperation:on.Cw.DOC_TO_TOME}),{priceType:b}=(0,Qs.Z)(),y=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,U.c_h)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.generateTomePagesFromDocument)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(U.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{artifactType:t,prompt:r,imageStyle:i,tomeId:a}=e;const l=(0,xi.Z)();o(l),n({variables:{artifactType:t.getWireArtifactType(),prompt:r,imageStyle:i.getWireImageStyle(),tomeId:a,requestId:l}})}),[n,o])}({onSubscriptionStart:g,onError:p}),C=c.length<Kg,v=f((0,a.useCallback)((e=>{let{jsonValue:i,stringValue:a}=e;return a.length>=Kg&&(t(og.q$.DELEGATE),y({artifactType:r,prompt:JSON.stringify(i),imageStyle:n,tomeId:o}),!0)}),[r,t,y,n,o])),x=(0,a.useCallback)((()=>{v({jsonValue:d,stringValue:c,wasDirectlyInvoked:!1})}),[d,c,v]),O=(e=>{let{shouldShowBalance:t}=e;return e=>{let{numPagesGenerated:o,status:n}=e;switch(n){case Wm.z.PROGRESS:return o<2?Tc.ZP.t("commandPrompt.docToTome.generationProgress"):Tc.ZP.t("commandPrompt.docToTome.generationProgress",{pageIndex:o+1,context:"pageIndex"});case Wm.z.COMPLETE:case Wm.z.ACTION:{const e=Tc.ZP.t("commandPrompt.docToTome.generationComplete");return t?(0,_.jsx)(Eg,{text:e}):e}default:return""}}})({shouldShowBalance:null===b});return(0,_.jsx)(Ug,{Icon:Sh,getStatusContent:O,pageIdsToClearOnRetry:s,pageGenerationSubscriptionId:i,commandHandler:v,onError:p,onGenerationComplete:h,onProgress:u,onRetry:m,confirmExitScoped:!0,isBetaCommand:!0,scopedModeControls:(0,_.jsx)(kh,{disabled:!C,children:(0,_.jsx)(_h,{dataTestId:"generate",onClick:x,disabled:C,children:"Generate"})})})},hasFallbackMode(e){let{input:t}=e;return t.length>=Kg},contentDependency:Fc.EMPTY,featureFlag:$.TT.DOC_TO_TOME,keywords:Tc.ZP.t("commandPrompt.docToTome.keywords",{returnObjects:!0})};const Dh={id:Uc.YOUTUBE_TO_TOME,title:Tc.ZP.t("commandPrompt.youtubeToTome.commandTitle"),placeholder:Tc.ZP.t("commandPrompt.youtubeToTome.commandPlaceholder"),contentDependency:Fc.EMPTY,Component:e=>{let{tomeId:t,setCommandState:o,artifactType:n,pageGenerationSubscriptionId:r,pageIdsToClearOnRetry:i}=e;const{priceType:l}=(0,Qs.Z)(),{onError:s,onProgress:c,onRetry:d,onSubscriptionStart:p,onGenerationComplete:u,makeCommandHandler:m}=qg({pageIdsToClearOnRetry:i,setCommandState:o,creditsOperation:on.Cw.AUTO_TOME}),g=(0,a.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<1)||s(e,t)}),[s]),h=function(e){let{onError:t,onSubscriptionStart:o}=e;const[n]=(0,U.zi1)({onCompleted:e=>{var o;const n=null===e||void 0===e||null===(o=e.experimentalGenerateYoutubeToTomePages)||void 0===o?void 0:o.errorCode;n&&t(n)},onError:()=>{t(U.EaV.ApiError)}});return(0,a.useCallback)((e=>{let{youtubeUrl:t,tomeId:r}=e;const i=(0,xi.Z)();o(i),n({variables:{requestId:i,youtubeUrl:t,tomeId:r}})}),[n,o])}({onError:g,onSubscriptionStart:p}),f=m((0,a.useCallback)((e=>(h({youtubeUrl:e.stringValue,tomeId:t}),!0)),[h,t])),b=((e,t)=>o=>{let{numPagesGenerated:n,status:r}=o;switch(r){case Wm.z.PROGRESS:return n<2?Tc.ZP.t("commandPrompt.autotome.generationProgress",{artifactType:e.getText()}):Tc.ZP.t("commandPrompt.autotome.generationProgress",{pageIndex:n+1,context:"pageIndex"});case Wm.z.COMPLETE:case Wm.z.ACTION:{const o=Tc.ZP.t("commandPrompt.autotome.generationComplete",{artifactType:(0,hg.Z)(e.getText())});return t?(0,_.jsx)(Eg,{text:o}):o}default:return""}})(n,null===l);return(0,_.jsx)(Ug,{Icon:yg,getStatusContent:b,pageGenerationSubscriptionId:r,commandHandler:f,onError:g,onGenerationComplete:u,onProgress:c,onRetry:d})},keywords:Tc.ZP.t("commandPrompt.youtubeToTome.keywords",{returnObjects:!0}),featureFlag:$.TT.YOUTUBE_TO_TOME};var Mh=Dh;function Rh(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ah(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Rh(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Rh(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var Lh=(0,a.forwardRef)(((e,t)=>(0,_.jsxs)(Te.Z,Ah(Ah({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,_.jsx)("path",{d:"M33.4142 8.58579C32.6332 7.80474 31.3668 7.80474 30.5858 8.58579L24.5858 14.5858C23.8047 15.3668 23.8047 16.6332 24.5858 17.4142C25.3668 18.1953 26.6332 18.1953 27.4142 17.4142L30 14.8284V34C30 35.1046 30.8954 36 32 36C33.1046 36 34 35.1046 34 34V14.8284L36.5858 17.4142C37.3668 18.1953 38.6332 18.1953 39.4142 17.4142C40.1953 16.6332 40.1953 15.3668 39.4142 14.5858L33.4142 8.58579Z"}),(0,_.jsx)("path",{d:"M22 22C17.5817 22 14 25.5817 14 30V46C14 50.4183 17.5817 54 22 54H42C46.4183 54 50 50.4183 50 46V30C50 25.5817 46.4183 22 42 22H40C38.8954 22 38 22.8954 38 24C38 25.1046 38.8954 26 40 26H42C44.2091 26 46 27.7909 46 30V46C46 48.2091 44.2091 50 42 50H22C19.7909 50 18 48.2091 18 46V30C18 27.7909 19.7909 26 22 26H24C25.1046 26 26 25.1046 26 24C26 22.8954 25.1046 22 24 22H22Z"})]}))));var Nh={id:Uc.COPY_LINK,title:Tc.ZP.t("commandPrompt.copyLink.commandTitle"),Component:e=>{let{tomeId:t}=e;const{t:o}=(0,y.$G)(),n=xg(),r=(0,a.useCallback)((()=>{var e;const r=null===(e=n(t))||void 0===e?void 0:e.canonicalUrl;if(r)try{gs(r),(0,V.ak)({message:o("commandPrompt.copyLink.toastTextSuccess")})}catch{(0,V.ak)({message:o("commandPrompt.copyLink.toastTextFailure")})}}),[n,o,t]);return(0,_.jsx)(mg,{Icon:Lh,commandHandler:r})},keywords:Tc.ZP.t("commandPrompt.copyLink.keywords",{returnObjects:!0})};var Hh={id:Uc.RENAME_TOME,title:Tc.ZP.t("commandPrompt.renameTome.commandTitle"),Component:()=>{const{focusOnTitle:e}=Xs();return(0,_.jsx)(mg,{Icon:pd,commandHandler:e})},keywords:Tc.ZP.t("commandPrompt.renameTome.keywords",{returnObjects:!0})};const Vh=Tc.ZP.t("commandPrompt.tiles.keywords",{returnObjects:!0});var Bh=e=>{let{id:t,icon:o,title:n,tileType:r,keywords:i=[],additionalTileData:l={},afterAddTileAction:s=gr.B.NONE,featureFlag:c}=e;const d=K.qj.includes(r);return{id:t,title:n,Component:e=>{let{tomeId:t}=e;const n=br({tomeId:t,shouldFocusInput:d,shouldSetPropertyPanel:!1}),i=(0,a.useCallback)((()=>{n({tileType:r,additionalTileData:l,afterAddTileAction:s})}),[n]);return(0,_.jsx)(mg,{Icon:o,commandHandler:i})},keywords:i.concat(Vh),featureFlag:c}};var $h=function(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const i=()=>{const e=(0,I.t2)(),o=(0,a.useCallback)((()=>{e.setPropertyPanel(n)}),[e]);return(0,_.jsx)(mg,{Icon:t,commandHandler:o})};return{id:e,title:o,Component:i,keywords:r}},Fh=o(44196);const Gh=Tc.ZP.t("commandPrompt.help.keywords",{returnObjects:!0});var zh=function(e,t,o,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const i=()=>{const e=(0,a.useCallback)((()=>{window.open(n,"_blank")}),[]);return(0,_.jsx)(mg,{ActionIcon:Fh.Z,Icon:t,commandHandler:e})};return{id:e,title:o,Component:i,keywords:r.concat(Gh)}};var Uh={id:Uc.SHARE,title:Tc.ZP.t("commandPrompt.share.commandTitle"),Component:()=>{const e=(0,l.Zl)(V.B8),t=(0,a.useCallback)((()=>{e(!0)}),[e]);return(0,_.jsx)(mg,{Icon:Lh,commandHandler:t})},keywords:Tc.ZP.t("commandPrompt.share.keywords",{returnObjects:!0})};var Wh={id:Uc.CHAT,title:Tc.ZP.t("commandPrompt.help.chat.commandTitle"),Component:()=>{const e=(0,a.useCallback)((()=>{var e,t;null===(e=(t=window).Intercom)||void 0===e||e.call(t,"show")}),[]);return(0,_.jsx)(mg,{Icon:kc.Z,commandHandler:e})},keywords:Tc.ZP.t("commandPrompt.help.chat.keywords",{returnObjects:!0})};const qh=new Set(Tc.ZP.t("commandPrompt.tokenization.stopWords",{returnObjects:!0})),Kh=Tc.ZP.t("commandPrompt.tokenization.separator"),Yh=1.875;class Jh{constructor(e){this.userContext=e,(0,r.Z)(this,"values",[])}register(e){let{id:t,title:o,placeholder:n,Component:r,hasFallbackMode:i,contentDependency:a,keywords:l,featureFlag:s,userContextFilter:c}=e;this.values.push(new zc(t,o,n,r,i,a,l,s,c))}getCommandById(e){return this.values.find((t=>t.id===e))??null}getFlagVisibility(e){var t;return!e.featureFlag||!0===(null===(t=this.userContext.flags)||void 0===t?void 0:t[e.featureFlag])}getUserContextVisibility(e){return!e.userContextFilter||e.userContextFilter(this.userContext)}getVisibility(e){return this.getFlagVisibility(e)&&this.getUserContextVisibility(e)}visibleCommands(){return this.values.filter((e=>this.getVisibility(e)))}getMatchingCommands(e){let{isEmptyTome:t,query:o="",selectedCommandId:n}=e;const r=o.trim().split(Kh),i=r.filter((e=>!qh.has(e))).join(Kh);let a=this.visibleCommands().map((e=>({command:e,matchScore:e.score(i)})));i.length>0&&(a=a.filter((e=>{return e.matchScore.type!==Gc.NONE||e.command.id===n||(t=e.command.hasFallbackMode,r={input:o},"function"===typeof t?t(r):t);var t,r})));let l;const s=a.map((e=>{const o=e.matchScore.type===Gc.TITLE?15*e.matchScore.score:12*e.matchScore.score,n=t&&e.command.contentDependency===Fc.EMPTY||!t&&e.command.contentDependency===Fc.DIRTY,r=t&&e.command.contentDependency===Fc.DIRTY||!t&&e.command.contentDependency===Fc.EMPTY;let i=0;return n?i=Yh:r&&(i=-1.875),!r&&e.command.hasFallbackMode&&(i+=.9375),{command:e.command,rankingScore:o+i}})).map((e=>{if(!e.command.hasFallbackMode||!i)return e;const{fallbackString:t,prefixScore:o}=Jh.calculateFallbackString(e.command,r);let n=0;return o>0&&(n=3.75),(void 0===l||t.length<l.length)&&(l=t),{command:e.command,rankingScore:e.rankingScore+n}}));let c=s;const d=s.every((e=>e.command.hasFallbackMode)),p=i.lastIndexOf(l??"");if(d&&-1!==p){const e=i.slice(0,p).trim(),t=s.filter((t=>{const o=t.command.score(e);return o.type===Gc.TITLE&&o.score>.1}));t.length>0&&(c=t)}return c.sort(((e,t)=>t.rankingScore-e.rankingScore)).map((e=>({command:e.command,fallbackString:e.command.hasFallbackMode?l:void 0})))}static calculateFallbackString(e,t){let o,n=0,r=0;for(o=0;o<t.length;o++){if(qh.has(t[o])){r+=1;continue}const i=t.slice(0,o+1).filter((e=>!qh.has(e))).join(Kh),{score:a}=e.score(i);if(!a&&!n)break;if(!(a>=.8*n))break;n=a,r=o+1}return{command:e,fallbackString:t.slice(r).join(Kh),prefixScore:n}}}function Xh(e,t){return t.findIndex((t=>t.command.id===e.id))}var Qh=o(92346);function ef(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function tf(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ef(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ef(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var of=()=>{const{0:e,1:t}=(0,a.useState)(og.d9),{0:o,1:n}=(0,a.useState)(new Map),r=(0,a.useCallback)((t=>tf(tf({},o.get(t)),e)),[o,e]),i=(0,a.useCallback)(((r,i)=>{const a=(0,Qh.Z)(e),l=(0,Qh.Z)(o.get(r)||{});for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(e in a?a[e]=i[e]:l[e]=i[e]);if((0,qt.Z)(e,a)||t(a),!(0,qt.Z)(o.get(r)||{},l)){const e=new Map(o);e.set(r,l),n(e)}}),[o,e]),l=(0,a.useCallback)((()=>{n(new Map)}),[]);return(0,a.useMemo)((()=>({getCommandState:r,setCommandState:i,clearCommandState:l})),[l,r,i])},nf=o(42726),rf=o(13589);var af=function(e){let{scroller:t,el:o,direction:n="UP",offset:r=0}=e;const i=t.getBoundingClientRect(),a=o.getBoundingClientRect();if("UP"===n){const e=a.top-i.top;if(e<6){const o=t.scrollTop+e-6-r;t.scrollTop=o}}if("DOWN"===n){const e=i.bottom-a.bottom;if(e<6){const o=t.scrollTop-e+6+r;t.scrollTop=o}}},lf=o(85518),sf=o(56913);let cf;!function(e){e[e.PROMPT=0]="PROMPT",e[e.DOCUMENT=1]="DOCUMENT"}(cf||(cf={}));const df=Tc.ZP.t("commandPrompt.placeholder.default");var pf=(0,a.forwardRef)(((e,t)=>{let{inputJSON:o,inputString:n,placeholder:r=df,navigateForward:i,navigateBackward:l,onArrowUp:s,onArrowDown:c,hasContent:d,onInputChange:p,onInputPaste:u,mode:m,inputMode:g}=e;const h=(0,a.useMemo)((()=>{const e={esc:()=>(l(),!0)};if(g===cf.PROMPT&&(e.enter=()=>(i(),!0)),g===cf.DOCUMENT&&(e["mod+enter"]=()=>(i(),!0),e.esc=()=>!d&&(l(),!0)),m===og.q$.ROOT&&(e.arrowup=()=>(s(),!0),e.arrowdown=()=>(c(),!0),e.arrowright=()=>!d&&(i(),!0)),m===og.q$.SCOPED){const t=()=>!d&&(l(),!0);e.arrowleft=t,e.backspace=t}return e}),[m,g,d,i,l,s,c]),f=m===og.q$.ROOT,b=g===cf.DOCUMENT||f?5e4:1e3,y=g===cf.PROMPT?[]:[Qt.Ar.TYPE_SCALES,Qt.Ar.LISTS,Qt.Ar.STRICT_MODE];return(0,_.jsx)(Zm.SR,{$inRootMode:f,children:(0,_.jsx)(Zm.rD,{bodyFontSize:20,innerTilePadding:0,$isMobile:lf.tq,$horizontalAlignment:U.KxP.Leading,$verticalAlignment:U.Q4P.Top,$placeholder:r,$error:n.length>=b,$hasContent:d,$inRootMode:f,disabled:!1,"data-testid":"command_prompt_input",children:(0,_.jsx)(sf.Z,{ref:t,autoFocus:m!==og.q$.DELEGATE,placeholder:r,value:o,setValue:p,onPaste:u,features:y,keyBindings:h,wrapText:!f,disableHistory:!1,maxCharacterLimit:b})})})}));const uf=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandPromptError__ErrorMessage",componentId:"oxv8fw-0"})(["width:100%;height:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start;font-size:",";line-height:20px;padding-left:20px;color:",";cursor:auto;svg{fill:currentColor;}svg:hover{fill:currentColor;}"],(e=>{let{theme:t}=e;return t.fontSizes.sm}),(e=>{let{theme:t}=e;return t.colors.errorText}));var mf=e=>{let{errorCode:t}=e;const{message:o}=(e=>{switch(e){case og.BO.OUT_OF_MODERATION_ERROR:return{message:Tc.ZP.t("tomeGenerationError.outOfModerationPolicy"),retryable:!1};case og.BO.RATE_LIMIT_ERROR:return{message:Tc.ZP.t("tomeGenerationError.rateLimit"),retryable:!1};case og.BO.GENERIC_ERROR:default:return{message:Tc.ZP.t("tomeGenerationError.generic"),retryable:!0}}})(t);return(0,_.jsx)(uf,{"data-testid":"command_prompt_error",children:o})};const gf=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandPromptListItem__CommandPromptListItemContainer",componentId:"sc-1vm7o7i-0"})(["flex-shrink:0;height:","px;position:relative;pointer-events:",";"],Zm.xJ,(e=>{let{$isVisible:t}=e;return t?"auto":"none"})),hf=(0,b.ZP)(d.E.div).withConfig({displayName:"CommandPromptListItem__CommandPromptListItemInnerContainer",componentId:"sc-1vm7o7i-1"})(["position:absolute;inset:0px 6px;"]);var ff=e=>{let{initial:t,animate:o,transition:n,onAnimationComplete:r,onMouseMove:i,isVisible:a,dataTestId:l,dataFocused:s,children:c}=e;return(0,_.jsx)(gf,{initial:t,animate:o,transition:n,onAnimationComplete:r,$isVisible:a,"data-testid":l,"data-focused":s,children:(0,_.jsx)(hf,{onMouseMove:i,children:c})})};const bf=e=>({imageStyle:e.imageStyle.getWireImageStyle(),artifactType:e.artifactType.getWireArtifactType()});var yf=function(e){let{getCommandState:t,tomeId:o}=e;const{apolloClient:n}=(0,H.bp)();return(0,a.useCallback)((e=>{let{commandId:r,input:i,mode:a}=e;const l=t(r);We.ZP.reportSumbitCommand({apolloClient:n,commandId:r,commandInput:i.slice(0,5e3),commandInputLength:i.length,commandMode:a,commandParameters:bf(l),tomeId:o})}),[n,t,o])};function Cf(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function vf(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Cf(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Cf(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var xf=e=>{let{commandRegistry:t,setShowOverlayAndBlockKeys:o,tomeId:n,isEmptyTome:r,inputJSON:i,inputString:l,setInputJSON:s,errorCode:c,setErrorCode:d,getCommandState:p,setCommandState:u,clearCommandState:m,backgroundRef:g}=e;const h=yf({getCommandState:p,tomeId:n}),{commandPromptMode:f,setCommandPromptMode:b,controlCommandPrompt:y,setShouldResetCommandPromptAfterClose:C,selectedCommandId:v,setSelectedCommandId:x,directlyInvokeCommand:O,setDirectlyInvokeCommand:P,setBlockCommandPromptToggle:w,promptAnimationsEnabled:j,setPromptAnimationsEnabled:T}=(0,Vc.uJ)(),E=f===og.q$.ROOT,I=f===og.q$.SCOPED,S=f===og.q$.DELEGATE,{0:k,1:Z}=(0,a.useState)((()=>t.getMatchingCommands({isEmptyTome:r,query:l,selectedCommandId:v}))),{0:D,1:M}=(0,a.useState)((()=>t.getMatchingCommands({isEmptyTome:r,query:l,selectedCommandId:v})[0].command)),R=(0,a.useRef)(null),A=l.length>0,L=(0,a.useRef)();L.current=(e,t,o)=>{O&&v===e&&t&&(P(!1),o({stringValue:"",jsonValue:um.yS,wasDirectlyInvoked:!0}))};const N=(0,a.useRef)(new Map),H=(0,Oo.Z)(((e,t,o)=>{null===N||void 0===N||N.current.set(e,o),L.current&&L.current(e,t,o)}),[]),V=(0,a.useCallback)((()=>{var e;if(E&&D)h({commandId:D.id,input:l,mode:"ROOT"}),null===N||void 0===N||null===(e=N.current.get(D.id))||void 0===e||e({stringValue:l,jsonValue:i,wasDirectlyInvoked:!1});else if(I&&v&&l.length>0){var t;h({commandId:v,input:l,mode:"SCOPED"}),null===N||void 0===N||null===(t=N.current.get(v))||void 0===t||t({stringValue:l,jsonValue:i,wasDirectlyInvoked:!1})}}),[I,E,D,v,l,h,i]),B=(0,a.useRef)(null),$=()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.focusEditor()},F=(0,a.useCallback)((e=>{Z(e),M(e[0].command),null!==R&&void 0!==R&&R.current&&(R.current.scrollTop=0)}),[]),G=(0,a.useCallback)((e=>{const o=t.getMatchingCommands({isEmptyTome:r,query:e,selectedCommandId:v});F(o)}),[t,r,v,F]),z=(0,a.useCallback)((()=>{F(t.getMatchingCommands({isEmptyTome:r,selectedCommandId:v}))}),[t,r,v,F]),U=(0,a.useCallback)((e=>{if(s(e),d(null),E){const t=(0,vg.Q)(e);G(t)}}),[G,E,d,s]),W=(0,a.useCallback)((()=>{setTimeout((()=>{var e;const t=null===B||void 0===B||null===(e=B.current)||void 0===e?void 0:e.getEditor(),o=null===t||void 0===t?void 0:t.selection;if(o){var n;const e=(0,_n.lrJ)(t,o),i=null===e||void 0===e?void 0:e.getBoundingClientRect().bottom,a=null===g||void 0===g||null===(n=g.current)||void 0===n?void 0:n.getBoundingClientRect().bottom;var r;if(i&&a&&i>a)null===e||void 0===e||null===(r=e.endContainer.parentElement)||void 0===r||r.scrollIntoView({block:"end"})}}),1)}),[g]),q=(0,a.useCallback)(((e,t)=>{const o=Xh(e,k);if(R.current){const e=R.current,n=Array.from(R.current.children).slice(1,-1)[o];e&&n&&af({scroller:e,el:n,direction:t,offset:20})}}),[k]),K=(0,a.useCallback)((()=>{s(um.yS),z()}),[z,s]),Y=(0,Oo.Z)(((e,t)=>{switch(t){case og.q$.ROOT:K(),d(null),x(null);break;case og.q$.SCOPED:case og.q$.DELEGATE:x(e.id)}b(t),T(!0),t===og.q$.DELEGATE?(()=>{var e;null===(e=B.current)||void 0===e||e.blurEditor()})():$()}),[b,T,K,d,x]),J=(0,Oo.Z)(u,[u]),X=(0,a.useCallback)((()=>{C(!0)}),[C]),Q=(0,a.useCallback)((()=>{y({action:Vc.$C.CLOSE})}),[y]),ee=(0,a.useCallback)((()=>{C(!0),Q()}),[Q,C]),te=(0,a.useCallback)((()=>{if(A)K();else switch(f){case og.q$.SCOPED:x(null),z(),T(!0),b(og.q$.ROOT),m();break;case og.q$.ROOT:ee();case og.q$.DELEGATE:}}),[A,f,K,x,z,T,b,m,ee]),oe=(0,a.useCallback)((()=>{const e=Xh(D,k),t=Math.min(e+1,k.length-1),{command:o}=k[t];M(o),q(o,"UP")}),[k,D,q,M]),ne=(0,a.useCallback)((()=>{const e=Xh(D,k),t=Math.max(e-1,0),{command:o}=k[t];M(o),q(o,"DOWN")}),[k,D,q,M]);(0,Ag.Z)(f!==og.q$.DELEGATE?g:null,Q);const re=e=>{var t;return e.id===v?Xh(e,k)*Zm.xJ+((null===R||void 0===R||null===(t=R.current)||void 0===t?void 0:t.scrollTop)||0)+(Zm.xJ-Zm.BY)/2+Zm.EW:0},ie=e=>({opacity:null===v||e.id===v?1:0,y:re(e),height:null===v||e.id!==v?`${Zm.xJ}px`:`${Zm.BY}px`}),ae={height:c?"36px":0,opacity:c?1:0},{0:le,1:se}=(0,a.useState)(cf.PROMPT),ce=(0,a.useCallback)((()=>{v===Uc.DOC_TO_TOME?se(cf.DOCUMENT):se(cf.PROMPT)}),[v]),de=(0,a.useCallback)((()=>{I&&T(!1)}),[I,T]),pe=(0,a.useMemo)((()=>(0,tm.Z)(((e,t)=>{if(E){if(0===Math.hypot(e.movementX,e.movementY))return;M(t)}}),50)),[E,M]),ue=v?t.getCommandById(v):null,me=S&&ue?{title:ue.title,mode:og.q$.DELEGATE,changePromptMode:Y(ue),contributeCommandHandler:H(ue.id)(!0),inputString:l,inputJSON:i,focusInput:$,clearInput:K,setShowOverlayAndBlockKeys:o,tomeId:n,promptBackgroundRef:g,onComplete:ee,clearCommandState:m,setErrorCode:d,isFocusedInRootMode:!1,disableTitleAnimations:!1,resetCommandPromptAfterClose:X,setBlockCommandPromptToggle:w}:null;return(0,_.jsxs)(Zm.CM,{initial:{opacity:0,scale:.8},exit:{opacity:0,scale:.2,transition:Zm.U2},animate:{opacity:1,scale:1,transition:Zm.U2},transition:j?Zm.c:Zm.Xi,onAnimationComplete:de,style:{originX:.5,originY:1},children:[(0,_.jsxs)(Zm._2,{layout:"size",transition:j?Zm.c:Zm.Xi,style:{position:E||I?"relative":"absolute"},animate:{opacity:E||I?1:0},children:[(0,_.jsxs)(Zm.Ur,{ref:R,transition:j?Zm.TP:Zm.YB,initial:!1,animate:{height:`${E?Math.min(Zm.rZ,k.length*Zm.xJ+2*Zm.EW):Zm.BY}px`},$disableScroll:I,onAnimationComplete:ce,"data-testid":"command_prompt_list",children:[(0,_.jsx)(Zm.T7,{}),k.map((e=>{let{command:t,fallbackString:r}=e;const a=t.id===v,s=t.id===D.id,c=I&&!a||!j,u={title:t.title,mode:a?og.q$.SCOPED:og.q$.ROOT,changePromptMode:Y(t),contributeCommandHandler:H(t.id)(!1),inputString:l,inputJSON:i,focusInput:$,clearInput:K,setShowOverlayAndBlockKeys:o,tomeId:n,promptBackgroundRef:g,onComplete:ee,clearCommandState:m,setErrorCode:d,isFocusedInRootMode:E&&s,fallbackString:r,disableTitleAnimations:!j,resetCommandPromptAfterClose:X,setBlockCommandPromptToggle:w};return(0,_.jsx)(ff,{initial:ie(t),animate:ie(t),transition:c?Zm.YB:Zm.TP,onAnimationComplete:a?de:void 0,dataTestId:`${t.id}_${f}_mode`,dataFocused:E?s:void 0,onMouseMove:e=>pe(e,t),isVisible:null===v||a,children:(0,_.jsx)(dg,{value:u,children:(0,_.jsx)(t.component,vf(vf({setCommandState:J(t.id)},p(t.id)),u))})},t.id)})),(0,_.jsx)(Zm.T7,{})]}),(0,_.jsx)(Zm.iz,{transition:Zm.$E,animate:{opacity:E?1:0}}),(0,_.jsx)(pf,{ref:B,inputJSON:i,inputString:l,placeholder:null===ue||void 0===ue?void 0:ue.placeholder,onInputChange:U,onInputPaste:W,mode:f,inputMode:le,navigateForward:V,navigateBackward:te,onArrowUp:oe,onArrowDown:ne,hasContent:l.length>0}),(0,_.jsx)(Zm.cW,{initial:ae,animate:ae,transition:{type:"spring",bounce:0},children:c&&(0,_.jsx)(mf,{errorCode:c})})]}),(0,_.jsx)(Zm.ef,{transition:j?Zm.c:Zm.Xi,style:{position:S?"relative":"absolute"},initial:{opacity:0},animate:{opacity:S?1:0},layout:"size",onAnimationComplete:de,children:null!=ue&&null!=me&&(0,_.jsx)(dg,{value:me,children:(0,_.jsx)(ue.component,vf(vf({setCommandState:J(ue.id)},p(ue.id)),me))})})]})},Of=o(34997);var Pf=(0,a.forwardRef)(((e,t)=>{let{fillColor:o}=e;return(0,_.jsxs)(Te.Z,{ref:t,width:"21",height:"10",viewBox:"0 0 21 10",fill:"none","data-testid":"command_k_icon",children:[(0,_.jsx)("path",{d:"M2.125 10C3.68056 10 4.18056 9.02778 4.18056 7.86111V6.70833H5.70833V7.86111C5.70833 9.02778 6.20833 10 7.76389 10C9.05556 10 9.88889 9.18056 9.88889 7.90278C9.88889 6.55556 9.08333 5.76389 7.5 5.76389H6.68055V4.23611H7.5C9.08333 4.23611 9.88889 3.44444 9.88889 2.09722C9.88889 0.819445 9.05556 0 7.76389 0C6.20833 0 5.70833 0.972222 5.70833 2.13889V3.29167H4.18056V2.13889C4.18056 0.972222 3.68056 0 2.125 0C0.833333 0 0 0.819445 0 2.09722C0 3.44444 0.805556 4.23611 2.38889 4.23611H3.20833V5.76389H2.38889C0.805556 5.76389 0 6.55556 0 7.90278C0 9.18056 0.833333 10 2.125 10ZM6.68055 2.11111C6.68055 1.40278 7.04167 0.958333 7.76389 0.958333C8.41667 0.958333 8.90278 1.27778 8.90278 2.09722C8.90278 2.88889 8.48611 3.29167 7.5 3.29167H6.68055V2.11111ZM2.38889 3.29167C1.40278 3.29167 0.986111 2.88889 0.986111 2.09722C0.986111 1.27778 1.47222 0.958333 2.125 0.958333C2.84722 0.958333 3.20833 1.40278 3.20833 2.11111V3.29167H2.38889ZM4.18056 5.76389V4.23611H5.70833V5.76389H4.18056ZM2.125 9.04167C1.47222 9.04167 0.986111 8.72222 0.986111 7.90278C0.986111 7.11111 1.40278 6.70833 2.38889 6.70833H3.20833V7.88889C3.20833 8.59722 2.84722 9.04167 2.125 9.04167ZM6.68055 7.88889V6.70833H7.5C8.48611 6.70833 8.90278 7.11111 8.90278 7.90278C8.90278 8.72222 8.41667 9.04167 7.76389 9.04167C7.04167 9.04167 6.68055 8.59722 6.68055 7.88889Z",fill:o}),(0,_.jsx)("path",{d:"M13.6868 10V0.277778H14.9368V4.48611C15.0294 4.38426 15.1776 4.21296 15.3813 3.97222L18.6313 0.277778H20.1591L14.9368 6.13889V10H13.6868ZM19.1591 10L15.298 5.34722L16.1868 4.51389L20.7841 10H19.1591Z",fill:o})]})}));var wf=(0,a.forwardRef)(((e,t)=>{let{fillColor:o}=e;return(0,_.jsxs)(Te.Z,{ref:t,width:"49",height:"10",viewBox:"0 0 49 10",fill:"none","data-testid":"control_k_icon",children:[(0,_.jsx)("path",{d:"M3.74829 10C5.78659 10 6.85362 8.75513 7.0725 6.70315H5.78659C5.55404 8.11217 5.02052 8.96033 3.72093 8.96033C2.1751 8.96033 1.31327 7.3461 1.31327 4.95212C1.31327 2.57182 2.13406 1.05335 3.72093 1.05335C4.95212 1.05335 5.54036 2.01094 5.70451 3.31053H7.0725C6.9357 1.43639 5.85499 0 3.81669 0C1.47743 0 0 1.99726 0 4.95212C0 8.04378 1.35431 10 3.74829 10Z",fill:o}),(0,_.jsx)("path",{d:"M13.6882 9.91792C14.0713 9.91792 14.4817 9.8632 14.7963 9.7948V8.74145C14.4543 8.79617 14.1944 8.82353 13.9071 8.82353C12.1834 8.82353 11.7457 8.26265 11.7457 6.96306V4.17237H14.6732V3.20109H11.7457V1.02599H10.5692V3.20109H8.07947V4.17237H10.5692V7.12722C10.5692 9.11081 11.6499 9.91792 13.6882 9.91792Z",fill:o}),(0,_.jsx)("path",{d:"M19.0728 9.7948V6.55267C19.0728 5.06156 19.9209 4.17237 21.8361 4.17237C22.1371 4.17237 22.4107 4.19973 22.6432 4.22709V3.07797C22.397 3.03694 22.1918 3.02326 21.9455 3.02326C20.2082 3.02326 19.4148 3.85773 19.0728 4.59644V3.48837V3.20109H17.8963V9.7948H19.0728Z",fill:o}),(0,_.jsx)("path",{d:"M29.1632 0.218878H25.3328V1.19015H28.0004V8.82353H24.7719V9.7948H31.9265V8.82353H29.1632V0.218878Z",fill:o}),(0,_.jsx)("path",{d:"M36.7912 5.21204V2.35294H35.7926V5.21204H33.0566V6.18331H35.7926V9.04241H36.7912V6.18331H39.5409V5.21204H36.7912Z",fill:o}),(0,_.jsx)("path",{d:"M43.9404 4.50068L47.7571 0.218878H46.2523L43.0513 3.85773C42.9008 4.03557 42.7503 4.21341 42.6135 4.36388V0.218878H41.3823V9.7948H42.6135V5.99179L43.1333 5.40356L46.7722 9.7948H48.3727L43.9404 4.50068Z",fill:o})]})}));const jf={hover:{opacity:0,transition:{repeat:1/0,repeatType:"mirror",duration:.5,delay:.5,ease:"easeOut"}},default:{}},Tf=(0,b.ZP)(d.E.div).withConfig({displayName:"CollapsedCommandPrompt__RoundedRectangle",componentId:"sc-73e1lw-0"})(["height:100%;width:100%;border-radius:10px;box-shadow:",";backdrop-filter:saturate(180%) blur(20px);pointer-events:auto;background-color:",";"],(e=>{let{theme:t}=e;return t.colors.collapsedCommandPromptBoxShadow}),(e=>{let{theme:t,$activeHover:o}=e;return o?t.colors.collapsedCommandPromptBackgroundHover:t.colors.collapsedCommandPromptBackground})),Ef=(0,b.ZP)(d.E.div).withConfig({displayName:"CollapsedCommandPrompt__Content",componentId:"sc-73e1lw-1"})(["height:100%;width:100%;display:flex;justify-content:space-between;align-items:center;position:relative;padding:10px;"]),If=(0,b.ZP)(Ze.Z).withConfig({displayName:"CollapsedCommandPrompt__Button",componentId:"sc-73e1lw-2"})(["opacity:0;width:","px;height:","px;position:absolute;inset:0;"],Zm.jo,Zm.V3),Sf=b.ZP.div.withConfig({displayName:"CollapsedCommandPrompt__CursorBar",componentId:"sc-73e1lw-3"})(["width:3px;height:16px;border-radius:2px;background-color:",";transition:background-color 0.5s ease-out;"],(e=>{let{theme:t,$activeHover:o}=e;return o?t.colors.collapsedCommandPromptBlinkingCursor:t.colors.collapsedCommandPromptStaticCursor}));var _f=()=>{const{t:e}=(0,y.$G)(),t=e("commandPrompt.collapsedCommandPromptLabel"),o=(0,b.Fg)(),{commandPromptIsOpen:n,controlCommandPrompt:r}=(0,Vc.br)(),{0:i,1:l}=(0,a.useState)(!1),{0:s,1:c}=(0,a.useState)(!1),p=(0,a.useCallback)((()=>{r({action:Vc.$C.OPEN})}),[r]);return(0,_.jsx)(Tf,{onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},layout:!0,initial:!1,animate:{opacity:n?0:1},style:{borderRadius:"10px"},transition:Zm.U2,onAnimationStart:()=>{c(!0)},onAnimationComplete:()=>{c(!1),l(!1)},$activeHover:i,"data-testid":"collapsed_command_prompt","data-testid-collapsed-command-prompt-hover-state":i,children:(0,_.jsxs)(Ef,{initial:!1,animate:{opacity:n?0:1},transition:n?Zm.DJ:Zm.te,children:[(0,_.jsx)(d.E.div,{initial:{opacity:1},animate:i?"hover":"default",variants:jf,layout:!0,transition:Zm.U2,children:(0,_.jsx)(Sf,{$activeHover:i,"data-testid":"cursor_bar"})}),!n&&!s&&(0,_.jsx)(ln.Z,{content:t,placement:"top",tooltipDisabled:!i,children:(0,_.jsx)(If,{onClick:p,"aria-label":t})}),Of.Os.isMac()?(0,_.jsx)(Pf,{fillColor:o.colors.collapsedCommandPromptShortcutFill}):(0,_.jsx)(wf,{fillColor:o.colors.collapsedCommandPromptShortcutFill})]})})};var kf=e=>{let{commandRegistry:t,setShowOverlayAndBlockKeys:o,tomeId:n,isEmptyTome:r,inputJSON:i,setInputJSON:l,errorCode:s,setErrorCode:c,getCommandState:d,setCommandState:u,clearCommandState:m,resetStateIfNeeded:g,canEditDynamic:h}=e;const f=(0,a.useRef)(null),{commandPromptIsOpen:b,commandPromptMode:y,promptAnimationsEnabled:C}=(0,Vc.uJ)(),v=y===og.q$.ROOT,x=y===og.q$.SCOPED,O=b?{y:0}:{y:20},P=b?v||x?`${Zm.Wu}px`:"auto":`${Zm.jo}px`,w=b?"auto":`${Zm.V3}px`,j=C?Zm.U2:Zm.Xi,T=b?Zm.v:Zm.k$;return(0,_.jsxs)(Zm.QO,{initial:!1,animate:O,transition:Zm.U2,children:[(0,_.jsx)(Zm.Id,{children:(0,_.jsx)(rf.S,{children:(0,_.jsx)(Zm.VL,{ref:f,layout:!0,initial:!1,animate:{opacity:b?1:0,transition:T},style:{height:w,width:P,borderRadius:"12px"},transition:j,onPointerDown:Ct.Z,children:(0,_.jsx)(p.M,{onExitComplete:g,children:b&&(0,_.jsx)(xf,{commandRegistry:t,setShowOverlayAndBlockKeys:o,tomeId:n,isEmptyTome:r,inputJSON:i,inputString:(0,vg.Q)(i),setInputJSON:l,errorCode:s,setErrorCode:c,getCommandState:d,setCommandState:u,clearCommandState:m,backgroundRef:f})})})})}),h&&(0,_.jsx)(Zm.oz,{style:{zIndex:b?Zm.m4-1:Zm.m4+1},children:(0,_.jsx)(_f,{})})]})};var Zf=e=>{let{setKeyboardEnabled:t,tomeId:o,isEmptyTome:n,canEditDynamic:r}=e;const i=(0,a.useContext)(xr.Z),l=(0,a.useMemo)((()=>(e=>{const t=new Jh(e);return t.register(Oh),t.register(Jg),t.register(Mh),t.register(Zh),t.register(Th),t.register(Bh({id:Uc.CREATE_IMAGE,icon:ze.Z,title:Tc.ZP.t("commandPrompt.tiles.createImage.commandTitle"),tileType:U.YUT.Image,keywords:Tc.ZP.t("commandPrompt.tiles.createImage.keywords",{returnObjects:!0}),afterAddTileAction:gr.B.CLICK_IMAGE_TILE_CREATE_BUTTON})),t.register(Bh({id:Uc.UPLOAD_IMAGE,icon:Ue.Z,title:Tc.ZP.t("commandPrompt.tiles.uploadImage.commandTitle"),tileType:U.YUT.Image,keywords:Tc.ZP.t("commandPrompt.tiles.uploadImage.keywords",{returnObjects:!0}),afterAddTileAction:gr.B.CLICK_IMAGE_TILE_UPLOAD_BUTTON})),t.register(Bh({id:Uc.ADD_TEXT_TILE,icon:mm.Z,title:Tc.ZP.t("commandPrompt.tiles.text.commandTitle"),tileType:U.YUT.Text,keywords:Tc.ZP.t("commandPrompt.tiles.text.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_VIDEO_TILE,icon:gm.Z,title:Tc.ZP.t("commandPrompt.tiles.video.commandTitle"),tileType:U.YUT.Video,keywords:Tc.ZP.t("commandPrompt.tiles.video.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_TABLE_TILE,icon:hm.Z,title:Tc.ZP.t("commandPrompt.tiles.table.commandTitle"),tileType:U.YUT.Table,keywords:Tc.ZP.t("commandPrompt.tiles.table.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_GIPHY_TILE,icon:Om.Z,title:Tc.ZP.t("commandPrompt.tiles.giphy.commandTitle"),tileType:U.YUT.Giphy,keywords:Tc.ZP.t("commandPrompt.tiles.giphy.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_FIGMA_TILE,icon:fm.Z,title:Tc.ZP.t("commandPrompt.tiles.figma.commandTitle"),tileType:U.YUT.Figma,keywords:Tc.ZP.t("commandPrompt.tiles.figma.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_AIRTABLE_TILE,icon:bm.Z,title:Tc.ZP.t("commandPrompt.tiles.airtable.commandTitle"),tileType:U.YUT.Airtable,keywords:Tc.ZP.t("commandPrompt.tiles.airtable.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_TWITTER_TILE,icon:Cm.Z,title:Tc.ZP.t("commandPrompt.tiles.twitter.commandTitle"),tileType:U.YUT.Twitter,keywords:Tc.ZP.t("commandPrompt.tiles.twitter.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_FRAMER_TILE,icon:vm.Z,title:Tc.ZP.t("commandPrompt.tiles.framer.commandTitle"),tileType:U.YUT.Framer,keywords:Tc.ZP.t("commandPrompt.tiles.framer.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_MIRO_TILE,icon:xm.Z,title:Tc.ZP.t("commandPrompt.tiles.miro.commandTitle"),tileType:U.YUT.Miro,keywords:Tc.ZP.t("commandPrompt.tiles.miro.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_LOOKER_TILE,icon:Pm.Z,title:Tc.ZP.t("commandPrompt.tiles.looker.commandTitle"),tileType:U.YUT.Looker,keywords:Tc.ZP.t("commandPrompt.tiles.looker.keywords",{returnObjects:!0})})),t.register(Bh({id:Uc.ADD_WEB_TILE,icon:ym.Z,title:Tc.ZP.t("commandPrompt.tiles.web.commandTitle"),tileType:U.YUT.Web,keywords:Tc.ZP.t("commandPrompt.tiles.web.keywords",{returnObjects:!0})})),t.register(gg),t.register($h(Uc.OPEN_CUSTOMIZE_PANEL,Tm,Tc.ZP.t("commandPrompt.setTheme.commandTitle"),S.Z.CUSTOMIZE,Tc.ZP.t("commandPrompt.setTheme.keywords",{returnObjects:!0}))),t.register($h(Uc.OPEN_RECORD_PANEL,Sm,Tc.ZP.t("commandPrompt.recordNarration.commandTitle"),S.Z.RECORD,Tc.ZP.t("commandPrompt.recordNarration.keywords",{returnObjects:!0}))),t.register(ig),t.register(Uh),t.register(Nh),t.register(Hh),t.register(zh(Uc.PROMPT_TIPS_LINK,_m.Z,Tc.ZP.t("commandPrompt.help.promptTips.commandTitle"),"https://tome.app/tomecommunity/prompt-guide-tips-for-crafting-generative-prompts-clbtp8jdh0b5c4w5x3p596esr?utm_source=tome&utm_medium=referral&utm_campaign=command-prompt&utm_content=tips-for-crafting&utm_term=",Tc.ZP.t("commandPrompt.help.promptTips.keywords",{returnObjects:!0}))),t.register(zh(Uc.GETTING_STARTED_LINK,km.Z,Tc.ZP.t("commandPrompt.help.gettingStarted.commandTitle"),"https://tome.app/tomecommunity/tome-getting-started-guide-cl5sigulu1899274x5iqictrjgv?utm_source=tome&utm_medium=referral&utm_campaign=command-prompt&utm_content=getting-started&utm_term=",Tc.ZP.t("commandPrompt.help.gettingStarted.keywords",{returnObjects:!0}))),t.register(Wh),t})(i)),[i]),{0:s,1:c}=(0,a.useState)(um.yS),{0:d,1:u}=(0,a.useState)(null),{0:m,1:g}=(0,a.useState)(!1),h=(0,a.useCallback)((e=>{g(e),t(!e)}),[t]),{getCommandState:f,setCommandState:b,clearCommandState:y}=of(),{shouldResetCommandPromptAfterClose:C,setShouldResetCommandPromptAfterClose:v,resetCommandPromptState:x}=(0,Vc.uJ)(),O=(0,a.useCallback)((()=>{v(!1),x(),c(um.yS),u(null),y(),t(!0)}),[y,x,t,v]),P=(0,a.useCallback)((()=>{C&&O()}),[C,O]);return(0,a.useEffect)((()=>()=>{O()}),[]),(0,_.jsxs)(Zm.uS,{style:{zIndex:T.IT},children:[(0,_.jsx)(kf,{commandRegistry:l,setShowOverlayAndBlockKeys:h,tomeId:o,isEmptyTome:n,inputJSON:s,setInputJSON:c,errorCode:d,setErrorCode:u,getCommandState:f,setCommandState:b,clearCommandState:y,resetStateIfNeeded:P,canEditDynamic:r}),(0,_.jsx)(p.M,{children:m&&(0,_.jsx)(nf.C,{"data-testid":"block_clicks_and_dim_overlay",onPointerDown:Ct.Z,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:Zm.OG})})]})};const Df=m()((()=>Promise.all([o.e(8144),o.e(4988)]).then(o.bind(o,74988))),{loadableGenerated:{webpack:()=>[74988]}}),Mf=e=>{let{pages:t,presentMode:o,isMobile:n}=e;return Ld({pages:t,presentMode:o,isMobile:n}),null},Rf=(0,b.ZP)(d.E.div).withConfig({displayName:"Tome__TomeStyles",componentId:"tmbvsx-0"})(["display:flex;flex-direction:column;overflow:",";height:100%;"],(e=>e.$isMobile?"visible":"hidden")),Af=b.ZP.div.withConfig({displayName:"Tome__TomeContent",componentId:"tmbvsx-1"})(["display:flex;justify-content:center;flex:1;position:relative;"]);function Lf(e){e.preventDefault()}var Nf=e=>{var t,o,n,r;let{id:i,tome:d,isBot:u=!1,isMobileFromUA:m=!1,triggerTomeRefetch:h}=e;const O=(0,b.Fg)(),P=(0,lu.Z)(),w=(0,uu.sk)()?m:P,{t:j}=(0,y.$G)(),{user:T,flags:S,loading:k,error:Z}=(0,a.useContext)(xr.Z),{apolloClient:A,clientId:L}=(0,H.bp)(),N=(0,g.useRouter)();(0,a.useEffect)((()=>("undefined"!==typeof document&&document.addEventListener("contextmenu",Lf),()=>{document.removeEventListener("contextmenu",Lf)})),[]),(0,a.useEffect)((()=>()=>{(0,V.oG)(!1)}),[]);const[G,z]=(0,l.FV)(V.xi);(0,a.useEffect)((()=>()=>{z(!1)}),[z]),(0,a.useEffect)((()=>{if(null!==d&&void 0!==d&&d.canonicalUrl&&N.asPath){const e=new URL(d.canonicalUrl),t=new URL(N.asPath,window.location.origin);e.pathname!==t.pathname&&N.replace(e.toString().replace(e.origin,""),void 0,{shallow:!0})}}),[null===d||void 0===d?void 0:d.canonicalUrl,N,N.asPath]),(0,a.useEffect)((()=>(s.v.addRumGlobalContext("tomeId",i),()=>{s.v.removeRumGlobalContext("tomeId")})),[i]),(0,a.useEffect)((()=>{var e;k||We.ZP.reportTomeView({apolloClient:A,tomeId:i,tomeOrgId:null===(e=d.org)||void 0===e?void 0:e.id})}),[k,i,A,null===(t=d.org)||void 0===t?void 0:t.id]);const U=!k&&!T,W=(0,l.Zl)(V.Vx),q=(0,l.Zl)(V.pt),K=(0,l.rb)($n.Qf),Y=(0,l.Zl)($n.Hl),J=(0,l.Zl)($n.tF),X=(0,c.l)(V.oG),[Q,ee]=(0,l.FV)(V.DH),te=null!==Q,oe=Ts(),[ne,re]=(0,l.FV)((0,qd.J)(d.id)),ie=(0,I.t2)(),ae=null!==(0,I.f3)(),{height:le,width:se}=(0,F.Z)(),ce=(0,l.sJ)(V.GP),de=(0,l.sJ)(Le.cm),pe=(0,l.sJ)(Le.s5),ue=(0,c.l)(V.Ad),[me,ge]=(0,l.FV)(V.dt),he=(null===(o=d.currentUserPermission)||void 0===o?void 0:o.canEdit)&&!w,fe=(null===(n=d.currentUserPermission)||void 0===n?void 0:n.canComment)&&!w,be=he&&!X&&!w&&(ce||!(null!==S&&void 0!==S&&S.offlineReadOnly))&&0===ue.length,ye=(0,l._8)((e=>{let{snapshot:t}=e;return e=>{var o;const n=t.getLoadable(V.Vx).getValue();if(!be||X||te)return;const r=(0,B.xh)(d.pages,n),i=null===r?(null===(o=d.pages)||void 0===o?void 0:o.length)||0:r+1,{pageId:a,tileId:l}=(0,du.Vy)(d,i,A,L,e);W(a),(0,V.Dm)(l),q((e=>e.length>0?[]:e))}}),[be,X,te,d,A,L,W,q]),Ce=(0,a.useCallback)((()=>{(0,V.oG)(!1),ee(null),ie.closePropertyPanel(),(0,V.Dm)(null)}),[ie,ee]),ve=(0,a.useCallback)((()=>{X||(Ce(),(0,V.oG)(!0),We.ZP.reportTogglePlayMode({apolloClient:A,tomeId:i,mode:We.jv.ON}))}),[A,i,X,Ce]),xe=(0,a.useCallback)((()=>{ee(null),J(!0),(0,V.Dm)(null)}),[J,ee]),Oe=(0,a.useCallback)((()=>{X&&(he||fe)&&(Ce(),J(!0),We.ZP.reportTogglePlayMode({apolloClient:A,tomeId:i,mode:We.jv.OFF}))}),[X,he,fe,Ce,J,A,i]),{handleTap:Pe,handlePointerDown:we,handlePointerUp:je,isHoldingLeft:Te,sliderRef:Ee}=cu({pages:d.pages,enabled:w&&!ne}),{outlineWidth:Ie,propertyPanelWidth:Se,toolbarWidth:_e,pageContainerWidth:ke,pageContainerHeight:Ze,pageVerticalMargin:De}=(0,Ka.yn)(se||0,le||0,w),Me=(0,a.useRef)(),Re=(0,f.useSpring)({config:{tension:220},transform:ae?"translate3d(0px,0,0) scale(1)":"translate3d(60px,0,0) scale(0.9)",opacity:ae?1:0,onRest(){Me.current&&Me.current.triggerReMeasure()}});(0,a.useEffect)((()=>{(0,Pa.hT)(A,d.id)}),[A,d.id]);const Ae=(0,a.useRef)(null),Ne=(0,a.useRef)(null),He=(0,a.useRef)(null),Ve=(0,a.useRef)(null),Be=(0,a.useRef)(null),$e=(0,a.useRef)(null),Fe=(0,a.useRef)(null),Ge=(0,a.useRef)(null),ze=(0,a.useCallback)((e=>{if(de||pe)return;const t=Ae.current&&Ae.current.contains(e.target),o=Ne.current&&Ne.current.contains(e.target),n=He.current&&He.current.contains(e.target),r=Ve.current&&Ve.current.contains(e.target),i=Be.current&&Be.current.contains(e.target);let a=!1;Ve.current&&Ve.current.querySelectorAll("[data-tile-type]").forEach((t=>{t.contains(e.target)&&(a=!0)})),t||q((e=>e.length>0?[]:e)),o||n||r||(ie.closePropertyPanel(),(0,V.Dm)(null),(0,V.PS)(!1),Y(!1),K(),(0,V.k$)(!1)),i||(0,V.k$)(!1),Q&&!a&&xe()}),[de,pe,Q,q,ie,Y,K,xe]),Ue=(0,a.useRef)(0),qe=(0,l.Zl)(R.GS),Ke=(0,x.s)(),Ye=(0,x.s)(),Je=(0,Ba.Z)();(0,a.useEffect)((()=>{var e;null!==S&&void 0!==S&&S.mutationErrorModal&&0!==ue.length&&(ue[0].gqlErrors&&"Not Authorised!"===(null===(e=ue[0].gqlErrors[0])||void 0===e?void 0:e.message)?(s.v.addAction("showSessionErrorModal",{errorEdits:ue}),Ye.open()):(s.v.addAction("showMutationErrorModal",{errorEdits:ue}),Ke.open()))}),[ue,null===S||void 0===S?void 0:S.mutationErrorModal,Ke,Ye]);const Xe=(0,$.ye)($.TT.TILE_CUT_COPY_PASTE),Qe=(0,a.useCallback)((()=>{window.postMessage({type:mu.SG,dataTransferType:mu.T0.TILE},"*")}),[]);if((0,a.useEffect)((()=>{var e;const t=!(null===(e="cl8t9mtgr3144354v7xr4gn6cil,cl87q63j59832314v9olin8ij08,cl94ocnr82784764u5etg10rltp,clabpa1uk930704u8nbyxrumct,clbzdtalb0001853y4f6m6z8q")||!e.split(",").includes(d.id));re(t)}),[re,d.id]),!k&&Z)return null;const et=(0,rs.$Q)(d);return(0,_.jsx)(Mi.Z,{tomeId:d.id,children:(0,_.jsx)(M.e,{children:(0,_.jsx)(Kt.N,{children:(0,_.jsxs)(au.G,{children:[(0,_.jsx)(Wu,{triggerTomeRefetch:h}),(0,_.jsx)(Mf,{pages:d.pages,presentMode:X,isMobile:w}),(0,_.jsx)(Vd,{id:i,tome:d}),(0,_.jsx)(Ad,{tome:d}),(0,_.jsxs)(H.dK.Provider,{value:{outlineRef:Ae,toolbarRef:Ne,propertyPanelRef:He,currentPageRef:Ve,commentsSheetRef:Be,expandedTileRef:$e,onboardingAutotomeRef:Fe,titleEditableLabelRef:Ge},children:[(0,_.jsx)($u,{ref:Fe}),(0,_.jsx)(Zf,{setKeyboardEnabled:ge,tomeId:d.id,isEmptyTome:et,canEditDynamic:be}),(0,_.jsxs)(Rf,{$isMobile:w,"data-testid":"tome_styles",style:{backgroundColor:X||w?O.colors.page:O.colors.background},onClickCapture:Pe,onPointerDownCapture:we,onPointerUpCapture:je,onDragEnter:e=>{be&&(0,pu.C)(e)&&(Ue.current+=1,1===Ue.current&&qe(!0))},onDragLeave:e=>{be&&(0,pu.C)(e)&&(Ue.current-=1,0===Ue.current&&qe(!1))},onDrop:e=>{(0,pu.C)(e)&&(e.preventDefault(),be&&(Ue.current=0,qe(!1)))},onDragOver:e=>{(0,pu.C)(e)&&e.preventDefault()},children:[w&&(0,_.jsx)(Fu,{visible:Te}),!u&&(0,_.jsx)(ja,{tomeId:d.id}),!w&&(0,_.jsx)(_d,{tome:d,presentMode:X,expandMode:te,enterPresentMode:ve,exitPresentMode:Oe}),w&&(0,_.jsx)(pl,{isInExpandMode:te,tome:d}),(0,_.jsxs)(fu,{children:[(0,_.jsx)(bu,{asChild:!0,disabled:!Xe||!be||X,children:(0,_.jsxs)(Af,{onMouseDown:ze,children:[!w&&(0,_.jsx)(v.Z,{presentMode:X||!!Q,skipPresentModeAnimation:U,transition:E.Oo,children:(0,_.jsx)(Df,{tome:d,width:Ie,canEdit:be,onAddPage:ye,showLayoutSelection:G,setShowLayoutSelection:z})}),ne&&(null===d||void 0===d||null===(r=d.pages)||void 0===r?void 0:r[0].overlay)&&(0,_.jsx)(em,{overlayData:d.pages[0].overlay,isMobile:w,pages:d.pages,tomeId:d.id,sliderRef:Ee}),me&&(0,_.jsx)(pm,{isInExpandMode:te,enterPresentMode:ve,exitPresentMode:Oe,exitExpandMode:xe,tome:d,canEdit:be,presentMode:X,setShowLayoutSelection:z}),(0,_.jsx)(Ap,{ref:Ee,isBot:u,isMobile:w,isInExpandMode:te,canEdit:be,useEditablePage:he,presentMode:X,fullscreenMode:oe,tome:d,width:se||0,pageContainerWidth:ke,pageContainerHeight:Ze,pageVerticalMargin:De}),(0,_.jsxs)(v.Z,{presentMode:X||!!Q,skipPresentModeAnimation:U,transition:E.Oo,children:[ae&&(0,_.jsx)(Oa,{width:Se,style:Re,ref:Me,height:le||0,tome:d,toolbarWidth:_e}),!w&&be&&(0,_.jsx)(iu,{height:le||0,width:_e})]}),!u&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(p.M,{children:X&&(0,_.jsx)(D,{height:le||0,width:_e,resetToFullCanvas:Ce})}),(0,_.jsx)(Ta.Z,{subscribeTo:V.x0})]})]})}),(0,_.jsx)(Tu,{children:(0,_.jsx)(vu,{onSelect:Qe,children:j("hooks.tile.menu.paste")})})]}),(0,_.jsx)(v.Z,{presentMode:X||!!Q,skipPresentModeAnimation:U,transition:E.Oo,children:(0,_.jsx)(Eu.W,{children:!w&&(0,_.jsx)(C.Z,{})})}),!te&&(0,_.jsx)(v.Z,{presentMode:!X||w,skipPresentModeAnimation:U,children:(0,_.jsx)(Ra,{pages:d.pages,isFullscreen:oe})}),Je&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(x.Z,{ref:Ke.ref,title:j("components.tome.errorSyncing.tomeErrorSyncingModalTitle"),subtitle:j("components.tome.errorSyncing.tomeErrorSyncingModalSubtitle"),primaryButtonContent:j("components.tome.errorSyncing.reloadButtonLabel"),primaryButtonAction:()=>{var e,t;null===(e=window)||void 0===e||null===(t=e.location)||void 0===t||t.reload()},cancelButtonText:j("components.tome.errorSyncing.cancelButtonLabel"),cancelButtonAction:()=>{Ke.close()},buttonColor:"default",dismissible:!0}),(0,_.jsx)(x.Z,{ref:Ye.ref,title:j("components.tome.sessionExpired.sessionExpiredErrorModalTitle"),subtitle:j("components.tome.sessionExpired.sessionExpiredErrorModalSubtitle"),primaryButtonContent:j("components.tome.sessionExpired.signInButtonLabel"),primaryButtonAction:()=>{window.location.href=(0,js.bM)(N)},cancelButtonText:j("components.tome.sessionExpired.cancelButtonLabel"),cancelButtonAction:()=>{Ye.close()},buttonColor:"default",dismissible:!0}),(0,_.jsx)(on.n,{})]}),Je&&(0,_.jsx)(zu,{tomeId:d.id})]})]})]})})})})},Hf=o(69103),Vf=o(52322),Bf=o(8423);const $f=e=>{var t;let{guestId:o}=e;const{t:n}=(0,y.$G)(),{data:r}=(0,U.lt1)({variables:{id:o}}),i=null===r||void 0===r||null===(t=r.guestInvite)||void 0===t?void 0:t.email;if(!i)return null;const a=n("components.accessError.thisLinkWasSentToInviteEmailExtraMessage",{inviteEmail:i});return(0,_.jsx)(_.Fragment,{children:a})};var Ff=e=>{let{email:t,guestId:o}=e;const n=(0,g.useRouter)(),{t:r}=(0,y.$G)();return t?(0,_.jsx)(Bf.Z,{mainMessage:r("components.accessError.youDoNotHaveAccessToThisTomeMainErrorMessage"),children:(0,_.jsxs)(Bf.N,{children:[o&&(0,_.jsx)($f,{guestId:o}),r("components.accessError.youAreSignedInAsEmailMessage",{email:t}),(0,_.jsx)(La(),{href:(0,js.bM)(n),children:r("components.accessError.signInLinkInAccessErrorPage")}),r("components.accessError.withADifferentAccount")]})}):(0,_.jsx)(Hf.default,{})},Gf=o(76610),zf=o(87174);const Uf=["id","loadingTheme","preloadFontData"];function Wf(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function qf(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Wf(Object(o),!0).forEach((function(t){(0,r.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wf(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Kf(e){const t=null===e||void 0===e?void 0:e.currentUserPermission;return!(!(null===e||void 0===e?void 0:e.publicScope)||"PUBLIC"!==(null===t||void 0===t?void 0:t.how))||!(!t||!Js(t))}const Yf=e=>{let{id:t,fetchFullPage:o,isBot:n,isMobileFromUA:r,loadingTheme:i,ssrTome:c,preloadFontData:d,preferCache:p}=e;const u=(0,l.sJ)(V.Vx),{activePageRef:m}=(0,vi.R)(),{loading:g,error:h,data:f,refetch:b}=(0,U.OWl)({variables:{id:t,fetchFullPage:o,prefetchPreviewImage:!1},fetchPolicy:p?"cache-first":"network-only",nextFetchPolicy:"cache-first",errorPolicy:"all"}),{loading:y,data:C}=(0,U.UEB)({errorPolicy:"all"}),v=(0,l.Zl)(Vf.Z);(0,a.useEffect)((()=>function(){v(!1)}),[v]);const x=function(e){let{meData:t,meQueryLoading:o,tomeData:n,tomeQueryLoading:r,ssrTome:i}=e;const a=o?null:!t;let l;return l=i?Kf(i):r?null:Kf(n),!0===a||!0===l||(null===a||null===l?null:a||l)}({meData:null===C||void 0===C?void 0:C.me,meQueryLoading:y,tomeData:null===f||void 0===f?void 0:f.tome,tomeQueryLoading:g,ssrTome:c});(0,a.useEffect)((()=>{null!==x&&(0,V.oG)(x)}),[x]);const O=x||r,P=(null===f||void 0===f?void 0:f.tome)??(O?c:null);if((g||y)&&!c)return(0,_.jsx)(mp.Z,{theme:i,preloadFontData:d,children:(0,_.jsx)(Gf.Z,{})});if(s.v.addAction("get_tome"),h){let e=!1;"undefined"!==typeof document&&(e=document.hasFocus()),s.v.addError(h,{hasFocus:e});const t=new URL(window.location.href);if(t.searchParams.get("promptLogin"))return(0,_.jsx)(zf.Z,{});const o=t.searchParams.get("guest");return null!==C&&void 0!==C&&C.me?(0,_.jsx)(Ff,{email:null===C||void 0===C?void 0:C.me.email,guestId:o}):(0,_.jsx)(Hf.default,{})}if(!P)return null;const w=(0,B.yW)(P.pages,u);return(0,_.jsx)(mp.Z,{theme:null===w||void 0===w?void 0:w.theme,themeRef:m,activeBodyTheme:!0,loadFonts:!0,preloadFontData:d,children:(0,_.jsx)(Nf,{id:t,triggerTomeRefetch:b,tome:P,isBot:n,isMobileFromUA:r})})},Jf=e=>{const{id:t,loadingTheme:o,preloadFontData:n}=e,r=(0,i.Z)(e,Uf);return t?(0,_.jsx)(Yf,qf(qf({},r),{},{id:t,loadingTheme:o,preloadFontData:n})):(0,_.jsx)(mp.Z,{theme:o,preloadFontData:n,children:(0,_.jsx)(Gf.Z,{})})};var Xf=Yf},33820:function(e,t,o){o.d(t,{Z:function(){return j}});var n=o(67294),r=o(59016),i=o(4298),a=o.n(i),l=o(1922),s=o(53098),c=o(71515),d=o(34136),p=o(59499),u=o(24306),m=o(85893);function g(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function h(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?g(Object(o),!0).forEach((function(t){(0,p.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var f=(0,n.forwardRef)(((e,t)=>(0,m.jsx)(u.Z,h(h({ref:t,viewBox:"0 0 28 28"},e),{},{children:(0,m.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.0093 24.509V24.509C8.2103 24.509 3.50928 19.808 3.50928 14.009C3.50928 8.21006 8.2103 3.50903 14.0093 3.50903C19.8083 3.50903 24.5093 8.21006 24.5093 14.009V14.009C24.5093 19.808 19.8083 24.509 14.0093 24.509V24.509ZM14.0093 5.25903V5.25903C9.17678 5.25903 5.25928 9.17654 5.25928 14.009C5.25928 18.8415 9.17679 22.759 14.0093 22.759C18.8418 22.759 22.7593 18.8415 22.7593 14.009V14.0091C22.7593 9.17667 18.8418 5.25916 14.0094 5.25912L14.0093 5.25903ZM14.9937 15.759C14.9937 16.0007 14.7978 16.1965 14.5562 16.1965H13.5718V16.1965C13.3302 16.1965 13.1343 16.0007 13.1343 15.759C13.1343 12.8521 15.5952 13.126 15.5952 10.9465C15.5952 10.2216 14.7727 9.63403 13.9273 9.63403C13.0819 9.63403 12.2456 10.2216 12.2456 10.9465V10.9465C12.2427 11.1955 12.2811 11.4433 12.3594 11.6797V11.6797C12.4388 11.9067 12.3192 12.1551 12.0922 12.2346C12.0459 12.2508 11.9972 12.2591 11.9481 12.2591H11.0595V12.2591C10.8622 12.2596 10.6887 12.1285 10.6353 11.9385V11.9385C10.5481 11.6152 10.5057 11.2814 10.5093 10.9465C10.5093 9.25516 12.0762 7.88403 14.0093 7.88403C15.9424 7.88403 17.5093 9.25512 17.5093 10.9465C17.5092 13.7539 14.9936 13.6446 14.9936 15.7591L14.9937 15.759ZM14.0093 17.509V17.509C14.7342 17.509 15.3218 18.0967 15.3218 18.8215C15.3218 19.5464 14.7342 20.134 14.0093 20.134C13.2844 20.134 12.6968 19.5464 12.6968 18.8215V18.8216C12.6968 18.0967 13.2844 17.5091 14.0092 17.5091L14.0093 17.509Z"})})))),b=o(21585),y=o(46295);function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function v(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){(0,p.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var x=(0,n.forwardRef)(((e,t)=>(0,m.jsx)(u.Z,v(v({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,m.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M52.4973 56H11.5058V56C10.6712 55.9979 9.99628 55.3195 9.99842 54.4848C9.99854 54.4362 10.001 54.3876 10.0058 54.3392C10.677 47.5048 17.7956 40 32.0015 40C46.2074 40 53.3256 47.5048 53.997 54.3392V54.3392C54.0796 55.1698 53.4732 55.91 52.6426 55.9926C52.5944 55.9974 52.5459 55.9999 52.4973 56V56ZM32.0015 36C25.6 36 20.0082 30.4443 20.0082 21.5C20.0082 13.8 24.85 8 32.0015 8C39.153 8 43.995 13.8 43.995 21.5C43.995 30.4443 38.4032 36 32.0015 36Z"})})))),O=o(9576),P=o(30829);const w=(0,r.ZP)(d.Z).withConfig({displayName:"Help__Button",componentId:"me7xf8-0"})(["width:40px;height:40px;z-index:",";"],s.bf);var j=()=>{const e=(0,r.Fg)(),{t:t}=(0,l.$G)(),o=(0,m.jsx)(f,{style:{width:e.largerIconSize,height:e.largerIconSize}}),i=t("components.help.helpIconTooltiplabel"),s=(0,n.useCallback)((()=>{window.open("https://tome.app/tomecommunity/help-and-support-guide-cl4g57jlc4983274wc2flzoz9np","_blank")}),[]),d=(0,n.useCallback)((()=>{window.open("https://tome.app/tomecommunity/tome-getting-started-guide-cl5sigulu1899274x5iqictrjgv","_blank")}),[]),p=(0,n.useCallback)((()=>{window.open("https://calendly.com/use-tome/personal-tour","_blank")}),[]),u=(0,n.useCallback)((()=>{window.Intercom&&window.Intercom("show")}),[]),g=(0,n.useMemo)((()=>[{type:"option",text:t("components.help.gettingStartedGuideMenuItemLabel"),action:d,image:(0,m.jsx)(P.Z,{style:{width:16,height:16,marginRight:8}})},{type:"option",text:t("components.help.helpAndSupportGuideMenuItemLabel"),action:s,image:(0,m.jsx)(O.Z,{style:{width:16,height:16,marginRight:8}})},{type:"option",text:t("components.help.sendUsAMessageMenuItemLabel"),action:u,image:(0,m.jsx)(y.Z,{style:{width:16,height:16,marginRight:8}})},{type:"option",text:t("components.help.scheduleAPersonalTourMenuItemLabel"),action:p,image:(0,m.jsx)(x,{style:{width:16,height:16,marginRight:8}})}]),[p,u,s,d,t]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a(),{id:"intercom-settings",children:'\n        window.intercomSettings = {\n          api_base: "https://api-iam.intercom.io",\n          app_id: "qsgvgurd",\n          hide_default_launcher: true,\n        };      \n      '}),(0,m.jsx)(a(),{id:"intercom-script-load",strategy:"lazyOnload",children:"\n          (function(){var w=window;var ic=w.Intercom;if(typeof ic===\"function\"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/qsgvgurd';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();\n        "}),(0,m.jsx)(b.Z,{itemsOrFn:g,menuWidth:208,menuPosition:"above",menuAlign:"right",additionalSpacing:-8,children:(0,m.jsx)(c.Z,{content:i,children:(0,m.jsx)(w,{variant:"text","aria-label":i,onClick:()=>{},onZ0:!0,iconOpacity:.5,icon:o})})})]})}},39346:function(e,t,o){var n=o(59499),r=o(4730),i=o(67294),a=o(59016),l=o(85893);const s=["$visible","children","component"];function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const p=a.ZP.span.withConfig({displayName:"Badge__StyledComponent",componentId:"sc-1yq5677-0"})(["position:relative;"]),u=a.ZP.span.withConfig({displayName:"Badge__BadgeDisplay",componentId:"sc-1yq5677-1"})(["opacity:",";display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center;align-content:center;align-items:center;position:absolute;box-sizing:border-box;z-index:1;border-radius:","px;height:","px;width:","px;padding:0;background-color:",";border:1px solid ",";top:","px;right:","px;"],(e=>e.$visible?1:0),4,8,8,(e=>e.theme.colors.uiAccent),(e=>e.theme.colors.background),2,2),m=(0,i.forwardRef)(((e,t)=>{const{$visible:o=!0,children:n,component:i="span"}=e,a=(0,r.Z)(e,s);return(0,l.jsxs)(p,d(d({as:i,ref:t},a),{},{children:[(0,l.jsx)(u,{$visible:o}),n]}))}));t.Z=m},94717:function(e,t,o){o.d(t,{Y:function(){return r},Z:function(){return i}});var n=o(59016);const r=n.ZP.button.withConfig({displayName:"BaseButton",componentId:"sc-11h1mi2-0"})(["font-size:",";color:",";background:",";"," &:hover{background:",";}"],(e=>e.theme.fontSizes.xs),(e=>e.theme.colors.contrast),(e=>e.selected?e.theme.colors.buttonTransparentBackgroundSelected:e.theme.colors.transparent),(e=>e.disabled&&"\n    opacity: 0.4;\n  "),(e=>e.selected?e.theme.colors.buttonTransparentBackgroundSelectedHover:e.theme.colors.buttonTransparentBackgroundHover)),i=(0,n.ZP)(r).withConfig({displayName:"BaseButton__BaseFilledButton",componentId:"sc-11h1mi2-1"})(["background:",";&:hover{background:",";}"],(e=>e.selected?e.theme.colors.buttonFilledBackgroundSelected:e.theme.colors.buttonFilledBackground),(e=>e.selected?e.theme.colors.buttonFilledBackgroundSelectedHover:e.theme.colors.buttonFilledBackgroundHover))},35247:function(e,t,o){o.d(t,{Z:function(){return u}});var n,r=o(59016),i=o(67294);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},a.apply(this,arguments)}var l=function(e){return i.createElement("svg",a({width:39,height:37,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.667 16.855l9.79 14.022L34.406.867a2.001 2.001 0 013.05-.279c.696.732.768 1.857.172 2.672L15.49 34.97a2.482 2.482 0 01-4.07 0L.446 19.25a2.088 2.088 0 01.17-2.672 2.002 2.002 0 013.051.278z",fill:"#fff"})))},s=o(85893);const c=r.ZP.div.withConfig({displayName:"Checkbox__CheckboxContainer",componentId:"t8fn8-0"})(["position:relative;width:","px;height:","px;"],(e=>e.width),(e=>e.height)),d=r.ZP.input.attrs({type:"checkbox"}).withConfig({displayName:"Checkbox__CheckboxInput",componentId:"t8fn8-1"})(["position:absolute;top:0;left:0;opacity:0;height:100%;width:100%;cursor:pointer;"]),p=r.ZP.div.withConfig({displayName:"Checkbox__CheckboxBase",componentId:"t8fn8-2"})(["width:100%;height:100%;background:",";border-radius:2px;display:flex;align-items:center;justify-content:center;"],(e=>e.checked?e.theme.colors.uiAccent:e.theme.colors.contrast8));var u=e=>{let{id:t,height:o,width:n,checked:r,onClick:i}=e;return(0,s.jsxs)(c,{height:o,width:n,children:[(0,s.jsx)(d,{id:t,"data-testid":t,onClick:()=>i?i():null,checked:r,readOnly:!0}),(0,s.jsx)(p,{checked:r,children:r&&(0,s.jsx)(l,{viewBox:"-10 -10 60 60"})})]})}},54232:function(e,t,o){o.r(t),o.d(t,{default:function(){return ie}});var n=o(62830),r=o.n(n),i=o(67294),a=o(64310),l=o(1922),s=o(51718),c=o(50135),d=o(60864),p=o(59499),u=o(4730),m=o(82273),g=o(1150),h=o(28670),f=o.n(h),b=o(90574),y=o(24306),C=o(85893);function v(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function x(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?v(Object(o),!0).forEach((function(t){(0,p.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):v(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var O=(0,i.forwardRef)(((e,t)=>(0,C.jsx)(y.Z,x(x({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,C.jsx)("path",{d:"M33.1779 26.6645L37.3671 30.8535C38.256 31.7395 38.2583 33.1783 37.3724 34.0672C37.3709 34.0686 37.3695 34.0701 37.368 34.0715L21.555 49.8569C17.9355 53.4769 14.6766 51.7988 12.9542 53.5211C12.2418 54.1422 11.1887 54.1695 10.445 53.5862C9.86205 52.8424 9.88937 51.7895 10.5101 51.0769C12.2326 49.3546 10.5548 46.096 14.1743 42.4769L29.96 26.6636H29.96C30.8462 25.7753 32.2848 25.7735 33.1731 26.6597C33.1747 26.6613 33.1763 26.6629 33.1779 26.6645V26.6645ZM52.4868 18.9818L45.0624 26.4L46.0251 27.362C47.3262 28.6516 47.3354 30.7517 46.0458 32.0528C44.7562 33.3538 42.6561 33.363 41.355 32.0734C41.3475 32.0659 41.3399 32.0584 41.3324 32.0508L31.9471 22.6733C30.6523 21.3774 30.6532 19.2772 31.9491 17.9824C33.245 16.6876 35.3452 16.6885 36.64 17.9844L37.6329 18.9764L45.0573 11.5583V11.5583C47.1073 9.50657 50.4323 9.50512 52.4841 11.5551C54.5358 13.605 54.5373 16.9301 52.4873 18.9818H52.4868Z"})})))),P=o(16963),w=o(88902),j=o(65890),T=o(21585),E=o(40105),I=o(31343),S=o(34136),_=o(59016),k=o(38621);const Z=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__SaturationWrapper",componentId:"sc-1s5frs-0"})(["height:140px;position:relative;border-radius:8px;margin:0 12px;overflow:hidden;"]),D=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__SaturationInnerWrapper",componentId:"sc-1s5frs-1"})(["width:100%;height:100%;"]),M=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__HueWrapper",componentId:"sc-1s5frs-2"})(["width:100%;height:8px;margin:12px 0;position:relative;.hue-horizontal{border-radius:4px;width:auto;margin:0 12px;}"]),R=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__PickerContainer",componentId:"sc-1s5frs-3"})(["width:14px;height:14px;transform:",";"],(e=>e.$isHue?"translate(-7px, -3px);":"translate(-7px, -7px);")),A=_.ZP.div.attrs((e=>({style:{backgroundColor:`hsl(${e.$hue}, 100%, 50%)`}}))).withConfig({displayName:"ColorPickerPanelstyles__PickerInner",componentId:"sc-1s5frs-4"})(["width:8px;height:8px;top:3px;left:3px;border-radius:100%;position:absolute;box-shadow:inset 0px 0.5px 1.5px rgba(0,0,0,0.25);"]),L=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__PickerOuter",componentId:"sc-1s5frs-5"})(["width:14px;height:14px;border-radius:100%;background-color:transparent;position:absolute;border:3px solid white;box-shadow:0px 0.5px 1.5px rgba(0,0,0,0.25);"]),N=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__PickerInputsContainer",componentId:"sc-1s5frs-6"})(["display:flex;padding:0 12px 12px 12px;gap:8px;"]),H=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__ColorPickerOverlay",componentId:"sc-1s5frs-7"})(["position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:transparent;"]),V=()=>(0,C.jsx)(R,{"data-testid":"saturation_picker",children:(0,C.jsx)(L,{})}),B=e=>{let{hsl:t}=e;return(0,C.jsxs)(R,{$isHue:!0,"data-testid":"hue_picker",children:[(0,C.jsx)(L,{}),(0,C.jsx)(A,{$hue:t.h})]})},$=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__WorspaceColorsContainer",componentId:"sc-1s5frs-8"})(["padding:0 12px 12px 12px;"]),F=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__WorkspaceSwatches",componentId:"sc-1s5frs-9"})(["display:flex;flex-direction:row;flex-wrap:wrap;gap:8px;margin-top:9px;"]),G=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__SwatchLabel",componentId:"sc-1s5frs-10"})(["font-size:",";color:",";"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),z=_.ZP.div.withConfig({displayName:"ColorPickerPanelstyles__EmptyStateLabel",componentId:"sc-1s5frs-11"})(["font-size:",";color:",";text-align:center;padding:0px 22px;margin:4px 0px;"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),U=(0,_.ZP)(k.Z).attrs((e=>{let{color:t,theme:o}=e;return{style:{backgroundColor:t,borderColor:(0,j.D1)({foregroundColorHex:t,backgroundColorHex:o.RAW_VALUES_LEGACY.sidebar})}}})).withConfig({displayName:"ColorPickerPanelstyles__Swatch",componentId:"sc-1s5frs-12"})(["height:24px;width:24px;border-radius:100%;border-width:1px;border-style:solid;"]),W=(0,i.createContext)({}),q=e=>{let{children:t,workspaceColors:o,workspaceColorsEnabled:n,addNewWorkspaceColor:r}=e;return(0,C.jsx)(W.Provider,{value:{workspaceColors:o,workspaceColorsEnabled:n,addNewWorkspaceColor:r},children:t})};var K=W,Y=o(96012),J=o(22111);const X=(0,_.ZP)(Y.Z).withConfig({displayName:"CustomColorInput__StyledInput",componentId:"fdmdnz-0"})(["margin:0px;min-height:unset;height:28px;padding-left:12px;user-select:text;text-transform:uppercase;:focus{outline:1px "," solid;}"],(e=>{let{theme:t}=e;return t.colors.uiAccent}));var Q=e=>{let{value:t,onChangeComplete:o}=e;const{0:n,1:r}=(0,i.useState)(t),a=(0,i.useRef)(null);(0,i.useEffect)((()=>{r(t)}),[t]);const l=(0,i.useCallback)((e=>{r(e.target.value)}),[]),s=(0,i.useCallback)((()=>{const e=n.trim();if((0,J.B)(e)){const i=f()(e).hex();i!==t&&o(i),n!==t&&r(i)}else r(t)}),[n,o,t]),c=(0,i.useCallback)((e=>{e.preventDefault(),a.current&&a.current.blur()}),[]);return(0,i.useEffect)((()=>{const e=a.current;return e&&e.addEventListener("blur",s),()=>{e&&e.removeEventListener("blur",s)}}),[s]),(0,C.jsx)("form",{onSubmit:c,children:(0,C.jsx)(X,{ref:a,variant:"fill",autoComplete:"false",spellCheck:"false",value:n,onChange:l})})};const ee=["onChange","customOnChangeComplete"];function te(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function oe(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?te(Object(o),!0).forEach((function(t){(0,p.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):te(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const ne=(0,m.iS)((e=>{let{onChange:t,customOnChangeComplete:o}=e,n=(0,u.Z)(e,ee);const r=(0,I.s)(),{0:a,1:s}=(0,i.useState)({hue:!1,saturation:!1}),{workspaceColors:c,workspaceColorsEnabled:p,addNewWorkspaceColor:m}=(0,i.useContext)(K),h=c.map((e=>e.toLowerCase())),y=(0,i.useCallback)((e=>{null===o||void 0===o||o(e),null===t||void 0===t||t(e)}),[o,t]),v=(0,i.useCallback)((()=>{(new EyeDropper).open().then((e=>{if(e&&null!==e&&void 0!==e&&e.sRGBHex){const n=f()(e.sRGBHex).hex();null===t||void 0===t||t(n),o&&o(n)}})).catch((()=>{}))}),[t,o]),{t:x}=(0,l.$G)(),P=(0,i.useCallback)((()=>{n.hex&&h.includes(n.hex)?(0,d.ak)({message:x("library.colorPickerPanel.handleAddWorkspaceColorClickMessage")}):r.open()}),[n.hex,h,r,x]),w=(0,i.useCallback)((()=>{r.close()}),[r]),j=(0,i.useCallback)((()=>{n.hex&&m(n.hex),r.close()}),[m,n.hex,r]),T=(0,i.useCallback)((()=>{o&&o(n.hex),s((()=>({hue:!1,saturation:!1})))}),[o,n.hex]),E=(0,i.useCallback)((e=>{s((t=>oe(oe({},t),{},{[e]:!0})))}),[s]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(I.Z,{ref:r.ref,title:x("library.colorPickerPanel.confirmationModalTitle"),subtitle:x("library.colorPickerPanel.subtitleShareMessage"),cancelButtonText:x("library.colorPickerPanel.cancelButton"),cancelButtonAction:w,primaryButtonContent:x("library.colorPickerPanel.saveButton"),primaryButtonAction:j,buttonColor:"default",dismissible:!0}),(0,C.jsx)(Z,{"data-testid":"saturation_panel",children:(0,C.jsxs)(D,{onMouseUp:T,onMouseDown:()=>E("saturation"),children:[a.saturation&&(0,C.jsx)(H,{}),(0,C.jsx)(g.OQ,oe(oe({},n),{},{onChange:t,pointer:V}))]})}),(0,C.jsxs)(M,{onMouseUp:T,onMouseDown:()=>E("hue"),"data-testid":"hue_panel",children:[a.hue&&(0,C.jsx)(H,{}),(0,C.jsx)(g.PS,oe(oe({},n),{},{onChange:t,pointer:B}))]}),(0,C.jsxs)(N,{children:[" ",window.EyeDropper&&(0,C.jsx)(S.Z,{"aria-label":x("library.colorPickerPanel.ariaLabel.eyeDropper"),startIcon:(0,C.jsx)(O,{style:{width:18,height:18}}),style:{height:28,width:36,minWidth:36,padding:"0 10px"},iconStyles:{margin:0},onClick:v}),(0,C.jsx)(Q,{value:n.hex||"",onChangeComplete:y}),p&&(0,C.jsx)(S.Z,{value:n.hex,"aria-label":x("library.colorPickerPanel.ariaLabel.addWorkspaceColor"),startIcon:(0,C.jsx)(b.Z,{style:{width:18,height:18}}),style:{height:28,width:36,minWidth:36,padding:"0 10px"},iconStyles:{margin:0},onClick:P})]})]})}));var re=e=>{let{setColor:t,setColorComplete:o,color:n,workspaceColors:r=[],addNewWorkspaceColor:a,removeWorkspaceColor:s}=e,c=n??"#000000";"black"===n||"dark"===n?c="#000000":"light"===n&&(c="#ffffff");const d=(0,w.ye)(w.TT.WORKSPACE_COLORS),p=(0,I.s)(),u=(0,i.useRef)(null),{t:m}=(0,l.$G)(),g=(0,i.useCallback)((e=>{t(e.hex)}),[t]),h=(0,i.useCallback)((e=>{t(e.target.value),null===o||void 0===o||o(e.target.value)}),[t,o]),f=(0,E.Z)((e=>()=>{u.current=e,p.open()}),[p]),b=(0,i.useCallback)((()=>{u.current=null,p.close()}),[p]),y=(0,i.useCallback)((()=>{u.current&&(s(u.current),u.current=null),p.close()}),[s,p]);return(0,C.jsxs)("div",{"data-testid":"color_picker",children:[(0,C.jsx)(q,{workspaceColors:r,addNewWorkspaceColor:a,workspaceColorsEnabled:d,children:(0,C.jsx)(ne,{color:c,onChange:g,customOnChangeComplete:o})}),d&&(0,C.jsxs)($,{children:[(0,C.jsx)(I.Z,{ref:p.ref,title:m("library.colorPickerPanel.deleteColorTitle"),subtitle:m("library.colorPickerPanel.deleteColorMessage"),cancelButtonText:m("library.colorPickerPanel.cancelButton"),cancelButtonAction:b,primaryButtonContent:m("library.colorPickerPanel.deleteButton"),primaryButtonAction:y,dismissible:!0,buttonColor:"destructive"}),r.length>0&&(0,C.jsxs)("div",{children:[(0,C.jsx)(G,{children:m("library.colorPickerPanel.workSpace")}),(0,C.jsx)(F,{"data-testid":"workspace_swatches",children:r.map((e=>(0,C.jsx)(T.Z,{menuWidth:140,menuPosition:"below",menuAlign:"click",rightClickActivated:!0,itemsOrFn:[{text:`${m("library.colorPickerPanel.deleteSavedColorButton")}`,action:f(e),variant:"destructive"}],children:(0,C.jsx)(U,{selected:n===e,disabled:n===e,title:e,color:e,value:e,onClick:h,children:n===e&&(0,C.jsx)(P.Z,{style:{scale:.5,fill:(0,j.YC)(e),height:"100%",width:"100%"}})})},e)))})]}),0===r.length&&(0,C.jsx)(z,{"data-testid":"empty_workspace_colors_label",children:m("library.colorPickerPanel.clickPlusButtonMessage")})]})]})};var ie=e=>{var t,o,n,p,u,m,g,h,f;let{color:b,setColor:y,setColorComplete:v}=e;const{tomeId:x}=(0,i.useContext)(c.z),[O]=(0,s.bpV)(),[P]=(0,s.gG)(),{data:w,refetch:j}=(0,s.OWj)({variables:{tomeId:x},fetchPolicy:"network-only",nextFetchPolicy:"cache-first"}),T=null===w||void 0===w||null===(t=w.tome)||void 0===t||null===(o=t.org)||void 0===o||null===(n=o.colors)||void 0===n?void 0:n.map((e=>e.hex)),{t:E}=(0,l.$G)(),I=(0,i.useCallback)((e=>{var t,o;const n=null===w||void 0===w||null===(t=w.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.id;if(!n)return;const i=r()();O({variables:{colorId:i,orgId:n,colorHex:e},optimisticResponse:{__typename:"Mutation",createOrgColor:{__typename:"Color",id:i,hex:e,createdAt:(new Date).toISOString()}},update(e,t){let{data:o}=t;const r=null===o||void 0===o?void 0:o.createOrgColor;if(!r)return;const i=e.writeFragment({id:`Color:${r.id}`,fragment:s.gr2,data:r,fragmentName:"ColorFragment"});e.modify({id:`Organization:${n}`,fields:{colors(){return[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i]}}})}}).catch((t=>{var o;a.v.addError(t,{colorHex:e}),null!==t&&void 0!==t&&null!==(o=t.message)&&void 0!==o&&o.includes("already exists")?((0,d.ak)({message:E("library.stateConnectedColorPicker.alreadyExistErrorMessage")}),j({tomeId:x})):(0,d.ak)({message:E("library.stateConnectedColorPicker.oopsSomethingWentWrongErrorMessage")})}))}),[O,null===w||void 0===w||null===(p=w.tome)||void 0===p||null===(u=p.org)||void 0===u?void 0:u.id,j,x,E]),S=(0,i.useCallback)((e=>{var t,o,n,r,i,l;const s=null===w||void 0===w||null===(t=w.tome)||void 0===t||null===(o=t.org)||void 0===o?void 0:o.id,c=null===w||void 0===w||null===(n=w.tome)||void 0===n||null===(r=n.org)||void 0===r||null===(i=r.colors)||void 0===i||null===(l=i.find((t=>t.hex===e)))||void 0===l?void 0:l.id;c&&s&&P({variables:{colorId:c},optimisticResponse:{__typename:"Mutation"},update(e){e.modify({id:`Organization:${s}`,fields:{colors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{readField:t}=arguments.length>1?arguments[1]:void 0;return e.filter((e=>c!==t("id",e)))}}})}}).catch((t=>{a.v.addError(t,{colorHex:e}),(0,d.ak)({message:E("library.stateConnectedColorPicker.oopsSomethingWentWrongErrorMessage")}),j({tomeId:x})}))}),[P,null===w||void 0===w||null===(m=w.tome)||void 0===m||null===(g=m.org)||void 0===g?void 0:g.colors,null===w||void 0===w||null===(h=w.tome)||void 0===h||null===(f=h.org)||void 0===f?void 0:f.id,j,x,E]);return(0,C.jsx)(re,{addNewWorkspaceColor:I,removeWorkspaceColor:S,workspaceColors:T,color:b,setColor:y,setColorComplete:v})}},76610:function(e,t,o){var n=o(59016),r=o(85893);const i=n.ZP.div.withConfig({displayName:"LoadingPage__LoadingPageStyles",componentId:"sc-19nq0z-0"})(["width:100%;height:100%;background-color:",";"],(e=>e.theme.colors.page));t.Z=()=>(0,r.jsx)(i,{})},46075:function(e,t,o){o.d(t,{Z:function(){return p}});o(67294);var n=o(59016);const r=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleContainer",componentId:"sc-6bf9x0-0"})(["position:relative;width:",";height:",";background:",";transition:background-color 0.4s;margin:",";border-radius:","px;display:flex;justify-content:space-around;font-size:",";line-height:14px;font-weight:500;"],(e=>e.width),(e=>e.height),(e=>e.checked&&e.$onBgColor?e.theme.colors.toggleBackgroundOn:e.theme.colors.toggleBackgroundOff),(e=>e.margin),(e=>{let{radius:t=6}=e;return t}),(e=>e.theme.fontSizes.xs)),i=n.ZP.input.withConfig({displayName:"Togglestyles__ToggleInput",componentId:"sc-6bf9x0-1"})(["cursor:inherit;position:absolute;top:0;left:0;opacity:0;width:100%;height:100%;z-index:2;"]),a=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleSlider",componentId:"sc-6bf9x0-2"})(["position:absolute;top:0;left:0;cursor:pointer;background-color:",";transition:0.4s;width:calc(50% - 4px);height:calc(100% - 4px);border-radius:","px;margin:2px;input:checked ~ &{transform:translateX(calc(100% + 4px));}"],(e=>e.switchColor||(e.checked?e.theme.colors.toggleSliderOn:e.theme.colors.toggleSliderOff)),(e=>{let{radius:t=6}=e;return t-2})),l=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleOff",componentId:"sc-6bf9x0-3"})(["z-index:1;display:flex;flex-direction:row;justify-content:center;align-items:center;color:",";transition:0.4s;input:checked ~ &{color:rgba(255,255,255,0.35);}"],(e=>e.theme.colors.contrast)),s=n.ZP.div.withConfig({displayName:"Togglestyles__ToggleOn",componentId:"sc-6bf9x0-4"})(["z-index:1;display:flex;flex-direction:column;justify-content:center;color:rgba(255,255,255,0.35);transition:0.4s;input:checked ~ &{color:",";}"],(e=>e.theme.colors.contrast));var c=o(85893);const d=e=>{let{offText:t,onText:o,width:n,height:d,radius:p,checked:u,onClick:m,onBgColor:g,switchColor:h,margin:f,disabled:b,inputId:y}=e;return(0,c.jsxs)(r,{width:n,height:d,radius:p,checked:u,$onBgColor:g,margin:f,children:[(0,c.jsx)(i,{id:y,checked:u,type:"checkbox",readOnly:!0,onClick:e=>{b||m(e)}}),(0,c.jsx)(a,{checked:u,switchColor:h,radius:p}),(0,c.jsx)(l,{children:t}),(0,c.jsx)(s,{children:o})]})};d.defaultProps={offText:void 0,onText:void 0,onBgColor:!1,switchColor:void 0,margin:void 0,disabled:!1,inputId:void 0};var p=d},84562:function(e,t,o){o.d(t,{q:function(){return a}});var n=o(59499),r=o(51718),i=o(19148);class a{constructor(e,t,o){this.wireArtifactType=e,this.text=t,this.textTitleCase=o,a.values.push(this)}static getValues(){return a.values}getWireArtifactType(){return this.wireArtifactType}getText(){return this.text}getTextTitleCase(){return this.textTitleCase}}(0,n.Z)(a,"values",[]),(0,n.Z)(a,"PRESENTATION",new a(r.BzI.Presentation,"presentation",i.ZP.t("commandPrompt.clientArtifactType.presentationArtifactTypeLabel"))),(0,n.Z)(a,"OUTLINE",new a(r.BzI.Outline,"outline",i.ZP.t("commandPrompt.clientArtifactType.outlineArtifactTypeLabel"))),(0,n.Z)(a,"STORY",new a(r.BzI.Story,"story",i.ZP.t("commandPrompt.clientArtifactType.storyArtifactTypeLabel")))},7289:function(e,t,o){o.d(t,{O:function(){return a}});var n=o(59499),r=o(51718),i=o(19148);class a{constructor(e,t,o){this.wireImageStyle=e,this.menuText=t,(0,n.Z)(this,"activeText",void 0),this.activeText=o??t,a.values.push(this)}static getValues(){return a.values}getWireImageStyle(){return this.wireImageStyle}getMenuText(){return this.menuText}getActiveText(){return this.activeText}}(0,n.Z)(a,"values",[]),(0,n.Z)(a,"AUTO",new a(r.Hnc.Auto,i.ZP.t("commandPrompt.clientImageStyle.autoImageStyleLabel"),i.ZP.t("commandPrompt.clientImageStyle.imagesStyleButtonLabel"))),(0,n.Z)(a,"CYBERPUNK",new a(r.Hnc.Cyberpunk,i.ZP.t("commandPrompt.clientImageStyle.cyberpunkImageStyleLabel"))),(0,n.Z)(a,"EPIC",new a(r.Hnc.Epic,i.ZP.t("commandPrompt.clientImageStyle.epicImageStyleLabel"))),(0,n.Z)(a,"FANTASY",new a(r.Hnc.Fantasy,i.ZP.t("commandPrompt.clientImageStyle.fantasyImageStyleLabel"))),(0,n.Z)(a,"NEO_IMPRESSIONIST",new a(r.Hnc.NeoImpressionist,i.ZP.t("commandPrompt.clientImageStyle.neoImpressionistImageStyleLabel"))),(0,n.Z)(a,"POP_ART",new a(r.Hnc.PopArt,i.ZP.t("commandPrompt.clientImageStyle.popArtImageStyleLabel"))),(0,n.Z)(a,"WATERCOLOR",new a(r.Hnc.Watercolor,i.ZP.t("commandPrompt.clientImageStyle.watercolorImageStyleLabel"))),(0,n.Z)(a,"NONE",new a(r.Hnc.None,i.ZP.t("commandPrompt.clientImageStyle.noImagesStyleLabel")))},23969:function(e,t,o){o.d(t,{BO:function(){return l},d9:function(){return a},q$:function(){return i}});var n=o(84562),r=o(7289);let i;!function(e){e.ROOT="ROOT",e.SCOPED="SCOPED",e.DELEGATE="DELEGATE"}(i||(i={}));const a={imageStyle:r.O.AUTO,artifactType:n.q.PRESENTATION};let l;!function(e){e.OUT_OF_MODERATION_ERROR="OUT_OF_MODERATION_ERROR",e.RATE_LIMIT_ERROR="RATE_LIMIT_ERROR",e.GENERIC_ERROR="GENERIC_ERROR"}(l||(l={}))},78724:function(e,t,o){o.d(t,{$C:function(){return s},br:function(){return c},uJ:function(){return d}});var n=o(67294),r=o(4480),i=o(4034),a=o(60864),l=o(23969);let s;!function(e){e.OPEN="OPEN",e.CLOSE="CLOSE",e.TOGGLE_IF_AVAILABLE="TOGGLE_IF_AVAILABLE",e.INVOKE_COMMAND="INVOKE_COMMAND"}(s||(s={}));const c=()=>{const{commandPromptIsOpen:e,controlCommandPrompt:t}=d();return{commandPromptIsOpen:e,controlCommandPrompt:t}},d=()=>{const[e,t]=(0,r.FV)(p),[o,c]=(0,r.FV)(u),[d,y]=(0,r.FV)(m),[C,v]=(0,r.FV)(g),[x,O]=(0,r.FV)(b),[P,w]=(0,r.FV)(h),j=(0,r.Zl)(f),T=(0,i.t2)(),E=(0,r.Zl)(a.xi),I=(0,r.Zl)(a.B8),S=(0,n.useCallback)((()=>{T.closePropertyPanel(),E(!1),I(!1)}),[T,E,I]),_=(0,r._8)((e=>{let{snapshot:o}=e;return e=>{switch(e.action){case s.OPEN:S(),y(!0),O(!0);break;case s.CLOSE:y(!1),O(!0);break;case s.TOGGLE_IF_AVAILABLE:if(o.getLoadable(f).getValue())break;O(!0);o.getLoadable(m).getValue()||S(),y((e=>!e));break;case s.INVOKE_COMMAND:c(!0),t(e.commandId),v(l.q$.DELEGATE),S(),y(!0)}}}),[S,y,v,c,O,t]),k=(0,r.rb)(g),Z=(0,r.rb)(p),D=(0,r.rb)(f),M=(0,n.useCallback)((()=>{k(),Z(),D()}),[D,k,Z]);return(0,n.useMemo)((()=>({commandPromptIsOpen:d,commandPromptMode:C,setCommandPromptMode:v,shouldResetCommandPromptAfterClose:P,setShouldResetCommandPromptAfterClose:w,controlCommandPrompt:_,selectedCommandId:e,setSelectedCommandId:t,resetCommandPromptState:M,directlyInvokeCommand:o,setDirectlyInvokeCommand:c,setBlockCommandPromptToggle:j,promptAnimationsEnabled:x,setPromptAnimationsEnabled:O})),[d,C,v,P,w,_,e,t,M,o,c,j,x,O])},p=(0,r.cn)({key:"selectedCommandIdState",default:null}),u=(0,r.cn)({key:"directlyInvokeCommandState",default:!1}),m=(0,r.cn)({key:"commandPromptIsOpenState",default:!1}),g=(0,r.cn)({key:"commandPromptModeState",default:l.q$.ROOT}),h=(0,r.cn)({key:"shouldResetCommandPromptAfterClose",default:!1}),f=(0,r.cn)({key:"blockCommandPromptToggleState",default:!1}),b=(0,r.cn)({key:"promptAnimationsEnabledState",default:!0})},95911:function(e,t,o){o.d(t,{Jb:function(){return d},Vh:function(){return m},ex:function(){return g},fH:function(){return c},lu:function(){return u},ub:function(){return s}});var n=o(59016),r=o(1922),i=o(34136),a=o(62820),l=o(85893);const s=n.ZP.div.withConfig({displayName:"Comments__EmptyState",componentId:"x2b2nc-0"})(["height:100%;font-size:",";display:flex;flex-direction:column;text-align:center;padding:0px 25px;align-items:center;justify-content:center;color:",";"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),c=n.ZP.div.withConfig({displayName:"Comments__CommentInputSection",componentId:"x2b2nc-1"})(["display:flex;position:relative;"]),d=n.ZP.div.withConfig({displayName:"Comments__CommentsStyle",componentId:"x2b2nc-2"})(["p{user-select:text;}"]),p=n.ZP.div.withConfig({displayName:"Comments__CommentsPermissionsMessageWrapper",componentId:"x2b2nc-3"})(["text-align:center;font-size:",";color:",";padding:12px 12px 4px 12px;display:flex;align-items:center;justify-content:center;"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.contrast40)),u=()=>{const{t:e}=(0,r.$G)();return(0,l.jsx)(p,{children:e("comments.noPermissionToCommentText")})},m=n.ZP.div.withConfig({displayName:"Comments__ScrollableListStyles",componentId:"x2b2nc-4"})(["height:calc(100vh - 260px);overflow:auto;padding-top:10px;padding-bottom:23px;"]),g=e=>{let{error:t}=e;const{t:o}=(0,r.$G)();return t?(0,l.jsx)(m,{children:(0,l.jsxs)(s,{children:[(0,l.jsx)("p",{children:o("comments.commentsFailedToLoadText")}),(0,l.jsx)(i.Z,{onClick:()=>{window.location.reload()},children:o("comments.refreshPageButton")})]})}):(0,l.jsx)(m,{children:(0,l.jsx)(s,{children:(0,l.jsx)(a.T,{})})})}},9576:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.15 50.8536H29.15C25.5124 48.9538 21.4637 47.9769 17.36 48.0088V48.0088C15.0346 48.0305 12.7213 48.347 10.4755 48.9505V48.9505C9.88645 49.1408 9.25462 48.8176 9.0643 48.2285C9.02788 48.1158 9.00955 47.998 9.01002 47.8795V15.2637V15.2636C9.00986 14.7937 9.30188 14.3731 9.7423 14.2091H9.7423C12.211 13.4469 14.7765 13.0435 17.36 13.0112H17.36C21.981 12.956 26.5228 14.2132 30.4575 16.6369V16.6369C30.8049 16.8685 31.0126 17.2594 31.01 17.6769V49.7838V49.7838C31.0051 50.4702 30.4447 51.0226 29.7584 51.0177C29.5449 51.0162 29.3353 50.9596 29.15 50.8536H29.15ZM55.01 15.2636V47.8795V47.8795C55.0124 48.4986 54.5126 49.0024 53.8935 49.0048C53.775 49.0053 53.6572 48.9869 53.5445 48.9505V48.9505C51.2987 48.347 48.9854 48.0305 46.66 48.0088V48.0088C42.5563 47.9769 38.5076 48.9539 34.87 50.8536V50.8536C34.2743 51.1945 33.515 50.9879 33.1741 50.3921C33.068 50.2068 33.0115 49.9972 33.01 49.7836V17.6769V17.6769C33.0075 17.2594 33.2151 16.8685 33.5625 16.6369H33.5625C37.4973 14.2132 42.039 12.956 46.66 13.0112H46.66C49.2436 13.0435 51.8092 13.4469 54.278 14.2091V14.2091C54.7183 14.3733 55.0102 14.7938 55.01 15.2637V15.2636Z"})}))));t.Z=c},30362:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{d:"M12 52V28C12 26.8954 12.8954 26 14 26H24C25.1046 26 26 26.8954 26 28V52C26 53.1046 25.1046 54 24 54H14C12.8954 54 12 53.1046 12 52ZM16 49C16 49.5523 16.4477 50 17 50H21C21.5523 50 22 49.5523 22 49V47C22 46.4477 21.5523 46 21 46H17C16.4477 46 16 46.4477 16 47V49ZM16 41C16 41.5523 16.4477 42 17 42H21C21.5523 42 22 41.5523 22 41V39C22 38.4477 21.5523 38 21 38H17C16.4477 38 16 38.4477 16 39V41ZM16 33C16 33.5523 16.4477 34 17 34H21C21.5523 34 22 33.5523 22 33V31C22 30.4477 21.5523 30 21 30H17C16.4477 30 16 30.4477 16 31V33ZM50 54H32C30.8954 54 30 53.1046 30 52V12C30 10.8954 30.8954 10 32 10H50C51.1046 10 52 10.8954 52 12V52C52 53.1046 51.1046 54 50 54ZM40 15C40 14.4477 39.5523 14 39 14H35C34.4477 14 34 14.4477 34 15V17C34 17.5523 34.4477 18 35 18H39C39.5523 18 40 17.5523 40 17V15ZM40 23C40 22.4477 39.5523 22 39 22H35C34.4477 22 34 22.4477 34 23V25C34 25.5523 34.4477 26 35 26H39C39.5523 26 40 25.5523 40 25V23ZM40 31C40 30.4477 39.5523 30 39 30H35C34.4477 30 34 30.4477 34 31V33C34 33.5523 34.4477 34 35 34H39C39.5523 34 40 33.5523 40 33V31ZM40 39C40 38.4477 39.5523 38 39 38H35C34.4477 38 34 38.4477 34 39V41C34 41.5523 34.4477 42 35 42H39C39.5523 42 40 41.5523 40 41V39ZM40 47C40 46.4477 39.5523 46 39 46H35C34.4477 46 34 46.4477 34 47V49C34 49.5523 34.4477 50 35 50H39C39.5523 50 40 49.5523 40 49V47ZM48 15C48 14.4477 47.5523 14 47 14H43C42.4477 14 42 14.4477 42 15V17C42 17.5523 42.4477 18 43 18H47C47.5523 18 48 17.5523 48 17V15ZM48 23C48 22.4477 47.5523 22 47 22H43C42.4477 22 42 22.4477 42 23V25C42 25.5523 42.4477 26 43 26H47C47.5523 26 48 25.5523 48 25V23ZM48 31C48 30.4477 47.5523 30 47 30H43C42.4477 30 42 30.4477 42 31V33C42 33.5523 42.4477 34 43 34H47C47.5523 34 48 33.5523 48 33V31ZM48 39C48 38.4477 47.5523 38 47 38H43C42.4477 38 42 38.4477 42 39V41C42 41.5523 42.4477 42 43 42H47C47.5523 42 48 41.5523 48 41V39ZM48 47C48 46.4477 47.5523 46 47 46H43C42.4477 46 42 46.4477 42 47V49C42 49.5523 42.4477 50 43 50H47C47.5523 50 48 49.5523 48 49V47Z"})}))));t.Z=c},16963:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{d:"M16.6257 30.8353L26.4175 44.8488L47.3744 14.8566V14.8566C48.0067 13.9503 49.2546 13.7278 50.1617 14.3595C50.2557 14.425 50.3439 14.4983 50.4253 14.5789V14.5789C51.1212 15.3103 51.1934 16.4345 50.5967 17.2488L28.4527 48.94V48.94C27.6673 50.063 26.1194 50.3373 24.9953 49.5526C24.7565 49.3859 24.549 49.1785 24.3822 48.94L13.4034 33.2278V33.2278C12.8066 32.4134 12.8788 31.289 13.5748 30.5574V30.5574C14.3607 29.7803 15.6284 29.7868 16.4062 30.572C16.4868 30.6534 16.5602 30.7415 16.6257 30.8353H16.6257Z"})}))));t.Z=c},46295:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 38.4706V22C10 17.5817 13.5817 14 18 14H46C50.4183 14 54 17.5817 54 22V38C54 42.4183 50.4183 46 46 46H30.7241C30.2562 46 29.8032 46.164 29.4437 46.4636L21.2804 53.2664C19.9777 54.3519 18 53.4256 18 51.7299V46.4706C18 46.2107 17.7893 46 17.5294 46C13.371 46 10 42.629 10 38.4706ZM19 26C19 24.8954 19.8954 24 21 24H43C44.1046 24 45 24.8954 45 26C45 27.1046 44.1046 28 43 28H21C19.8954 28 19 27.1046 19 26ZM21 32C19.8954 32 19 32.8954 19 34C19 35.1046 19.8954 36 21 36H37C38.1046 36 39 35.1046 39 34C39 32.8954 38.1046 32 37 32H21Z"})}))));t.Z=c},47314:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M53.0208 32.0208C53.0208 34.7822 50.7822 37.0208 48.0208 37.0208C45.2594 37.0208 43.0208 34.7822 43.0208 32.0208C43.0208 29.2593 45.2594 27.0208 48.0208 27.0208C50.7822 27.0208 53.0208 29.2593 53.0208 32.0208ZM37.0208 32.0208C37.0208 34.7822 34.7822 37.0208 32.0208 37.0208C29.2594 37.0208 27.0208 34.7822 27.0208 32.0208C27.0208 29.2593 29.2594 27.0208 32.0208 27.0208C34.7822 27.0207 37.0209 29.2592 37.0209 32.0207C37.0209 32.0207 37.0209 32.0207 37.0209 32.0208H37.0208ZM16.0208 27.0208C18.7822 27.0208 21.0208 29.2593 21.0208 32.0208C21.0208 34.7822 18.7822 37.0208 16.0208 37.0208C13.2594 37.0208 11.0208 34.7822 11.0208 32.0208V32.0209C11.0208 29.2595 13.2593 27.021 16.0206 27.0209L16.0208 27.0208Z"})}));t.Z=(0,r.forwardRef)(c)},44196:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsxs)("g",{children:[(0,a.jsx)("path",{d:"M37.5 11C36.3954 11 35.5 11.8954 35.5 13C35.5 14.1046 36.3954 15 37.5 15H46.6716L30.5858 31.0858C29.8047 31.8668 29.8047 33.1332 30.5858 33.9142C31.3668 34.6953 32.6332 34.6953 33.4142 33.9142L49.5 17.8284V27C49.5 28.1046 50.3954 29 51.5 29C52.6046 29 53.5 28.1046 53.5 27V13C53.5 11.8954 52.6046 11 51.5 11H37.5Z"}),(0,a.jsx)("path",{d:"M16 22C16 20.8954 16.8954 20 18 20H22C23.1046 20 24 19.1046 24 18C24 16.8954 23.1046 16 22 16H18C14.6863 16 12 18.6863 12 22V47C12 50.3137 14.6863 53 18 53H43C46.3137 53 49 50.3137 49 47V43C49 41.8954 48.1046 41 47 41C45.8954 41 45 41.8954 45 43V47C45 48.1046 44.1046 49 43 49H18C16.8954 49 16 48.1046 16 47V22Z"})]})}))));t.Z=c},30829:function(e,t,o){var n=o(59499),r=o(67294),i=o(24306),a=o(85893);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const c=(0,r.forwardRef)(((e,t)=>(0,a.jsx)(i.Z,s(s({ref:t,viewBox:"0 0 64 64"},e),{},{children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M39.268 40.5977C38.6861 42.5877 38.2125 44.0192 36.198 44.0192H27.8468C25.832 44.0192 25.3583 42.5875 24.7768 40.5977C22.8344 33.9552 17.1026 31.7516 17.0268 23.1716V23.1716C16.9468 14.8894 23.5959 8.1105 31.8781 8.0305C40.1602 7.95048 46.9392 14.5996 47.0192 22.8818C47.0201 22.9784 47.0201 23.075 47.0192 23.1716C46.9423 31.7516 41.21 33.9552 39.268 40.5977V40.5977ZM27.0188 46.0194H37.0257V46.0194C38.1305 46.0194 39.0261 46.915 39.0261 48.0198C39.0261 49.1246 38.1305 50.0202 37.0257 50.0202H27.0188V50.0202C25.914 50.0202 25.0184 49.1246 25.0184 48.0198C25.0184 46.915 25.914 46.0194 27.0188 46.0194V46.0194ZM28.19 52.0199H35.8548V52.0199C36.5017 52.0201 37.026 52.5447 37.0259 53.1916C37.0259 53.1916 37.0259 53.1916 37.0259 53.1916V53.1917C37.0259 53.7223 36.8152 54.2311 36.4401 54.6063L35.6124 55.4348V55.4348C35.2376 55.8098 34.7292 56.0206 34.199 56.0206H29.8455H29.8455C29.3153 56.0206 28.8069 55.8098 28.4321 55.4348L27.6044 54.6063V54.6063C27.2295 54.231 27.0188 53.7222 27.0188 53.1917V53.1917C27.0186 52.5448 27.5428 52.0201 28.1898 52.0199C28.1898 52.0199 28.1899 52.0199 28.19 52.0199V52.0199Z"})}))));t.Z=c},37982:function(e,t,o){var n=o(59499),r=o(4730),i=o(67294),a=o(24306),l=o(85893);const s=["pathFill"];function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const p=(0,i.forwardRef)(((e,t)=>{let{pathFill:o="currentcolor"}=e,n=(0,r.Z)(e,s);return(0,l.jsx)(a.Z,d(d({ref:t,viewBox:"0 0 64 64"},n),{},{children:(0,l.jsx)("path",{fill:o,d:"M 63.648438 29.429688 L 58.011719 9.296875 C 57.792969 8.507812 57.371094 7.789062 56.792969 7.207031 C 56.210938 6.628906 55.492188 6.207031 54.703125 5.988281 L 34.570312 0.351562 C 32.886719 -0.117188 31.109375 -0.117188 29.429688 0.351562 L 9.296875 5.988281 C 8.507812 6.207031 7.789062 6.628906 7.207031 7.207031 C 6.628906 7.785156 6.207031 8.503906 5.988281 9.292969 L 0.351562 29.429688 C -0.117188 31.109375 -0.117188 32.890625 0.351562 34.570312 L 5.984375 54.707031 C 6.207031 55.496094 6.625 56.214844 7.207031 56.792969 C 7.785156 57.375 8.507812 57.792969 9.296875 58.015625 L 29.433594 63.648438 C 31.113281 64.117188 32.890625 64.117188 34.574219 63.648438 L 54.707031 58.015625 C 55.496094 57.792969 56.214844 57.371094 56.792969 56.792969 C 57.375 56.214844 57.792969 55.496094 58.015625 54.707031 L 63.648438 34.570312 C 64.117188 32.890625 64.117188 31.109375 63.648438 29.429688 Z M 58.429688 34.25 L 34.25 58.429688 C 33.953125 58.726562 33.601562 58.960938 33.214844 59.121094 C 32.832031 59.28125 32.417969 59.363281 32 59.363281 C 31.582031 59.363281 31.167969 59.28125 30.78125 59.121094 C 30.398438 58.960938 30.046875 58.726562 29.75 58.429688 L 5.570312 34.25 C 5.273438 33.953125 5.039062 33.605469 4.878906 33.21875 C 4.71875 32.832031 4.636719 32.417969 4.636719 32 C 4.636719 31.582031 4.71875 31.167969 4.878906 30.785156 C 5.039062 30.398438 5.273438 30.046875 5.570312 29.753906 L 29.75 5.570312 C 30.046875 5.273438 30.398438 5.039062 30.78125 4.878906 C 31.167969 4.722656 31.582031 4.636719 32 4.636719 C 32.417969 4.636719 32.832031 4.722656 33.214844 4.878906 C 33.601562 5.039062 33.953125 5.273438 34.25 5.570312 L 58.429688 29.753906 C 58.722656 30.046875 58.957031 30.398438 59.117188 30.785156 C 59.277344 31.167969 59.359375 31.582031 59.359375 32 C 59.359375 32.417969 59.277344 32.832031 59.117188 33.21875 C 58.957031 33.605469 58.722656 33.953125 58.429688 34.25 Z M 58.429688 34.25 "})}))}));t.Z=p},31343:function(e,t,o){o.d(t,{s:function(){return u}});var n=o(59499),r=o(67294),i=o(34136),a=o(36948),l=o(26190),s=o(67091),c=o(85893);function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function p(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const u=()=>{const e=(0,r.useRef)(),t=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.open()}),[e]),o=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.close()}),[e]);return{ref:e,open:t,close:o}},m=(0,r.forwardRef)(((e,t)=>{const{title:o,subtitle:n,children:d,cancelButtonText:u,cancelButtonAction:m,primaryButtonContent:g,primaryButtonAction:h,dismissible:f=!0,buttonColor:b,onOpen:y,onClose:C}=e,{0:v,1:x}=(0,r.useState)(!1),O=(0,r.useCallback)((()=>{x(!0),null===y||void 0===y||y()}),[y]),P=(0,r.useCallback)((()=>{x(!1),null===C||void 0===C||C()}),[C]);return(0,r.useImperativeHandle)(t,(()=>({open:O,close:P}))),(0,c.jsxs)(a.u_,{open:v,onOpenChange:e=>x(e),modal:!0,children:[(0,c.jsx)(s.kZ,{}),(0,c.jsxs)(s.If,{"data-testid":"confirmation_container",width:240,onPointerDownOutside:f?void 0:e=>{e.preventDefault()},children:[(0,c.jsxs)(s.v5,{children:[(0,c.jsx)(s.Dx,{children:o}),(0,c.jsx)(s.QE,{children:n}),d]}),(0,c.jsxs)(s.KE,{$center:!f,children:[f&&(0,c.jsx)(i.Z,{onMouseDown:l.Z,onClick:m,children:u}),(0,c.jsx)(i.Z,{color:f&&!b?"destructive":b,onMouseDown:l.Z,onClick:h,style:p({},f?{}:{width:"100%"}),children:g})]})]})]})}));t.Z=m},15814:function(e,t,o){o.d(t,{m:function(){return f}});var n=o(59499),r=o(67294),i=o(87536),a=o(59016),l=o(1922),s=o(34136),c=o(36948),d=o(96012),p=o(26190),u=o(67091),m=o(85893);function g(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function h(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?g(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const f=()=>{const e=(0,r.useRef)(),t=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.open()}),[e]),o=(0,r.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.close()}),[e]);return{ref:e,open:t,close:o}},b=(0,a.ZP)(u.QE).withConfig({displayName:"PromptModal__CustomSubtitle",componentId:"ezwveb-0"})(["padding-bottom:4px;"]),y=(0,a.ZP)(u.v5).withConfig({displayName:"PromptModal__CustomContentArea",componentId:"ezwveb-1"})(["padding:12px 12px 0 12px;"]),C=(0,r.forwardRef)(((e,t)=>{const{t:o}=(0,l.$G)(),{title:n,subtitle:a,primaryButtonText:g,cancelButtonText:f=o("components.promptModal.cancelPromptModalButtonLabel"),buttonColor:C="default",placeholder:v,onSubmit:x}=e,{0:O,1:P}=(0,r.useState)(!1),w=(0,r.useCallback)((()=>{P(!0)}),[]),j=(0,r.useCallback)((()=>{P(!1)}),[]);(0,r.useImperativeHandle)(t,(()=>({open:w,close:j})));const{register:T,handleSubmit:E,formState:{isValid:I,isSubmitting:S},reset:_}=(0,i.cI)({mode:"onChange"});return(0,m.jsxs)(c.u_,{open:O,onOpenChange:e=>P(e),modal:!0,children:[(0,m.jsx)(u.kZ,{}),(0,m.jsx)(u.If,{width:240,"data-testid":"prompt_modal",onMouseDown:p.Z,children:(0,m.jsxs)("form",{onSubmit:E((e=>{x(e.prompt),j(),_()})),autoComplete:"off",children:[(0,m.jsxs)(y,{children:[(0,m.jsx)(u.Dx,{children:n}),a&&(0,m.jsx)(b,{children:a}),(0,m.jsx)(d.Z,h({variant:"fill",placeholder:v},T("prompt",{required:!0})))]}),(0,m.jsxs)(u.KE,{children:[(0,m.jsx)(s.Z,{onClick:j,children:f}),(0,m.jsx)(s.Z,{type:"submit",color:C,disabled:!I||S,children:g})]})]})})]})}));t.Z=C},67558:function(e,t,o){o.d(t,{B:function(){return C},DX:function(){return i},GJ:function(){return c},Ir:function(){return d},M$:function(){return s},WE:function(){return a},Z5:function(){return b},a4:function(){return h},c3:function(){return l},kv:function(){return f},pP:function(){return m},pf:function(){return u},tL:function(){return g},xp:function(){return y},y3:function(){return p}});var n=o(59016),r=o(60559);const i=n.ZP.div.withConfig({displayName:"UserPresencestyles__UserPresenceStyles",componentId:"sc-1urgstr-0"})(["display:flex;flex-direction:column;position:relative;"]),a=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsWrapper",componentId:"sc-1urgstr-1"})(["display:flex;flex-direction:row;align-items:center;cursor:pointer;margin-right:8px;"]),l=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsOverflow",componentId:"sc-1urgstr-2"})(["font-size:","px;font-weight:500;line-height:","px;color:",";padding:2px 6px 2px 4px;margin-left:4px;border-radius:36px;background-color:",";display:flex;"],(e=>e.$fontSize),(e=>e.$lineHeight),(e=>e.theme.colors.seenByOverflow),(e=>e.theme.colors.seenByOverflowBackground)),s=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsOverflowPlus",componentId:"sc-1urgstr-3"})(["font-size:","px;line-height:","px;"],(e=>e.$fontSize),(e=>e.$lineHeight)),c=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsBackground",componentId:"sc-1urgstr-4"})(["width:","px;background-color:",";box-shadow:",";border-radius:12px;"],r.sK,(e=>e.theme.colors.menuBackgroundLayer[0]),(e=>{let{theme:t}=e;return t.colors.sheetBoxShadow})),d=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetail",componentId:"sc-1urgstr-5"})(["width:","px;padding:4px 12px;overflow-y:auto;max-height:70vh;min-height:10px;"],r.sK),p=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailHeader",componentId:"sc-1urgstr-6"})(["height:34px;color:",";font-size:",";font-weight:500;line-height:22px;padding:18px 12px;z-index:1;padding-top:8px;"],(e=>e.theme.colors.contrast40),(e=>e.theme.fontSizes.sm)),u=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailRow",componentId:"sc-1urgstr-7"})(["display:flex;flex-direction:row;align-items:stretch;height:32px;font-size:",";line-height:17px;padding:6px 0;color:",";"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.contrast40)),m=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailNameLabel",componentId:"sc-1urgstr-8"})(["align-self:center;flex-grow:0;flex-shrink:0;flex-basis:auto;margin-left:8px;font-size:",";color:",";text-overflow:ellipsis;white-space:nowrap;overflow:hidden;"],(e=>e.theme.fontSizes.sm),(e=>e.theme.colors.seenByDetailName)),g=n.ZP.div.withConfig({displayName:"UserPresencestyles__SeenHeadsDetailTimeLabel",componentId:"sc-1urgstr-9"})(["margin-left:4px;align-self:center;"]),h=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverWrapper",componentId:"sc-1urgstr-10"})(["width:","px;display:flex;flex-direction:column;align-items:center;margin-top:-6px;"],200),f=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverStyles",componentId:"sc-1urgstr-11"})(["background-color:",";border-radius:8px;padding:6px 8px;display:flex;flex-direction:column;align-items:center;"],(e=>e.theme.colors.tooltipBg)),b=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverName",componentId:"sc-1urgstr-12"})(["font-size:",";font-weight:500;line-height:16px;"],(e=>e.theme.fontSizes.sm)),y=n.ZP.div.withConfig({displayName:"UserPresencestyles__ProfileHoverContent",componentId:"sc-1urgstr-13"})(["margin-top:2px;font-size:",";line-height:13px;color:",";"],(e=>e.theme.fontSizes.xxs),(e=>e.theme.colors.tooltipSecondaryTextColor)),C=n.ZP.span.withConfig({displayName:"UserPresencestyles__GuestLabel",componentId:"sc-1urgstr-14"})(["font-size:",";color:",";margin-left:4px;"],(e=>{let{theme:t}=e;return t.fontSizes.xxs}),(e=>{let{theme:t}=e;return t.colors.guestBadgeText}))},30934:function(e,t,o){o.d(t,{Z:function(){return _}});var n=o(67294),r=o(95421),i=o(19148),a=o(47901),l=o(48811),s=o(77717),c=o(71515),d=o(85684),p=o(60559),u=o(67558),m=o(59016),g=o(1922),h=o(53098),f=o(59499),b=o(24306),y=o(85893);function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function v(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){(0,f.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var x=(0,n.forwardRef)(((e,t)=>(0,y.jsxs)(b.Z,v(v({ref:t,viewBox:"0 0 64 64"},e),{},{children:[(0,y.jsx)("path",{d:"M34 22C34 23.6569 32.6569 25 31 25C29.3431 25 28 23.6569 28 22C28 20.3431 29.3431 19 31 19C32.6569 19 34 20.3431 34 22Z"}),(0,y.jsx)("path",{d:"M26 30C26 28.8954 26.8954 28 28 28H32C33.1046 28 34 28.8954 34 30V39.5C34 39.7761 34.2239 40 34.5 40H37C38.1046 40 39 40.8954 39 42C39 43.1046 38.1046 44 37 44H27C25.8954 44 25 43.1046 25 42C25 40.8954 25.8954 40 27 40H29.5C29.7761 40 30 39.7761 30 39.5V32.5C30 32.2239 29.7761 32 29.5 32H28C26.8954 32 26 31.1046 26 30Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M56 32C56 45.2548 45.2548 56 32 56C18.7452 56 8 45.2548 8 32C8 18.7452 18.7452 8 32 8C45.2548 8 56 18.7452 56 32ZM52 32C52 43.0457 43.0457 52 32 52C20.9543 52 12 43.0457 12 32C12 20.9543 20.9543 12 32 12C43.0457 12 52 20.9543 52 32Z"})]}))));function O(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function P(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?O(Object(o),!0).forEach((function(t){(0,f.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var w=(0,n.forwardRef)(((e,t)=>(0,y.jsx)(b.Z,P(P({ref:t,style:{width:"1em",height:"1em"},viewBox:"0 0 64 64"},e),{},{children:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M52.4973 56H11.5058V56C10.6712 55.9979 9.99628 55.3195 9.99842 54.4848C9.99854 54.4362 10.001 54.3876 10.0058 54.3392C10.677 47.5048 17.7956 40 32.0015 40C46.2074 40 53.3256 47.5048 53.997 54.3392V54.3392C54.0796 55.1698 53.4732 55.91 52.6426 55.9926C52.5944 55.9974 52.5459 55.9999 52.4973 56V56ZM32.0015 36C25.6 36 20.0082 30.4443 20.0082 21.5C20.0082 13.8 24.85 8 32.0015 8C39.153 8 43.995 13.8 43.995 21.5C43.995 30.4443 38.4032 36 32.0015 36Z"})}))));const j=(0,m.ZP)(w).withConfig({displayName:"UserPresenceList__StyledAnonUserIcon",componentId:"v7nwj6-0"})(["width:20px !important;height:20px !important;flex-basis:20px;flex-shrink:0;flex-grow:0;color:",";"],(e=>{let{theme:t}=e;return t.colors.uiAccent})),T=(0,m.ZP)(x).withConfig({displayName:"UserPresenceList__StyledInfoIcon",componentId:"v7nwj6-1"})(["width:20px;height:20px;margin-left:5px;transform:translateY(5px);"]),E=m.ZP.div.withConfig({displayName:"UserPresenceList__StyledLabelIcon",componentId:"v7nwj6-2"})(["display:inline;"]),I=m.ZP.div.withConfig({displayName:"UserPresenceList__StyledLabelTimeContainer",componentId:"v7nwj6-3"})(["justify-content:space-between;display:flex;flex:1;"]);var S=e=>{let{activities:t,userOrgName:o}=e;const n=(0,m.Fg)(),{t:r}=(0,g.$G)();return(0,y.jsxs)(u.GJ,{children:[(0,y.jsx)(u.y3,{children:r("userPresence.seenByHeader")}),(0,y.jsx)(u.Ir,{children:t.map((e=>((e,t,o,n)=>{var r;return e.user?(0,y.jsxs)(u.pf,{children:[(0,y.jsx)(l.Z,{user:e.user,size:20}),(0,y.jsxs)(I,{children:[(0,y.jsx)(u.pP,{children:null===(r=e.user)||void 0===r?void 0:r.name}),(0,y.jsx)(u.tL,{children:e.label})]})]},e.activityId):(0,y.jsxs)(u.pf,{children:[(0,y.jsx)(j,{}),(0,y.jsx)(u.pP,{children:e.label}),(0,y.jsx)(E,{children:(0,y.jsx)(c.Z,{content:`Viewers outside of ${t}`,placement:"top",style:{marginTop:"-5px"},zIndex:h.y$,background:o,children:(0,y.jsx)(T,{style:{fill:n}})})})]},e.activityId)})(e,o??"",n.colors.tooltipOnSheetBg,n.colors.contrast40)))})]})};var _=e=>{let{seenHeadsViewModels:t,overflowViewModels:o,avatarSize:m,navigateToPage:g,dropShadow:h=!1,animated:f=!1,anonymousViewers:b=0,userOrgName:C=""}=e;const v=(0,n.useRef)(null),{0:x,1:O}=(0,n.useState)(!1),P=(0,n.useRef)(null),w=(0,n.useCallback)((()=>{O(!1)}),[]);if((0,a.Z)({handleClose:w,enabled:x}),0===t.length)return null;const j=t.map((e=>function(e,t,o,n,r,a,s){const c={marginLeft:"3px"};return r&&(c.filter="drop-shadow(rgba(0, 0, 0, 0.10) -2px -2px 3px)"),(0,y.jsx)(l.Z,{user:e.user,opacity:o,size:t,style:c,animated:a,renderTooltip:()=>{var t,o;return n&&(0,y.jsx)(u.a4,{children:(0,y.jsxs)(u.kv,{children:[(0,y.jsx)(u.Z5,{children:null===(t=e.user)||void 0===t?void 0:t.name}),(0,y.jsxs)(u.xp,{children:[!0===(null===(o=e.user)||void 0===o?void 0:o.isGuest)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u.B,{children:i.ZP.t("userPresence.guest")})," \xb7 "]}),e.label]})]})})},onClick:()=>null===s||void 0===s?void 0:s(e.viewingPageId)},e.activityId)}(e,m,e.isActive?1:.4,!0,h,f,g)));let T=0,E=0;if(v.current){const e=v.current.getBoundingClientRect();T=e.x+e.width/2-p.sK/2,E=e.y+e.height+8}let I=0;return I=b>0?o.length-1-t.length+b:o.length-t.length,(0,y.jsxs)(u.DX,{"data-testid":"user_presence",children:[(0,y.jsxs)(u.WE,{ref:v,children:[(0,y.jsx)(c.Z,{placement:"bottom",offset:10,ignoreWrapper:!0,withBackground:!1,children:(0,y.jsx)(r.M,{children:j})}),I>0&&(0,y.jsxs)(u.c3,{ref:P,$lineHeight:m-4,$fontSize:m-7,onMouseDown:()=>{O(!x)},children:[(0,y.jsx)(u.M$,{$lineHeight:m-4,$fontSize:m-9,children:"+"}),(0,y.jsx)("div",{children:`${I.toLocaleString()}`})]})]}),x&&(0,y.jsx)(s.Z,{left:T,top:E,zIndex:200,children:(0,y.jsx)(d.Z,{exemptContainerRefs:[P],onClick:()=>{x&&O(!1)},children:(0,y.jsx)(S,{activities:o,userOrgName:C})})})]})}},21025:function(e,t,o){o.d(t,{K3:function(){return d},Pr:function(){return l},UO:function(){return c},tQ:function(){return i}});var n=o(19148),r=o(60928);const i=e=>e>=1440?8:e>=1312?7:e>=1184?6:e>=1056?5:e>=928?4:3,a=e=>e.active?n.ZP.t("userPresence.viewingNow"):`${(0,r.Z)(e.lastTimestamp,!0,!1)}`,l=e=>{var t,o;return{user:{name:null===(t=e.user)||void 0===t?void 0:t.name,isGuest:e.isGuest??!1,profileImage:null===(o=e.user)||void 0===o?void 0:o.profileImage},label:a(e),viewingPageId:e.pageId??void 0,isActive:e.active,activityId:e.id}};function s(e,t){return e.active&&t.active?0:e.active?-1:t.active||e.lastTimestamp<t.lastTimestamp?1:e.lastTimestamp>t.lastTimestamp?-1:0}const c=e=>[...e].sort(s),d=e=>[...e].sort(s)},77759:function(e,t,o){const n=o(76661).Ps`
  mutation DELETE_TOME_MUTATION($tomeId: String!) {
    deleteTome(id: $tomeId) {
      id
    }
  }
`;t.Z=n},64972:function(e,t,o){const n=o(76661).Ps`
  mutation RESTORE_TOME_MUTATION($tomeId: String!) {
    restoreTome(id: $tomeId) {
      id
    }
  }
`;t.Z=n},81703:function(e,t,o){const n=o(50456).ZP`
  query commentsLastSeenForUserAndPage(
    $userId: String!
    $tomeId: String!
    $pageId: String!
  ) {
    commentsLastSeenForUserAndPage(
      userId: $userId
      tomeId: $tomeId
      pageId: $pageId
    ) {
      pageId
      lastViewedAt
    }
  }
`;t.Z=n},33504:function(e,t,o){var n=o(50456),r=o(51718);const i=n.ZP`
  query tile($id: String!) {
    tile(id: $id) {
      ...TileFragment
    }
  }
  ${r.mXG}
`;t.Z=i},56793:function(e,t,o){o.d(t,{Z:function(){return a}});var n=o(51718),r=o(37308),i=o(49335);function a(){const{maybeIncrementFreeTomeCreationCount:e}=(0,i.Z)(),[t]=(0,n.mTo)({update(t,o){let{data:{duplicateTome:n}}=o;(0,r.a)(t,n,e)}});return async e=>{let{tomeId:o,orgId:n,onDuplicateComplete:r,onDuplicateError:i}=e;try{const{data:e}=await t({variables:{tomeId:o,orgId:n}});if(null===e||void 0===e)return void i(new Error("No data returned from duplicate tome mutation"));const a=e.duplicateTome;if(!a)return void i(new Error("No duplicate tome returned from duplicate tome mutation"));r(a.id,a.canonicalUrl)}catch{i(new Error("Error duplicating tome"))}}}},82391:function(e,t,o){o.d(t,{w:function(){return r}});var n=o(67294);const r=["left","right","up","down","escape","enter","tab","shift+tab"];t.Z=e=>{let{options:t,selectedType:o,setSelectedType:r,didSelect:i,didEscape:a}=e;const l=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e<t.length-1&&r(t[e+1])}),[o,t,r]),s=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e>0&&r(t[e-1])}),[o,t,r]),c=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e<t.length-2&&r(t[e+2])}),[t,o,r]),d=(0,n.useCallback)((()=>{if(!o)return;let e;for(e=0;e<t.length&&t[e]!==o;e+=1);e>1&&r(t[e-2])}),[t,o,r]);return{onKeyDown:e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab","Escape","Enter"].includes(e.key)&&(!o&&t.length>0&&"Escape"!==e.key?(r(t[0]),e.preventDefault()):"ArrowRight"===e.key||"Tab"===e.key&&!e.shiftKey?(l(),e.preventDefault()):"ArrowLeft"===e.key||"Tab"===e.key&&e.shiftKey?(s(),e.preventDefault()):"ArrowUp"===e.key?(d(),e.preventDefault()):"ArrowDown"===e.key?(c(),e.preventDefault()):"Enter"===e.key?(o&&i&&i(),e.preventDefault()):"Escape"===e.key&&(a&&a(),e.preventDefault()))}}}},43002:function(e,t,o){var n=o(85518),r=o(30587),i=o(57509);t.Z=()=>{const e=(0,r.GS)(i.Hb.mobile),t=n.tq||n.Em;return n.nI?e:t}},46116:function(e,t,o){o.d(t,{JN:function(){return g},Ni:function(){return u},l1:function(){return m}});var n=o(59499),r=o(19148),i=o(51718),a=o(16344);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}const s={type:i.YUT.Text,textTileData:{content:(0,a.qV)(a.SQ.Heading)}},c={type:i.YUT.Image},d={type:i.YUT.Text,textTileData:{content:(0,a.qV)(a.SQ.Title),verticalAlignment:i.Q4P.Center,horizontalAlignment:i.KxP.Center}},p=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({type:i.YUT.Table},(0,a.vJ)(4,7,!1)),u={id:"centered-text",description:r.ZP.t("layouts.centeredTextDescription"),rows:[{tiles:[d]}]},m={id:"text",description:r.ZP.t("layouts.textDescription"),rows:[{tiles:[s]}]},g=[m,u,{id:"text+media",description:r.ZP.t("layouts.textAndMediaDescription"),rows:[{tiles:[s,c]}]},{id:"text+table",description:r.ZP.t("layouts.textAndTableDescription"),hidesSublabels:!0,rows:[{tiles:[s]},{tiles:[p]}]},{id:"media",description:r.ZP.t("layouts.mediaDescription"),rows:[{relativeHeight:1,tiles:[c]}]},{id:"three-media",description:r.ZP.t("layouts.threeMediaDescription"),rows:[{relativeHeight:1,tiles:[c,c,c]}]},{id:"media+2-text",description:r.ZP.t("layouts.mediaAndTwoTextDescription"),rows:[{relativeHeight:1.25,tiles:[c]},{relativeHeight:.75,tiles:[s,s]}]},{id:"text-media-grid",description:r.ZP.t("layouts.textAndThreeByTwoDescription"),rows:[{relativeHeight:.666667,tiles:[d]},{relativeHeight:.666667,tiles:[c,c,c]},{relativeHeight:.666667,tiles:[c,c,c]}]}]},57819:function(e,t,o){o.d(t,{I0:function(){return y},P3:function(){return g},PI:function(){return x},PS:function(){return v},QA:function(){return C},QX:function(){return P},Ti:function(){return f},VK:function(){return O},hT:function(){return h},zh:function(){return b}});var n=o(59499),r=o(62830),i=o.n(r),a=o(25934),l=o(19148),s=o(51718),c=o(81703),d=o(60864),p=o(33159);function u(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?u(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const g=(e,t)=>{t.comments&&t.comments.forEach((t=>{e.cache.modify({id:e.cache.identify(t),fields:{unread:()=>!1}})}))},h=(e,t)=>{const o=e.cache.readFragment({id:`Tome:${t}`,fragment:s.AKG,fragmentName:"TomeFragment",variables:{fetchFullPage:!0,prefetchPreviewImage:!1}});o&&o.pages.forEach((o=>{o.comments&&o.comments.forEach((o=>{e.cache.modify({id:e.cache.identify(o),fields:{unread:()=>((e,t,o)=>{var n;const{me:r}=e.readQuery({query:s.fkZ});if((null===t||void 0===t||null===(n=t.author)||void 0===n?void 0:n.id)===r.id)return!1;const i=e.readQuery({query:c.Z,variables:{userId:r.id,tomeId:o,pageId:t.pageId}}),a=i&&i.commentsLastSeenForUserAndPage&&i.commentsLastSeenForUserAndPage.lastViewedAt&&new Date(i.commentsLastSeenForUserAndPage.lastViewedAt).valueOf();return!!a&&a<new Date(t.createdAt).valueOf()})(e.cache,o,t)}})}))}))},f=e=>e&&e.pages&&e.pages.map((e=>e.comments&&e.comments.map((e=>e.unread)).some((e=>!0===e)))).some((e=>!0===e)),b=e=>e&&e.comments&&e.comments.map((e=>e.unread)).some((e=>!0===e)),y=(e,t)=>{var o;const{me:n}=e.readQuery({query:s.fkZ});t.unread=!0,null!==n&&void 0!==n&&n.id&&(null===t||void 0===t||null===(o=t.author)||void 0===o?void 0:o.id)===n.id&&(t.unread=!1);const r=e.writeFragment({id:`Comment:${t.id}`,fragment:s.$zS,data:t,fragmentName:"CommentFragment"});e.modify({id:`Page:${t.pageId}`,fields:{comments(){return[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r]}}})},C=(e,t)=>{e.modify({id:e.identify(t),fields:{content:e=>t.content||e}})},v=(e,t)=>{e.modify({id:`Page:${t.pageId}`,fields:{comments(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{readField:o}=arguments.length>1?arguments[1]:void 0;return e.filter((e=>t.id!==o("id",e)))}}})},x=async(e,t,o,n,r,c)=>{const u=i()(),m=(0,a.Z)(),g={__typename:"User",id:o.id,name:o.name,email:o.email,profileImage:o.profileImage},h={__typename:"Comment",id:u,pageId:t.id,author:g,content:n,createdAt:(new Date).toISOString(),unread:!1};await r.mutate({mutation:s.Zso,variables:{editId:m,clientId:c,tomeId:e,pageId:t.id,commentId:u,content:n},optimisticResponse:{createComment:{__typename:"Edit",id:m,authorId:g.id,clientId:c,tomeId:e,status:"SUCCESS",comment:h}},update(e,t){let{data:o}=t;"SUCCESS"===(null===o||void 0===o?void 0:o.createComment.status)?y(e,h):(0,d.ak)({message:l.ZP.t("logic.tome.noPermissionForCommentMessage")})}}),p.ZP.reportNewCommentEvent({apolloClient:r,tomeId:e,pageId:t.id,commentId:u})},O=async(e,t,o,n,r)=>{const i=(0,a.Z)(),l=o.cache.readFragment({id:`Comment:${r}`,fragment:s.$zS,fragmentName:"CommentFragment"});l&&await o.mutate({mutation:s.ulC,variables:{editId:i,clientId:n,tomeId:e,commentId:r,content:t},optimisticResponse:{updateComment:{__typename:"Edit",id:i,authorId:l.author.id,clientId:n,tomeId:e,comment:m(m({},l),{},{content:t})}},update(e,t){let{data:o}=t;null!==o&&void 0!==o&&o.updateComment.comment&&C(e,null===o||void 0===o?void 0:o.updateComment.comment)}})};function P(e,t,o,n,r){t.mutate({mutation:s.i9U,variables:{editId:(0,a.Z)(),clientId:o,tomeId:e,commentId:n},update(e){v(e,{id:n,pageId:r})}})}},15487:function(e,t,o){o.d(t,{l_:function(){return T},Vy:function(){return x},JK:function(){return E},tj:function(){return O},ek:function(){return j},pp:function(){return v},kj:function(){return P},sR:function(){return I}});var n=o(59499),r=o(62830),i=o.n(r),a=o(25934),l=o(51718),s=o(6748),c=o(36488),d=o(16344);function p(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function u(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?p(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const m=(e,t)=>{const o=(0,d.ZP)(e.type??"TEXT",!1);return{operation:l.C8.CreateTile,id:e.tileId,tile:u(u(u({},o),{},{type:e.type,order:e.order},e.textTileData?{textTileData:e.textTileData}:{}),e.tableTileData?{tableTileData:e.tableTileData}:{}),page:{id:t}}};var g=(e,t,o,n)=>{const r={rows:t.rows.map((e=>u(u({},e),{},{tiles:e.tiles.map((e=>u(u({},e),{},{id:i()()})))})))}.rows.map((e=>({rowId:i()(),relativeHeight:e.relativeHeight??null,tiles:e.tiles.map(((e,t)=>({tileId:e.id,order:t+1,type:e.type,textTileData:e.textTileData,tableTileData:e.tableTileData})))}))),a=i()(),s=r[0].tiles[0].tileId,c={rows:r.map(((e,t)=>({rowId:e.rowId,relativeHeight:e.relativeHeight,order:t+1,tiles:e.tiles.map((e=>({tileId:e.tileId,order:e.order+1,relativeWidth:1})))})))},d=r.flatMap((e=>e.tiles.map((e=>m(e,a)))));return{apply:[{operation:l.C8.CreatePage,id:a,page:{autoThemeColor:!0,order:o,overlay:{videoStatus:l.Kwn.WaitingForCreation,videoId:null,videoThumbnailUrl:null,videoUrl:null,position:l._zJ.UpperRight},layout:c,themeId:n},tome:{id:e}},...d],revert:[{operation:l.C8.DeletePage,id:a,tome:{id:e}}],pageId:a,tileId:s}};var h=o(46116),f=o(33159),b=o(60864),y=o(95821);function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function v(e,t){let o;return o=0===t.length?1:0===e?t[0].order/2:e===t.length?t[t.length-1].order+1:(t[e-1].order+t[e].order)/2,o}function x(e,t,o,n,r){null!==r&&void 0!==r&&r.id&&f.ZP.reportNewCreatePageEvent({apolloClient:o,tomeId:e.id,layoutId:r.id});const i=v(t,e.pages),l=r||(1===i?h.Ni:h.l1),{apply:c,revert:d,pageId:p,tileId:u}=g(e.id,l,i,e.theme.id),m={id:(0,a.Z)(),tomeId:e.id,clientId:n,apply:c,revert:d},b=(0,y.mz)(m);return(0,s.iO)(o,b,m),{pageId:p,tileId:u}}function O(e,t,o,n,r){const i=[],d=[];let p;if(t.forEach((t=>{i.push({operation:l.C8.DeletePage,id:t,tome:{id:e.id}}),d.push({operation:l.C8.RecoverPage,id:t,tome:{id:e.id}});const o=n.cache.readFragment({id:`Page:${t}`,fragment:l.bsn,fragmentName:"PageWithTilesFragment"});if(null!==o&&void 0!==o&&o.theme){const e=new c.Z(o.theme);e.isAnonymous&&(i.push({operation:l.C8.DeleteTheme,id:e.id}),d.push({operation:l.C8.RecoverTheme,id:e.id}))}})),o){const{apply:t,revert:o,pageId:n}=g(e.id,h.Ni,1,e.theme.id);p=n,i.push(...t),d.unshift(...o)}const u={id:(0,a.Z)(),tomeId:e.id,clientId:r,apply:i,revert:d};return(0,s.iO)(n,u),p}function P(e,t,o,n,r){if(t===o)return;const i=e.pages[t];let c;c=0===o?e.pages[0].order/2:o===e.pages.length-1?e.pages[o].order+1:o>t?(e.pages[o].order+e.pages[o+1].order)/2:(e.pages[o-1].order+e.pages[o].order)/2;const d=[{operation:l.C8.UpdatePage,id:i.id,page:{order:c},tome:{id:e.id}}],p=[{operation:l.C8.UpdatePage,id:i.id,page:{order:i.order},tome:{id:e.id}}],u={id:(0,a.Z)(),tomeId:e.id,clientId:r,apply:d,revert:p};(0,s.iO)(n,u)}function w(e,t,o,r,d){let p=1,u=1;if(e.pages.length>0&&(u=e.pages[e.pages.length-1].order),o<e.pages.length-1){u=e.pages[o].order;const n=e.pages[o+1].order;p=(n-u)/(t.length+1)}const m=[],g=[],h=[];t.forEach(((t,o)=>{const a=u+p*(o+1),s=i()();h.push(s);let d=t.theme.id;if(t.theme){const o=new c.Z(t.theme),n=new c.Z(e.theme),r=o.id===n.id;if(o.isAnonymous&&!r){var f;const t=i()();d=t,m.push({operation:l.C8.CreateTheme,id:t,theme:{orgId:null===e||void 0===e||null===(f=e.org)||void 0===f?void 0:f.id,colors:o.colors,headingTypeface:o.headingTypeface,paragraphTypeface:o.paragraphTypeface}}),g.push({operation:l.C8.DeleteTheme,id:t})}}m.push({operation:l.C8.CreatePage,id:s,page:{autoThemeColor:t.autoThemeColor,order:a,overlay:t.overlay,themeId:d},tome:{id:e.id}});const b=JSON.parse(JSON.stringify(t.layout));t.tiles.forEach((e=>{const t=`Tile:${e.id}`,o=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},r.cache.readFragment({id:t,fragment:l.mXG}));delete o.__typename,delete o.id;const a=i()();b.rows.map((t=>{t.tiles.map((t=>(t.tileId===e.id&&(t.tileId=a),t)));const o=i()();return t.rowId=o,t})),m.push({operation:l.C8.CreateTile,id:a,tile:o,page:{id:s}})})),m.push({operation:l.C8.UpdatePage,id:s,page:{layout:b}}),g.push({operation:l.C8.DeletePage,id:s,tome:{id:e.id}})}));const f={id:(0,a.Z)(),tomeId:e.id,clientId:d,apply:m,revert:g},b=(0,y.mz)(f);return(0,s.iO)(r,b,f),h}function j(e,t,o,n){const r=Math.max(...t),i=e.pages.filter(((e,o)=>t.includes(o)));return w(e,i,r,o,n)}function T(e,t,o){const n=[];t.forEach((e=>{const t=`Page:${e}`,r=o.cache.readFragment({id:t,fragment:l.bsn,fragmentName:"PageWithTilesFragment"});n.push(r)})),(0,b.fz)({tome:e,pages:n,type:"PAGE"})}function E(e,t,o,n){T(e,t,o);O(e,t,t.length===e.pages.length,o,n)}function I(e,t,o,n){const{pages:r,type:i}=(0,b.fz)();return"PAGE"===i?w(e,r,t,o,n):null}},37308:function(e,t,o){o.d(t,{W:function(){return s},a:function(){return l}});var n=o(59499),r=o(51718);function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){(0,n.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}const l=(e,t,o)=>{const{me:n}=e.readQuery({query:r.fkZ}),i=e.writeFragment({id:e.identify(t),fragment:r.LWh,fragmentName:"WorkspaceTomeFragment",data:t});e.modify({id:e.identify(n),fields:{recentTomes:e=>a(a({},e),{},{nodes:[i,...e.nodes]}),tomes:e=>a(a({},e),{},{nodes:[i,...e.nodes]})}}),o(e)},s=(e,t)=>{const o=t.id,{me:n}=e.readQuery({query:r.fkZ});e.modify({id:e.identify(t),fields:{deleted:()=>!1}}),e.modify({id:e.identify(n),fields:{tomes(e){const t=[{__ref:`Tome:${o}`},...e.nodes];return a(a({},e),{},{nodes:t})},deletedTomes(e,t){let{readField:n}=t;const r=e.nodes.filter((e=>o!==n("id",e)));return a(a({},e),{},{nodes:r})}}})}},69103:function(e,t,o){o.r(t),o.d(t,{__N_SSG:function(){return g},default:function(){return h}});var n=o(41664),r=o.n(n),i=o(11163),a=o(59016),l=o(1922),s=o(55245),c=o(8423),d=o(34136),p=o(85893);const u=(0,a.ZP)(d.Z)`
  &:hover,
  :focus,
  :active {
    text-decoration: none;
  }
  min-width: 145px;
`,m=a.ZP.div`
  display: flex;
  gap: 12px;
  margin: 24px 0;
`;var g=!0;function h(){const e=(0,i.useRouter)(),{t:t}=(0,l.$G)();return(0,p.jsx)(c.Z,{mainMessage:t("pages.mainErrorMessage404Page"),children:(0,p.jsxs)(m,{"data-testid":"404_page_button_container",children:[(0,p.jsx)(r(),{href:"/",passHref:!0,children:(0,p.jsx)(u,{component:"a",size:"large",children:t("pages.homeButton404Page")})}),(0,p.jsx)(r(),{href:(0,s.bM)(e),passHref:!0,children:(0,p.jsx)(u,{component:"a",size:"large",children:t("pages.loginButton404Page")})})]})})}},52322:function(e,t,o){const n=(0,o(4480).cn)({key:"forceTomeViewWithCacheState",default:!1});t.Z=n},22111:function(e,t,o){o.d(t,{B:function(){return i}});var n=o(28670),r=o.n(n);const i=e=>r().valid(e)&&1===r()(e).get("rgba.a")},1027:function(e,t,o){o.d(t,{G:function(){return r}});var n=o(62196);const r=e=>n.validate(e,{minDomainAtoms:2})},66482:function(e,t,o){o.d(t,{Bb:function(){return c},Gi:function(){return m},Qy:function(){return f},Y1:function(){return p},ZB:function(){return d},sc:function(){return g},tv:function(){return h},xh:function(){return l},yW:function(){return s}});var n=o(97173),r=o(19148),i=o(60864),a=o(15487);const l=(e,t)=>{if(!t)return null;for(let o=0;o<e.length;o++)if(e[o].id===t)return o;return null},s=(e,t)=>{const[o]=e.filter((e=>e.id===t));return o||e[0]},c=(e,t)=>{const[o]=e.filter(((e,o)=>o===t));return o?o.id:null},d=(e,t,o,n)=>{const r=t.map((t=>e.pages[t].id));(0,a.JK)(e,r,o,n)},p=(e,t,o,n)=>{const l=t.map((t=>e.pages[t].id));(0,a.l_)(e,l,o,n),(0,i.ak)({message:r.ZP.t("utils.pageActions.pageCopied_with_count",{count:l.length})})},u=function(e,t,o,n,l,s,c){let d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=o.length===e.pages.length,m=(0,a.tj)(e,o,u,n,l);let g,h;if(d&&(0,i.ak)({message:r.ZP.t("utils.pageActions.pageDeleted_with_count",{count:o.length}),action:"undo"}),u)h=0,g=m;else{const n=e.pages.map((e=>e.id)).filter((e=>!o.includes(e))),r=Math.min(...t);h=n.length-1>=r?p?r-1:r:n.length-1,g=n[h]}c(g),s([h])},m=(e,t,o,n,r,i,a,s)=>{const c=t.map((t=>l(e.pages,t)));u(e,c,t,o,n,r,i,a,s)},g=(e,t,o,n,r,i,a,l)=>{const s=t.map((t=>e.pages[t].id));u(e,t,s,o,n,r,i,a,l)},h=(e,t,o,r,i,l)=>{if(0===t.length)return;const s=(0,a.ek)(e,t,o,r),c=Math.max(...t)+1;i((0,n.Z)(c,c+t.length)),l(s[0]||"")},f=(e,t,o,r,i,s,c)=>{let d=Math.max(...t);if(d<0){d=l(e.pages,o)||0}const p=(0,a.sR)(e,d,r,i);if(p){const e=d+1;s((0,n.Z)(e,e+t.length)),c(p[0]||"")}}},60928:function(e,t,o){var n=o(22839);const r=3600,i=86400,a=604800,l=2419200,s=31449600;t.Z=function(e,t,o){const c=(new Date).valueOf(),d=new Date(e).valueOf(),p=Math.round((c-d)/1e3);if(p<60)return o?n.ZP.t("utils.getRelativeTimeLabel.momentsAgoCapitalized"):n.ZP.t("utils.getRelativeTimeLabel.momentsAgoLowercase");let u;if(p<r){const e=Math.floor(p/60);u=!1===t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInMin_with_count",{count:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInMinuteShortlabel",{relativeTimeValue:e})}else if(p<i){const e=Math.floor(p/r);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInHoursShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInHours",{relativeTimeValue:-e})}else if(p<a){const e=Math.floor(p/i);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInDaysShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInDays",{relativeTimeValue:-e})}else if(p<l||t&&p<s){const e=Math.floor(p/a);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInWeeksShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInWeeks",{relativeTimeValue:-e})}else if(p<s&&!t){const e=Math.floor(p/l);u=n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInMonths",{relativeTimeValue:-e})}else{const e=Math.floor(p/s);u=t?n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInYearsShortlabel",{relativeTimeValue:e}):n.ZP.t("utils.getRelativeTimeLabel.intlRelativeTimeInYears",{relativeTimeValue:-e})}return u}}}]);
